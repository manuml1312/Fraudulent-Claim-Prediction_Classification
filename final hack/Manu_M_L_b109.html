<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>f28f0c56c51b4a32b7c704277ff7806d</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      word-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<section id="ml-problem-statement" class="cell markdown">
<h1>ML Problem Statement</h1>
</section>
<div class="cell markdown" id="2rhFuUO11C9R">
<p>The Customers of the automotive insurance company are making fraudulent claims with regard to vehcile damages, bodily injuries and property damages.</p>
<p>As a result of which the company has been incurring losses which has also started affecting the services that are being offered to genuine customers.</p>
<p>The board wants to:</p>
<p>1.to be able to make accurate predictions of a fradulent claim.</p>
<p>2.to find the traits and patterns from the data to identify if the claim being made is fradulent or genunine.</p>
<p>3.The types of claims may vary in nature hence the detection process needs dynamic adaptation</p>
<p>Solution:To use the historic data with the company and build a ML model that can satisfy their requests.</p>
<p><strong>Advantages of ML:</strong></p>
<p>1.Adaptive and Time saving.</p>
<p>2.Reliable and adaptive to new data</p>
</div>
<div class="cell markdown" id="1jC_usmPXjfx">
<p>The steps involved in the project are:</p>
<p>1.Buisness Case Understanding:Understanding the requirements of the client.</p>
<p>2.Data Exploration:Exploring the given data and understanding it statistically.</p>
<p>3.Data Visualisation:To provide insights regarding the features and their relation with the binary claim values.</p>
<p>4.Data Cleaning:Missing Value treatment,Outlier treatment,Feature Engineering,Feature Transformation,Feature Scaling,Feature Selection.</p>
<p>5.Model Building:Choosing the models,training them and validating the output w.r.t the given evaluation metric.</p>
<p>6.Model Validation and Parameter Tuning:Performing Cross-validation to study model performance on the different subsets of the same data and parameter tuning improve the model outputs.</p>
<p>7.Model Generalisation:Using data augmentation to increase the minority samples in the data hence creating more cases for the model to assess and perform better on test data.</p>
<p>8.Conclusion</p>
</div>
<div class="cell markdown" id="kH0jWjk8z4kD">
<p><strong>Importing necessary libraries</strong></p>
</div>
<div class="cell code" data-execution_count="1" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="vU41puLeKqTa" data-outputId="f809d701-d708-44d0-e48e-c98d5b85999a">
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> google.colab <span class="im">import</span> drive</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>drive.mount(<span class="st">&#39;/content/gdrive&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Mounted at /content/gdrive
</code></pre>
</div>
</div>
<div class="cell markdown" id="MEqMX9gfKtsk">
<p><strong>Importing data from drive</strong></p>
</div>
<div class="cell code" data-execution_count="3" id="3GXhmgkhZOjE">
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.experimental <span class="im">import</span> enable_iterative_imputer </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.impute <span class="im">import</span> IterativeImputer,SimpleImputer</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> RobustScaler,LabelEncoder,OneHotEncoder</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.feature_selection <span class="im">import</span> SelectKBest,f_classif,chi2</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> RepeatedStratifiedKFold,RandomizedSearchCV,cross_val_score,train_test_split</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numpy <span class="im">import</span> mean,std,<span class="bu">sum</span>,median,array</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> f1_score,classification_report,roc_auc_score</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.neighbors <span class="im">import</span> KNeighborsClassifier</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeClassifier</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.naive_bayes <span class="im">import</span> GaussianNB</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.svm <span class="im">import</span> SVC</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> lightgbm <span class="im">as</span> lgbm</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> xgboost <span class="im">import</span> XGBClassifier</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> VotingClassifier,RandomForestClassifier</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="3" id="XOc2QpdyLV51">
<div class="sourceCode" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#To read Train_Claim data</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>path <span class="op">=</span> <span class="st">&quot;/content/gdrive/My Drive/fh/Train_NT/TC.csv&quot;</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>claim<span class="op">=</span>pd.read_csv(path)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co">#To read Test_Claim data</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>path <span class="op">=</span> <span class="st">&quot;/content/gdrive/My Drive/fh/TestData/Test_Claim.csv&quot;</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>claim_test<span class="op">=</span>pd.read_csv(path)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="4" id="et2ghCVzh8Tn">
<div class="sourceCode" id="cb5"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#To read Train_Demographics data</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>path <span class="op">=</span> <span class="st">&quot;/content/gdrive/My Drive/fh/Train_NT/Train_Demographics.csv&quot;</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>demo<span class="op">=</span>pd.read_csv(path)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">#To read Test_Demographics data</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>path <span class="op">=</span> <span class="st">&quot;/content/gdrive/My Drive/fh/TestData/Test_Demographics.csv&quot;</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>demo_test<span class="op">=</span>pd.read_csv(path)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="5" id="ZQlz7IInh8Tn">
<div class="sourceCode" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#To read Train_vehicle data</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>path <span class="op">=</span> <span class="st">&quot;/content/gdrive/My Drive/fh/Train_NT/Train_Vehicle.csv&quot;</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>vehicle<span class="op">=</span>pd.read_csv(path)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co">#To read Test_vehicle data</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>path <span class="op">=</span> <span class="st">&quot;/content/gdrive/My Drive/fh/TestData/Test_Vehicle.csv&quot;</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>vehicle_test<span class="op">=</span>pd.read_csv(path)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="6" id="bgCua6alh8Tn">
<div class="sourceCode" id="cb7"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#To read Train_policy data</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>path <span class="op">=</span> <span class="st">&quot;/content/gdrive/My Drive/fh/Train_NT/Train_Policy.csv&quot;</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>policy<span class="op">=</span>pd.read_csv(path)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co">#To read Test_policy data</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>path <span class="op">=</span> <span class="st">&quot;/content/gdrive/My Drive/fh/TestData/Test_Policy.csv&quot;</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>policy_test<span class="op">=</span>pd.read_csv(path)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="7" id="QcBr7mKah8To">
<div class="sourceCode" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#To read Train data with Target values:</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>path <span class="op">=</span> <span class="st">&quot;/content/gdrive/My Drive/fh/Train_NT/Traindata_with_Target.csv&quot;</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>with_target<span class="op">=</span>pd.read_csv(path)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co">#To read Test data i.e CustomerID</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>path <span class="op">=</span> <span class="st">&quot;/content/gdrive/My Drive/fh/TestData/Test.csv&quot;</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>without_target<span class="op">=</span>pd.read_csv(path)</span></code></pre></div>
</div>
<section id="data-exploration" class="cell markdown" id="XUjofpMr0OZk">
<h1>Data Exploration</h1>
<p>The given data contains the details regarding the Customer,issued Vehicle Insurance Policy,the Claim made and the respective Vehicle involved.</p>
</section>
<section id="data-structure-exploration" class="cell markdown" id="evAwkwXggnuZ">
<h1>DATA STRUCTURE EXPLORATION</h1>
<p>We have all the data in a single sheet.Before we combine them lets explore both the train and test data.</p>
<p><strong>Procedure:</strong></p>
<p>1.Check the dimension of the data</p>
<p>2.Visualising the top5 rows</p>
<p>3.To check the datatypes of the columns</p>
<p>4.Understanding the statistical distribution of data,column wise</p>
<p>5.To view unique values in all columns</p>
<p>6.To assign them the respective datatypes.</p>
<p><strong>Merging:</strong></p>
<p>All the individual data sets are merged on the common column CustomerID to form a single dataset</p>
</section>
<div class="cell code" data-execution_count="8" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="CsaQB6ngk3kM" data-outputId="8b780800-695c-4daf-aefa-0c9997df0957">
<div class="sourceCode" id="cb9"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Train_Claim data</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(claim.shape)<span class="co">#shape of the data</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(claim_test.shape)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>(28836, 19)
(8912, 19)
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="9" data-colab="{&quot;height&quot;:357,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="UA308ayRMCJn" data-outputId="b8f357b8-1a8c-4fda-e653-7399cfb187ed">
<div class="sourceCode" id="cb11"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>claim.head()<span class="co">#Checking the top5 rows to get an idea of the data</span></span></code></pre></div>
<div class="output execute_result" data-execution_count="9">

  <div id="df-87a31ced-03fb-46e5-9a33-d4764042cac8">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CustomerID</th>
      <th>DateOfIncident</th>
      <th>TypeOfIncident</th>
      <th>TypeOfCollission</th>
      <th>SeverityOfIncident</th>
      <th>AuthoritiesContacted</th>
      <th>IncidentState</th>
      <th>IncidentCity</th>
      <th>IncidentAddress</th>
      <th>IncidentTime</th>
      <th>NumberOfVehicles</th>
      <th>PropertyDamage</th>
      <th>BodilyInjuries</th>
      <th>Witnesses</th>
      <th>PoliceReport</th>
      <th>AmountOfTotalClaim</th>
      <th>AmountOfInjuryClaim</th>
      <th>AmountOfPropertyClaim</th>
      <th>AmountOfVehicleDamage</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Cust10000</td>
      <td>2015-02-03</td>
      <td>Multi-vehicle Collision</td>
      <td>Side Collision</td>
      <td>Total Loss</td>
      <td>Police</td>
      <td>State7</td>
      <td>City1</td>
      <td>Location 1311</td>
      <td>17</td>
      <td>3</td>
      <td>?</td>
      <td>1</td>
      <td>0</td>
      <td>?</td>
      <td>65501</td>
      <td>13417</td>
      <td>6071</td>
      <td>46013</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Cust10001</td>
      <td>2015-02-02</td>
      <td>Multi-vehicle Collision</td>
      <td>Side Collision</td>
      <td>Total Loss</td>
      <td>Police</td>
      <td>State7</td>
      <td>City5</td>
      <td>Location 1311</td>
      <td>10</td>
      <td>3</td>
      <td>YES</td>
      <td>2</td>
      <td>1</td>
      <td>YES</td>
      <td>61382</td>
      <td>15560</td>
      <td>5919</td>
      <td>39903</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Cust10002</td>
      <td>2015-01-15</td>
      <td>Single Vehicle Collision</td>
      <td>Side Collision</td>
      <td>Minor Damage</td>
      <td>Other</td>
      <td>State8</td>
      <td>City6</td>
      <td>Location 2081</td>
      <td>22</td>
      <td>1</td>
      <td>YES</td>
      <td>2</td>
      <td>3</td>
      <td>NO</td>
      <td>66755</td>
      <td>11630</td>
      <td>11630</td>
      <td>43495</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Cust10003</td>
      <td>2015-01-19</td>
      <td>Single Vehicle Collision</td>
      <td>Side Collision</td>
      <td>Minor Damage</td>
      <td>Other</td>
      <td>State9</td>
      <td>City6</td>
      <td>Location 2081</td>
      <td>22</td>
      <td>1</td>
      <td>YES</td>
      <td>2</td>
      <td>3</td>
      <td>NO</td>
      <td>66243</td>
      <td>12003</td>
      <td>12003</td>
      <td>42237</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Cust10004</td>
      <td>2015-01-09</td>
      <td>Single Vehicle Collision</td>
      <td>Rear Collision</td>
      <td>Minor Damage</td>
      <td>Fire</td>
      <td>State8</td>
      <td>City6</td>
      <td>Location 1695</td>
      <td>10</td>
      <td>1</td>
      <td>NO</td>
      <td>2</td>
      <td>1</td>
      <td>YES</td>
      <td>53544</td>
      <td>8829</td>
      <td>7234</td>
      <td>37481</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-87a31ced-03fb-46e5-9a33-d4764042cac8')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-87a31ced-03fb-46e5-9a33-d4764042cac8 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-87a31ced-03fb-46e5-9a33-d4764042cac8');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="10" data-colab="{&quot;height&quot;:340,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="GWm1yKiYr7_c" data-outputId="1503b95d-22ed-41e9-8afc-d81190e1128d">
<div class="sourceCode" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>claim_test.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="10">

  <div id="df-82e97b0e-1cf6-4d15-92f6-355c170f14fc">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CustomerID</th>
      <th>DateOfIncident</th>
      <th>TypeOfIncident</th>
      <th>TypeOfCollission</th>
      <th>SeverityOfIncident</th>
      <th>AuthoritiesContacted</th>
      <th>IncidentState</th>
      <th>IncidentCity</th>
      <th>IncidentAddress</th>
      <th>IncidentTime</th>
      <th>NumberOfVehicles</th>
      <th>PropertyDamage</th>
      <th>BodilyInjuries</th>
      <th>Witnesses</th>
      <th>PoliceReport</th>
      <th>AmountOfTotalClaim</th>
      <th>AmountOfInjuryClaim</th>
      <th>AmountOfPropertyClaim</th>
      <th>AmountOfVehicleDamage</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Cust10008</td>
      <td>2015-02-05</td>
      <td>Multi-vehicle Collision</td>
      <td>Front Collision</td>
      <td>Minor Damage</td>
      <td>Ambulance</td>
      <td>State5</td>
      <td>City2</td>
      <td>Location 1354</td>
      <td>4</td>
      <td>3</td>
      <td>NO</td>
      <td>0</td>
      <td>0</td>
      <td>?</td>
      <td>68354</td>
      <td>6835</td>
      <td>8059</td>
      <td>53460</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Cust10010</td>
      <td>2015-01-13</td>
      <td>Single Vehicle Collision</td>
      <td>Rear Collision</td>
      <td>Minor Damage</td>
      <td>Fire</td>
      <td>State9</td>
      <td>City5</td>
      <td>Location 1383</td>
      <td>16</td>
      <td>1</td>
      <td>?</td>
      <td>1</td>
      <td>1</td>
      <td>?</td>
      <td>55270</td>
      <td>8113</td>
      <td>5240</td>
      <td>41917</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Cust10015</td>
      <td>2015-01-05</td>
      <td>Multi-vehicle Collision</td>
      <td>Rear Collision</td>
      <td>Minor Damage</td>
      <td>Police</td>
      <td>State5</td>
      <td>City2</td>
      <td>Location 2030</td>
      <td>20</td>
      <td>3</td>
      <td>NO</td>
      <td>0</td>
      <td>1</td>
      <td>?</td>
      <td>59515</td>
      <td>7490</td>
      <td>9110</td>
      <td>42915</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Cust10020</td>
      <td>2015-01-03</td>
      <td>Vehicle Theft</td>
      <td>?</td>
      <td>Trivial Damage</td>
      <td>None</td>
      <td>State7</td>
      <td>City5</td>
      <td>Location 1449</td>
      <td>10</td>
      <td>1</td>
      <td>?</td>
      <td>2</td>
      <td>1</td>
      <td>?</td>
      <td>4941</td>
      <td>494</td>
      <td>866</td>
      <td>3581</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Cust1003</td>
      <td>2015-02-22</td>
      <td>Multi-vehicle Collision</td>
      <td>Rear Collision</td>
      <td>Minor Damage</td>
      <td>Police</td>
      <td>State5</td>
      <td>City2</td>
      <td>Location 1916</td>
      <td>7</td>
      <td>3</td>
      <td>NO</td>
      <td>2</td>
      <td>3</td>
      <td>NO</td>
      <td>34650</td>
      <td>7700</td>
      <td>3850</td>
      <td>23100</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-82e97b0e-1cf6-4d15-92f6-355c170f14fc')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-82e97b0e-1cf6-4d15-92f6-355c170f14fc button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-82e97b0e-1cf6-4d15-92f6-355c170f14fc');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="11" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="f9OPA3hIOMpA" data-outputId="7ef8a09e-2a4f-45bd-9919-eb56874b900b">
<div class="sourceCode" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>claim.dtypes</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co">#datatypes of the features</span></span></code></pre></div>
<div class="output execute_result" data-execution_count="11">
<pre><code>CustomerID               object
DateOfIncident           object
TypeOfIncident           object
TypeOfCollission         object
SeverityOfIncident       object
AuthoritiesContacted     object
IncidentState            object
IncidentCity             object
IncidentAddress          object
IncidentTime              int64
NumberOfVehicles          int64
PropertyDamage           object
BodilyInjuries            int64
Witnesses                object
PoliceReport             object
AmountOfTotalClaim       object
AmountOfInjuryClaim       int64
AmountOfPropertyClaim     int64
AmountOfVehicleDamage     int64
dtype: object</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="12" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="g7HVhxMAr-Xb" data-outputId="c7a26218-4052-4070-f874-bd2bcbf596ba">
<div class="sourceCode" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>claim_test.dtypes</span></code></pre></div>
<div class="output execute_result" data-execution_count="12">
<pre><code>CustomerID               object
DateOfIncident           object
TypeOfIncident           object
TypeOfCollission         object
SeverityOfIncident       object
AuthoritiesContacted     object
IncidentState            object
IncidentCity             object
IncidentAddress          object
IncidentTime              int64
NumberOfVehicles          int64
PropertyDamage           object
BodilyInjuries            int64
Witnesses                object
PoliceReport             object
AmountOfTotalClaim       object
AmountOfInjuryClaim       int64
AmountOfPropertyClaim     int64
AmountOfVehicleDamage     int64
dtype: object</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="13" data-colab="{&quot;height&quot;:476,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="QKsgF66iOkyQ" data-outputId="270ecaa7-0b13-41f4-9f79-c39fc04e3492">
<div class="sourceCode" id="cb17"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>claim.describe(include<span class="op">=</span><span class="st">&#39;all&#39;</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co">#to understand the statistical distribution of the data in the columns</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co">#can differentiate b/w categorical and continous values</span></span></code></pre></div>
<div class="output execute_result" data-execution_count="13">

  <div id="df-5e32407b-1bf4-4c80-bfef-f71938290a9a">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CustomerID</th>
      <th>DateOfIncident</th>
      <th>TypeOfIncident</th>
      <th>TypeOfCollission</th>
      <th>SeverityOfIncident</th>
      <th>AuthoritiesContacted</th>
      <th>IncidentState</th>
      <th>IncidentCity</th>
      <th>IncidentAddress</th>
      <th>IncidentTime</th>
      <th>NumberOfVehicles</th>
      <th>PropertyDamage</th>
      <th>BodilyInjuries</th>
      <th>Witnesses</th>
      <th>PoliceReport</th>
      <th>AmountOfTotalClaim</th>
      <th>AmountOfInjuryClaim</th>
      <th>AmountOfPropertyClaim</th>
      <th>AmountOfVehicleDamage</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>28836</td>
      <td>28836</td>
      <td>28836</td>
      <td>28836</td>
      <td>28836</td>
      <td>28836</td>
      <td>28836</td>
      <td>28836</td>
      <td>28836</td>
      <td>28836.000000</td>
      <td>28836.000000</td>
      <td>28836</td>
      <td>28836.000000</td>
      <td>28836</td>
      <td>28836</td>
      <td>28836</td>
      <td>28836.000000</td>
      <td>28836.000000</td>
      <td>28836.000000</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>28836</td>
      <td>72</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>5</td>
      <td>7</td>
      <td>7</td>
      <td>1000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3</td>
      <td>NaN</td>
      <td>5</td>
      <td>3</td>
      <td>21976</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>top</th>
      <td>Cust10000</td>
      <td>2015-01-10</td>
      <td>Multi-vehicle Collision</td>
      <td>Rear Collision</td>
      <td>Minor Damage</td>
      <td>Police</td>
      <td>State5</td>
      <td>City2</td>
      <td>Location 1341</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>?</td>
      <td>NaN</td>
      <td>2</td>
      <td>NO</td>
      <td>MISSEDDATA</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>1</td>
      <td>661</td>
      <td>11966</td>
      <td>8561</td>
      <td>10400</td>
      <td>8324</td>
      <td>7886</td>
      <td>4486</td>
      <td>73</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>10459</td>
      <td>NaN</td>
      <td>8449</td>
      <td>9898</td>
      <td>50</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>11.746047</td>
      <td>1.823207</td>
      <td>NaN</td>
      <td>0.985782</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>7337.118428</td>
      <td>7283.870197</td>
      <td>37687.129387</td>
    </tr>
    <tr>
      <th>std</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>6.170069</td>
      <td>0.980099</td>
      <td>NaN</td>
      <td>0.784764</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4427.638593</td>
      <td>4375.842738</td>
      <td>17977.048232</td>
    </tr>
    <tr>
      <th>min</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-5.000000</td>
      <td>1.000000</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>109.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>6.000000</td>
      <td>1.000000</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4743.750000</td>
      <td>4862.000000</td>
      <td>32193.250000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>12.000000</td>
      <td>1.000000</td>
      <td>NaN</td>
      <td>1.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>7147.000000</td>
      <td>7051.000000</td>
      <td>42457.500000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>17.000000</td>
      <td>3.000000</td>
      <td>NaN</td>
      <td>2.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>10571.250000</td>
      <td>10327.000000</td>
      <td>49535.750000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>23.000000</td>
      <td>4.000000</td>
      <td>NaN</td>
      <td>2.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>21450.000000</td>
      <td>23670.000000</td>
      <td>79560.000000</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-5e32407b-1bf4-4c80-bfef-f71938290a9a')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-5e32407b-1bf4-4c80-bfef-f71938290a9a button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-5e32407b-1bf4-4c80-bfef-f71938290a9a');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="14" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="tEcus1xNkqiX" data-outputId="4dbcd544-cc57-4e81-c9d3-15b00e617ea3">
<div class="sourceCode" id="cb18"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#To explore the unique values in categorical columns</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x <span class="kw">in</span> claim.columns:</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(claim[x].value_counts())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Cust10000    1
Cust33397    1
Cust33356    1
Cust33354    1
Cust33353    1
            ..
Cust21600    1
Cust2160     1
Cust21599    1
Cust21598    1
Cust9999     1
Name: CustomerID, Length: 28836, dtype: int64
2015-01-10    661
2015-01-18    657
2015-02-17    648
2015-01-17    647
2015-01-09    646
             ... 
2015-03-08      2
2015-03-07      1
2015-03-12      1
2015-03-10      1
2015-03-14      1
Name: DateOfIncident, Length: 72, dtype: int64
Multi-vehicle Collision     11966
Single Vehicle Collision    11677
Vehicle Theft                2685
Parked Car                   2508
Name: TypeOfIncident, dtype: int64
Rear Collision     8561
Side Collision     7867
Front Collision    7246
?                  5162
Name: TypeOfCollission, dtype: int64
Minor Damage      10400
Total Loss         8218
Major Damage       7671
Trivial Damage     2547
Name: SeverityOfIncident, dtype: int64
Police       8324
Fire         6518
Ambulance    5732
Other        5570
None         2692
Name: AuthoritiesContacted, dtype: int64
State5    7886
State7    7168
State9    6161
State8    3181
State4    3029
State6     810
State3     601
Name: IncidentState, dtype: int64
City2    4486
City1    4374
City4    4311
City7    4216
City3    4073
City5    3698
City6    3678
Name: IncidentCity, dtype: int64
Location 1341    73
Location 1254    72
Location 1227    71
Location 2006    70
Location 1136    68
                 ..
Location 1359    10
Location 1464    10
Location 2072     9
Location 1043     9
Location 1555     9
Name: IncidentAddress, Length: 1000, dtype: int64
 16    1616
 17    1615
 6     1564
 15    1541
 14    1461
 5     1434
 13    1420
 18    1419
 4     1406
 12    1363
 7     1331
 11    1286
 19    1280
 8     1251
 3     1232
 9     1210
 10    1165
 20    1153
 21     971
 22     809
 2      713
 1      648
 23     526
 0      391
-5       31
Name: IncidentTime, dtype: int64
1    16169
3     9711
2     2276
4      680
Name: NumberOfVehicles, dtype: int64
?      10459
NO      9687
YES     8690
Name: PropertyDamage, dtype: int64
1    11072
0     9087
2     8677
Name: BodilyInjuries, dtype: int64
2               8449
1               8345
0               6128
3               5868
MISSINGVALUE      46
Name: Witnesses, dtype: int64
NO     9898
?      9805
YES    9133
Name: PoliceReport, dtype: int64
MISSEDDATA    50
6820          12
5400           8
60600          8
55000          7
              ..
37863          1
33412          1
62879          1
54465          1
55830          1
Name: AmountOfTotalClaim, Length: 21976, dtype: int64
0        68
480      51
640      34
580      19
536      17
         ..
14398     1
5925      1
16236     1
15321     1
14699     1
Name: AmountOfInjuryClaim, Length: 11958, dtype: int64
0        35
580      17
578      16
606      16
506      15
         ..
12312     1
11987     1
12477     1
10953     1
13131     1
Name: AmountOfPropertyClaim, Length: 11785, dtype: int64
2560     19
5040     12
28000    11
3600      8
3290      8
         ..
62176     1
30734     1
43250     1
42999     1
41183     1
Name: AmountOfVehicleDamage, Length: 20041, dtype: int64
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="15" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="QWStAmzgsGCy" data-outputId="12a07b9d-6533-427e-b625-109fe2546dca">
<div class="sourceCode" id="cb20"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#To explore the unique values of claim_test categorical columns</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x <span class="kw">in</span> claim_test.select_dtypes(exclude<span class="op">=</span>[<span class="st">&#39;int&#39;</span>,<span class="st">&#39;float&#39;</span>]).columns:</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(claim_test[x].value_counts())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Cust10008    1
Cust32827    1
Cust32789    1
Cust32794    1
Cust32802    1
            ..
Cust21506    1
Cust21495    1
Cust21488    1
Cust21486    1
Cust9998     1
Name: CustomerID, Length: 8912, dtype: int64
2015-02-17    211
2015-01-19    210
2015-01-24    208
2015-02-14    206
2015-01-09    204
             ... 
2015-03-04      6
2015-03-05      3
2015-03-06      2
2015-03-07      1
2015-03-09      1
Name: DateOfIncident, Length: 67, dtype: int64
Multi-vehicle Collision     3594
Single Vehicle Collision    3569
Vehicle Theft                942
Parked Car                   807
Name: TypeOfIncident, dtype: int64
Rear Collision     2602
Side Collision     2388
Front Collision    2159
?                  1763
Name: TypeOfCollission, dtype: int64
Minor Damage      3378
Total Loss        2587
Major Damage      2043
Trivial Damage     904
Name: SeverityOfIncident, dtype: int64
Police       2623
Fire         1906
Other        1759
Ambulance    1677
None          947
Name: AuthoritiesContacted, dtype: int64
State5    2489
State7    2136
State9    1980
State8    1010
State4     881
State6     241
State3     175
Name: IncidentState, dtype: int64
City2    1405
City1    1331
City7    1325
City3    1261
City4    1251
City6    1180
City5    1159
Name: IncidentCity, dtype: int64
Location 1341    29
Location 1136    28
Location 1469    28
Location 2006    26
Location 1517    25
                 ..
Location 1031     1
Location 1780     1
Location 1540     1
Location 1776     1
Location 1284     1
Name: IncidentAddress, Length: 996, dtype: int64
?      3199
NO     3039
YES    2674
Name: PropertyDamage, dtype: int64
1               2605
2               2534
0               1886
3               1875
MISSINGVALUE      12
Name: Witnesses, dtype: int64
NO     3055
?      3014
YES    2843
Name: PoliceReport, dtype: int64
MISSEDDATA    8
5900          5
5952          5
4647          4
59040         4
             ..
59986         1
78628         1
72408         1
47077         1
67499         1
Name: AmountOfTotalClaim, Length: 8102, dtype: int64
</code></pre>
</div>
</div>
<div class="cell markdown" id="7shsfY4kajyh">
<p><strong>From observation:</strong></p>
<p>Categorical_features=TypeOfIncident,SeverityOfIncident,TypeOfCollision,AuthoritiesContacted,IncidentState,IncidentCity,IncidentAddess,PropertyDamage,BodilyInjuries,Witnesses,PoliceReport,NumberOfVehicles,IncidentTime(hours)</p>
<p>Continous_features=CustomerID,AmountOfInjuryClaim,AmountOfPropertyClaim,AmountOfTotalClaim,AmountOfPropertyClaim,AmountOfVehicleDamage,DateOfIncident</p>
</div>
<div class="cell code" data-execution_count="16" id="hGRSqoK2uJ1z">
<div class="sourceCode" id="cb22"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>date<span class="op">=</span>[]</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>old_date<span class="op">=</span>claim[<span class="st">&#39;DateOfIncident&#39;</span>].to_list()</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(old_date)):</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  date.append(datetime.strptime(<span class="bu">str</span>(old_date[x]),<span class="st">&quot;%Y-%m-</span><span class="sc">%d</span><span class="st">&quot;</span>))</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>claim[<span class="st">&#39;DateOfIncident&#39;</span>]<span class="op">=</span>pd.Series(date)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co">#claim[&#39;DateOfIncident&#39;]=datetime.strptime(claim[&#39;DateOfIncident&#39;],&#39;%Y-%m-%d&#39;)</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>date_test<span class="op">=</span>[]</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>old_date_test<span class="op">=</span>claim_test[<span class="st">&#39;DateOfIncident&#39;</span>].to_list()</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> y <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(old_date_test)):</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  date_test.append(datetime.strptime(<span class="bu">str</span>(old_date_test[y]),<span class="st">&quot;%Y-%m-</span><span class="sc">%d</span><span class="st">&quot;</span>))</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="17" id="mirt1I1JTBJS">
<div class="sourceCode" id="cb23"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>claim_test[<span class="st">&#39;DateOfIncident&#39;</span>]<span class="op">=</span>pd.Series(date_test)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>cat_cols<span class="op">=</span>[<span class="st">&#39;TypeOfIncident&#39;</span>,<span class="st">&#39;IncidentAddress&#39;</span>,<span class="st">&#39;IncidentTime&#39;</span>,<span class="st">&#39;TypeOfCollission&#39;</span>,<span class="st">&#39;NumberOfVehicles&#39;</span>,<span class="st">&#39;SeverityOfIncident&#39;</span>,</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>          <span class="st">&#39;AuthoritiesContacted&#39;</span>,<span class="st">&#39;IncidentState&#39;</span>,<span class="st">&#39;IncidentCity&#39;</span>,<span class="st">&#39;PropertyDamage&#39;</span>,<span class="st">&#39;Witnesses&#39;</span>,<span class="st">&#39;PoliceReport&#39;</span>,<span class="st">&#39;BodilyInjuries&#39;</span>]</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>claim[cat_cols]<span class="op">=</span>claim[cat_cols].astype(<span class="st">&#39;category&#39;</span>)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>claim[<span class="st">&#39;DateOfIncident&#39;</span>]<span class="op">=</span>pd.to_datetime(claim[<span class="st">&#39;DateOfIncident&#39;</span>],<span class="st">&quot;%Y-%m-</span><span class="sc">%d</span><span class="st">&quot;</span>)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>claim_test[cat_cols]<span class="op">=</span>claim_test[cat_cols].astype(<span class="st">&#39;category&#39;</span>)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>claim_test[<span class="st">&#39;DateOfIncident&#39;</span>]<span class="op">=</span>pd.to_datetime(claim_test[<span class="st">&#39;DateOfIncident&#39;</span>],<span class="st">&quot;%Y-%m-</span><span class="sc">%d</span><span class="st">&quot;</span>)</span></code></pre></div>
</div>
<div class="cell markdown" id="XCc4reJLa1bv">
<p><strong>Insights</strong></p>
<p>CustomerID is of no use,but required to merge with other datasets</p>
<p>DateOfIncident:Convert into date and time stamp</p>
<p>TypeOfCollision has missing values:"?"...</p>
<p>IncidentTime has missing values:"-5"</p>
<p>PropertyDamage has missing values:"?"</p>
<p>AmountOfTotalClaim has missing values:"MISSEDDATA"</p>
<p>PoliceReport has missing values:"?"</p>
<p>Witnesses has missing values:"MISSINGVALUE"</p>
</div>
<div class="cell code" data-execution_count="18" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="Nh04Kz6-lFoC" data-outputId="9f785d70-5416-4a31-f2ae-d0330dda5309">
<div class="sourceCode" id="cb24"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(demo.shape)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(demo_test.shape)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>(28836, 10)
(8912, 10)
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="19" data-colab="{&quot;height&quot;:206,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="fSMCyOq1cnd1" data-outputId="8089246d-2c5c-4c3f-e3ff-cb83ba5f42e8">
<div class="sourceCode" id="cb26"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>demo.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="19">

  <div id="df-100d5c74-3eae-4ca3-8747-ef5f8b0902b7">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CustomerID</th>
      <th>InsuredAge</th>
      <th>InsuredZipCode</th>
      <th>InsuredGender</th>
      <th>InsuredEducationLevel</th>
      <th>InsuredOccupation</th>
      <th>InsuredHobbies</th>
      <th>CapitalGains</th>
      <th>CapitalLoss</th>
      <th>Country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Cust10000</td>
      <td>35</td>
      <td>454776</td>
      <td>MALE</td>
      <td>JD</td>
      <td>armed-forces</td>
      <td>movies</td>
      <td>56700</td>
      <td>-48500</td>
      <td>India</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Cust10001</td>
      <td>36</td>
      <td>454776</td>
      <td>MALE</td>
      <td>JD</td>
      <td>tech-support</td>
      <td>cross-fit</td>
      <td>70600</td>
      <td>-48500</td>
      <td>India</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Cust10002</td>
      <td>33</td>
      <td>603260</td>
      <td>MALE</td>
      <td>JD</td>
      <td>armed-forces</td>
      <td>polo</td>
      <td>66400</td>
      <td>-63700</td>
      <td>India</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Cust10003</td>
      <td>36</td>
      <td>474848</td>
      <td>MALE</td>
      <td>JD</td>
      <td>armed-forces</td>
      <td>polo</td>
      <td>47900</td>
      <td>-73400</td>
      <td>India</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Cust10004</td>
      <td>29</td>
      <td>457942</td>
      <td>FEMALE</td>
      <td>High School</td>
      <td>exec-managerial</td>
      <td>dancing</td>
      <td>0</td>
      <td>-41500</td>
      <td>India</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-100d5c74-3eae-4ca3-8747-ef5f8b0902b7')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-100d5c74-3eae-4ca3-8747-ef5f8b0902b7 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-100d5c74-3eae-4ca3-8747-ef5f8b0902b7');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="20" data-colab="{&quot;height&quot;:206,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="lPanzTaacp8M" data-outputId="4466b70e-f2e1-4ace-c397-5ab9c82da494">
<div class="sourceCode" id="cb27"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>demo_test.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="20">

  <div id="df-ec3db7b3-a4cc-40e5-ad82-c2c37860c269">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CustomerID</th>
      <th>InsuredAge</th>
      <th>InsuredZipCode</th>
      <th>InsuredGender</th>
      <th>InsuredEducationLevel</th>
      <th>InsuredOccupation</th>
      <th>InsuredHobbies</th>
      <th>CapitalGains</th>
      <th>CapitalLoss</th>
      <th>Country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Cust10008</td>
      <td>27</td>
      <td>471704</td>
      <td>FEMALE</td>
      <td>High School</td>
      <td>adm-clerical</td>
      <td>base-jumping</td>
      <td>56400</td>
      <td>-57000</td>
      <td>India</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Cust10010</td>
      <td>40</td>
      <td>455810</td>
      <td>FEMALE</td>
      <td>MD</td>
      <td>prof-specialty</td>
      <td>golf</td>
      <td>56700</td>
      <td>-65600</td>
      <td>India</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Cust10015</td>
      <td>39</td>
      <td>461919</td>
      <td>MALE</td>
      <td>JD</td>
      <td>other-service</td>
      <td>movies</td>
      <td>30400</td>
      <td>0</td>
      <td>India</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Cust10020</td>
      <td>38</td>
      <td>600904</td>
      <td>FEMALE</td>
      <td>Masters</td>
      <td>exec-managerial</td>
      <td>video-games</td>
      <td>68500</td>
      <td>0</td>
      <td>India</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Cust1003</td>
      <td>29</td>
      <td>430632</td>
      <td>FEMALE</td>
      <td>PhD</td>
      <td>sales</td>
      <td>board-games</td>
      <td>35100</td>
      <td>0</td>
      <td>India</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-ec3db7b3-a4cc-40e5-ad82-c2c37860c269')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-ec3db7b3-a4cc-40e5-ad82-c2c37860c269 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-ec3db7b3-a4cc-40e5-ad82-c2c37860c269');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="21" data-colab="{&quot;height&quot;:394,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="O9mcTiAwlutG" data-outputId="b50c01a7-44c9-4041-d7ff-46dcc462fb15">
<div class="sourceCode" id="cb28"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">#to understand the distribution of data</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="co">#can differentiate b/w categorical and continous values</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>demo.describe(include<span class="op">=</span><span class="st">&#39;all&#39;</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="21">

  <div id="df-5bb9d3ce-7667-496a-958d-8ef4d069cce3">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CustomerID</th>
      <th>InsuredAge</th>
      <th>InsuredZipCode</th>
      <th>InsuredGender</th>
      <th>InsuredEducationLevel</th>
      <th>InsuredOccupation</th>
      <th>InsuredHobbies</th>
      <th>CapitalGains</th>
      <th>CapitalLoss</th>
      <th>Country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>28836</td>
      <td>28836.000000</td>
      <td>28836.000000</td>
      <td>28806</td>
      <td>28836</td>
      <td>28836</td>
      <td>28836</td>
      <td>28836.000000</td>
      <td>28836.000000</td>
      <td>28834</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>28836</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2</td>
      <td>7</td>
      <td>14</td>
      <td>20</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1</td>
    </tr>
    <tr>
      <th>top</th>
      <td>Cust10000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>FEMALE</td>
      <td>JD</td>
      <td>machine-op-inspct</td>
      <td>bungie-jumping</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>India</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>15644</td>
      <td>4808</td>
      <td>2798</td>
      <td>1751</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>28834</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>NaN</td>
      <td>38.815370</td>
      <td>502436.579068</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>23066.569566</td>
      <td>-24940.612429</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>std</th>
      <td>NaN</td>
      <td>7.996377</td>
      <td>72250.868871</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>27637.813724</td>
      <td>27913.209608</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>min</th>
      <td>NaN</td>
      <td>19.000000</td>
      <td>430104.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>-111100.000000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>NaN</td>
      <td>33.000000</td>
      <td>448603.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>-50000.000000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>NaN</td>
      <td>38.000000</td>
      <td>466691.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>NaN</td>
      <td>44.000000</td>
      <td>603848.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>49000.000000</td>
      <td>0.000000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>max</th>
      <td>NaN</td>
      <td>64.000000</td>
      <td>620962.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>100500.000000</td>
      <td>0.000000</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-5bb9d3ce-7667-496a-958d-8ef4d069cce3')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-5bb9d3ce-7667-496a-958d-8ef4d069cce3 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-5bb9d3ce-7667-496a-958d-8ef4d069cce3');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="22" data-colab="{&quot;height&quot;:394,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="mhC_Tu6Aluvl" data-outputId="53e79858-ca15-467d-b1ea-26c64fb8f074">
<div class="sourceCode" id="cb29"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>demo_test.describe(include<span class="op">=</span><span class="st">&#39;all&#39;</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co">#to understand the distribution of data</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co">#can differentiate b/w categorical and continous values</span></span></code></pre></div>
<div class="output execute_result" data-execution_count="22">

  <div id="df-03cb86e1-928e-42ba-b6f2-7e3174e28fba">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CustomerID</th>
      <th>InsuredAge</th>
      <th>InsuredZipCode</th>
      <th>InsuredGender</th>
      <th>InsuredEducationLevel</th>
      <th>InsuredOccupation</th>
      <th>InsuredHobbies</th>
      <th>CapitalGains</th>
      <th>CapitalLoss</th>
      <th>Country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>8912</td>
      <td>8912.000000</td>
      <td>8912.000000</td>
      <td>8904</td>
      <td>8912</td>
      <td>8912</td>
      <td>8912</td>
      <td>8912.000000</td>
      <td>8912.000000</td>
      <td>8908</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>8912</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2</td>
      <td>7</td>
      <td>14</td>
      <td>20</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1</td>
    </tr>
    <tr>
      <th>top</th>
      <td>Cust10008</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>FEMALE</td>
      <td>JD</td>
      <td>machine-op-inspct</td>
      <td>reading</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>India</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4840</td>
      <td>1404</td>
      <td>830</td>
      <td>653</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>8908</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>NaN</td>
      <td>38.743492</td>
      <td>501558.312949</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>23413.004937</td>
      <td>-25365.888689</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>std</th>
      <td>NaN</td>
      <td>7.914619</td>
      <td>72051.904910</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>27821.325212</td>
      <td>28032.959284</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>min</th>
      <td>NaN</td>
      <td>19.000000</td>
      <td>430104.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>-111100.000000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>NaN</td>
      <td>33.000000</td>
      <td>447469.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>-50400.000000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>NaN</td>
      <td>38.000000</td>
      <td>466303.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>NaN</td>
      <td>44.000000</td>
      <td>603527.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>49900.000000</td>
      <td>0.000000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>max</th>
      <td>NaN</td>
      <td>64.000000</td>
      <td>620962.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>100500.000000</td>
      <td>0.000000</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-03cb86e1-928e-42ba-b6f2-7e3174e28fba')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-03cb86e1-928e-42ba-b6f2-7e3174e28fba button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-03cb86e1-928e-42ba-b6f2-7e3174e28fba');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="23" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="d7Z4-NSHluyq" data-outputId="c2055c8e-0577-4564-c6b1-ea234987f6f5">
<div class="sourceCode" id="cb30"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>demo.dtypes</span></code></pre></div>
<div class="output execute_result" data-execution_count="23">
<pre><code>CustomerID               object
InsuredAge                int64
InsuredZipCode            int64
InsuredGender            object
InsuredEducationLevel    object
InsuredOccupation        object
InsuredHobbies           object
CapitalGains              int64
CapitalLoss               int64
Country                  object
dtype: object</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="24" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="-R78BFYPlu2D" data-outputId="6b1312fd-f23a-47aa-b9cd-a5b968afafcd">
<div class="sourceCode" id="cb32"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>demo_test.dtypes</span></code></pre></div>
<div class="output execute_result" data-execution_count="24">
<pre><code>CustomerID               object
InsuredAge                int64
InsuredZipCode            int64
InsuredGender            object
InsuredEducationLevel    object
InsuredOccupation        object
InsuredHobbies           object
CapitalGains              int64
CapitalLoss               int64
Country                  object
dtype: object</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="25" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="Zsz94yz7l2NR" data-outputId="2b9c5bb3-f222-4a1e-dcaa-2c4361b14020">
<div class="sourceCode" id="cb34"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">#finding the unique values and analysing the data</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x <span class="kw">in</span> demo.select_dtypes(include<span class="op">=</span><span class="st">&#39;object&#39;</span>).columns:</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(demo[x].value_counts())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Cust10000    1
Cust33397    1
Cust33356    1
Cust33354    1
Cust33353    1
            ..
Cust21600    1
Cust2160     1
Cust21599    1
Cust21598    1
Cust9999     1
Name: CustomerID, Length: 28836, dtype: int64
FEMALE    15644
MALE      13162
Name: InsuredGender, dtype: int64
JD             4808
High School    4583
MD             4161
Masters        4141
Associate      4125
PhD            3556
College        3462
Name: InsuredEducationLevel, dtype: int64
machine-op-inspct    2798
prof-specialty       2362
tech-support         2268
priv-house-serv      2176
exec-managerial      2148
sales                2133
craft-repair         2130
transport-moving     2079
armed-forces         2032
other-service        1965
adm-clerical         1924
protective-serv      1715
farming-fishing      1632
handlers-cleaners    1474
Name: InsuredOccupation, dtype: int64
bungie-jumping    1751
paintball         1688
camping           1681
kayaking          1611
exercise          1589
reading           1586
movies            1529
yachting          1486
hiking            1483
base-jumping      1470
golf              1470
video-games       1420
board-games       1396
skydiving         1395
polo              1380
cross-fit         1249
sleeping          1220
dancing           1219
chess             1210
basketball        1003
Name: InsuredHobbies, dtype: int64
India    28834
Name: Country, dtype: int64
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="26" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="-naex_7BqAdW" data-outputId="ea430ba0-7390-4396-da45-ec8bc2feca17">
<div class="sourceCode" id="cb36"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co">#finding the unique values and analysing the data</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x <span class="kw">in</span> demo_test.select_dtypes(include<span class="op">=</span><span class="st">&#39;object&#39;</span>).columns:</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(demo_test[x].value_counts())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Cust10008    1
Cust32827    1
Cust32789    1
Cust32794    1
Cust32802    1
            ..
Cust21506    1
Cust21495    1
Cust21488    1
Cust21486    1
Cust9998     1
Name: CustomerID, Length: 8912, dtype: int64
FEMALE    4840
MALE      4064
Name: InsuredGender, dtype: int64
JD             1404
High School    1392
MD             1324
Associate      1269
Masters        1246
College        1139
PhD            1138
Name: InsuredEducationLevel, dtype: int64
machine-op-inspct    830
prof-specialty       704
priv-house-serv      702
tech-support         696
sales                695
craft-repair         681
armed-forces         630
other-service        617
adm-clerical         612
exec-managerial      610
transport-moving     600
protective-serv      582
handlers-cleaners    495
farming-fishing      458
Name: InsuredOccupation, dtype: int64
reading           653
golf              645
bungie-jumping    571
kayaking          541
camping           540
paintball         522
yachting          500
movies            492
exercise          489
base-jumping      464
hiking            461
board-games       430
sleeping          428
video-games       428
polo              407
dancing           381
skydiving         376
basketball        308
chess             272
cross-fit           4
Name: InsuredHobbies, dtype: int64
India    8908
Name: Country, dtype: int64
</code></pre>
</div>
</div>
<div class="cell markdown" id="vruJdpKCbuTS">
<p><strong>Observations</strong></p>
<p>Categorical_Features: InsuredGender, InsuredZipCode, InsuredEducationLevel, InsuredOccupation, InsuredHobbies, Country</p>
<p>Continous_Features: CapitalGains, CapitalLoss, InsuredAge</p>
</div>
<div class="cell code" data-execution_count="27" id="pDiJ3311m1KI">
<div class="sourceCode" id="cb38"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>cat_cols<span class="op">=</span>demo.select_dtypes(include<span class="op">=</span><span class="st">&#39;object&#39;</span>).columns</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>demo[cat_cols]<span class="op">=</span>demo[cat_cols].astype(<span class="st">&#39;category&#39;</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>demo_test[cat_cols]<span class="op">=</span>demo_test[cat_cols].astype(<span class="st">&#39;category&#39;</span>)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>num_cols<span class="op">=</span>demo.drop(<span class="st">&#39;CustomerID&#39;</span>,axis<span class="op">=</span><span class="dv">1</span>).select_dtypes(exclude<span class="op">=</span><span class="st">&#39;category&#39;</span>).columns</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>demo[num_cols]<span class="op">=</span>demo[num_cols].astype(<span class="st">&#39;int&#39;</span>)</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>demo_test[num_cols]<span class="op">=</span>demo_test[num_cols].astype(<span class="st">&#39;int&#39;</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="28" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="Ur8zeAyhl2S1" data-outputId="e10541d5-0db0-4c71-f971-42a63dbdea63">
<div class="sourceCode" id="cb39"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co">#checking for missing values in the training data(of form NaN)</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>demo.isna().<span class="bu">sum</span>()</span></code></pre></div>
<div class="output execute_result" data-execution_count="28">
<pre><code>CustomerID                0
InsuredAge                0
InsuredZipCode            0
InsuredGender            30
InsuredEducationLevel     0
InsuredOccupation         0
InsuredHobbies            0
CapitalGains              0
CapitalLoss               0
Country                   2
dtype: int64</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="29" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="7Al7ZIkCl98V" data-outputId="bf681c95-2fc2-43a7-f5c1-8501d7a3d69a">
<div class="sourceCode" id="cb41"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co">#checking for missing values in the test data(of form NaN)</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>demo_test.isna().<span class="bu">sum</span>()</span></code></pre></div>
<div class="output execute_result" data-execution_count="29">
<pre><code>CustomerID               0
InsuredAge               0
InsuredZipCode           0
InsuredGender            8
InsuredEducationLevel    0
InsuredOccupation        0
InsuredHobbies           0
CapitalGains             0
CapitalLoss              0
Country                  4
dtype: int64</code></pre>
</div>
</div>
<div class="cell markdown" id="BtRzFvJecbxJ">
<p><strong>Insights</strong></p>
<p>Columns InsuredGender and Country have missing values in the form of NaN</p>
</div>
<div class="cell code" data-execution_count="30" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="SAHAtT12mANH" data-outputId="82cb28ab-3c92-4ba4-9331-ceea20bdfe6c">
<div class="sourceCode" id="cb43"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Starting with Policy</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(policy.shape)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(policy_test.shape)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>(28836, 10)
(8912, 10)
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="31" data-colab="{&quot;height&quot;:270,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="6DYZ9tWlc_vX" data-outputId="3bd4698b-90d6-46b9-f648-783bdaac8637">
<div class="sourceCode" id="cb45"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>policy.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="31">

  <div id="df-28fc50b7-fe07-488a-8767-3973e30c1b24">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>InsurancePolicyNumber</th>
      <th>CustomerLoyaltyPeriod</th>
      <th>DateOfPolicyCoverage</th>
      <th>InsurancePolicyState</th>
      <th>Policy_CombinedSingleLimit</th>
      <th>Policy_Deductible</th>
      <th>PolicyAnnualPremium</th>
      <th>UmbrellaLimit</th>
      <th>InsuredRelationship</th>
      <th>CustomerID</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>110122</td>
      <td>328</td>
      <td>2014-10-17</td>
      <td>State3</td>
      <td>250/500</td>
      <td>1000</td>
      <td>1406.91</td>
      <td>0</td>
      <td>husband</td>
      <td>Cust1001</td>
    </tr>
    <tr>
      <th>1</th>
      <td>110125</td>
      <td>256</td>
      <td>1990-05-25</td>
      <td>State1</td>
      <td>250/500</td>
      <td>2000</td>
      <td>1415.74</td>
      <td>6000000</td>
      <td>unmarried</td>
      <td>Cust1004</td>
    </tr>
    <tr>
      <th>2</th>
      <td>110126</td>
      <td>228</td>
      <td>2014-06-06</td>
      <td>State1</td>
      <td>500/1000</td>
      <td>1000</td>
      <td>1583.91</td>
      <td>6000000</td>
      <td>unmarried</td>
      <td>Cust1005</td>
    </tr>
    <tr>
      <th>3</th>
      <td>110127</td>
      <td>256</td>
      <td>2006-10-12</td>
      <td>State3</td>
      <td>250/500</td>
      <td>1000</td>
      <td>1351.10</td>
      <td>0</td>
      <td>unmarried</td>
      <td>Cust1006</td>
    </tr>
    <tr>
      <th>4</th>
      <td>110128</td>
      <td>137</td>
      <td>2000-06-04</td>
      <td>State2</td>
      <td>250/500</td>
      <td>1000</td>
      <td>1333.35</td>
      <td>0</td>
      <td>husband</td>
      <td>Cust1007</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-28fc50b7-fe07-488a-8767-3973e30c1b24')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-28fc50b7-fe07-488a-8767-3973e30c1b24 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-28fc50b7-fe07-488a-8767-3973e30c1b24');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="32" data-colab="{&quot;height&quot;:270,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="f9YXT2xFdCRm" data-outputId="65b02e89-57c5-4bd3-d8c2-7c11bdc91966">
<div class="sourceCode" id="cb46"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>policy_test.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="32">

  <div id="df-aa67f0f3-ba85-4cbe-ab8e-7ede9e94b857">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>InsurancePolicyNumber</th>
      <th>CustomerLoyaltyPeriod</th>
      <th>DateOfPolicyCoverage</th>
      <th>InsurancePolicyState</th>
      <th>Policy_CombinedSingleLimit</th>
      <th>Policy_Deductible</th>
      <th>PolicyAnnualPremium</th>
      <th>UmbrellaLimit</th>
      <th>InsuredRelationship</th>
      <th>CustomerID</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>110124</td>
      <td>134</td>
      <td>2000-09-06</td>
      <td>State3</td>
      <td>100/300</td>
      <td>2000</td>
      <td>1413.14</td>
      <td>5000000</td>
      <td>own-child</td>
      <td>Cust1003</td>
    </tr>
    <tr>
      <th>1</th>
      <td>110129</td>
      <td>165</td>
      <td>1990-02-03</td>
      <td>State1</td>
      <td>100/300</td>
      <td>1000</td>
      <td>1137.03</td>
      <td>0</td>
      <td>unmarried</td>
      <td>Cust1008</td>
    </tr>
    <tr>
      <th>2</th>
      <td>110137</td>
      <td>473</td>
      <td>1992-10-19</td>
      <td>State2</td>
      <td>100/300</td>
      <td>2000</td>
      <td>1131.40</td>
      <td>0</td>
      <td>other-relative</td>
      <td>Cust1016</td>
    </tr>
    <tr>
      <th>3</th>
      <td>110140</td>
      <td>160</td>
      <td>2014-12-28</td>
      <td>State3</td>
      <td>500/1000</td>
      <td>500</td>
      <td>1374.22</td>
      <td>0</td>
      <td>other-relative</td>
      <td>Cust1019</td>
    </tr>
    <tr>
      <th>4</th>
      <td>110141</td>
      <td>196</td>
      <td>1992-08-02</td>
      <td>State2</td>
      <td>500/1000</td>
      <td>2000</td>
      <td>1475.73</td>
      <td>0</td>
      <td>own-child</td>
      <td>Cust1020</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-aa67f0f3-ba85-4cbe-ab8e-7ede9e94b857')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-aa67f0f3-ba85-4cbe-ab8e-7ede9e94b857 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-aa67f0f3-ba85-4cbe-ab8e-7ede9e94b857');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="33" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="r3yEA3JjmAPz" data-outputId="4ff3d9ff-7278-4446-a4ed-a458324b8bcb">
<div class="sourceCode" id="cb47"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(policy.dtypes)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(policy_test.dtypes)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>InsurancePolicyNumber           int64
CustomerLoyaltyPeriod           int64
DateOfPolicyCoverage           object
InsurancePolicyState           object
Policy_CombinedSingleLimit     object
Policy_Deductible               int64
PolicyAnnualPremium           float64
UmbrellaLimit                   int64
InsuredRelationship            object
CustomerID                     object
dtype: object
InsurancePolicyNumber           int64
CustomerLoyaltyPeriod           int64
DateOfPolicyCoverage           object
InsurancePolicyState           object
Policy_CombinedSingleLimit     object
Policy_Deductible               int64
PolicyAnnualPremium           float64
UmbrellaLimit                   int64
InsuredRelationship            object
CustomerID                     object
dtype: object
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="34" data-colab="{&quot;height&quot;:458,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="vpM0CUBFmASi" data-outputId="6e8ab8ae-aea4-4cba-f836-a0d018f9499b">
<div class="sourceCode" id="cb49"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>policy.describe(include<span class="op">=</span><span class="st">&#39;all&#39;</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="34">

  <div id="df-1ea542e7-dd65-41ef-8af1-c40324ab9f61">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>InsurancePolicyNumber</th>
      <th>CustomerLoyaltyPeriod</th>
      <th>DateOfPolicyCoverage</th>
      <th>InsurancePolicyState</th>
      <th>Policy_CombinedSingleLimit</th>
      <th>Policy_Deductible</th>
      <th>PolicyAnnualPremium</th>
      <th>UmbrellaLimit</th>
      <th>InsuredRelationship</th>
      <th>CustomerID</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>28836.000000</td>
      <td>28836.000000</td>
      <td>28836</td>
      <td>28836</td>
      <td>28836</td>
      <td>28836.000000</td>
      <td>28836.000000</td>
      <td>2.883600e+04</td>
      <td>28836</td>
      <td>28836</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>6779</td>
      <td>3</td>
      <td>9</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>6</td>
      <td>28836</td>
    </tr>
    <tr>
      <th>top</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>1998-11-11</td>
      <td>State3</td>
      <td>250/500</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>own-child</td>
      <td>Cust1001</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>38</td>
      <td>10146</td>
      <td>8260</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>5242</td>
      <td>1</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>129312.517097</td>
      <td>203.067867</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1114.282529</td>
      <td>1255.528382</td>
      <td>9.836680e+05</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>std</th>
      <td>11114.060267</td>
      <td>99.932951</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>546.632816</td>
      <td>223.013899</td>
      <td>1.969282e+06</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>min</th>
      <td>110122.000000</td>
      <td>1.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>500.000000</td>
      <td>-1.000000</td>
      <td>-1.000000e+06</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>119698.750000</td>
      <td>126.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>622.000000</td>
      <td>1122.007500</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>129278.500000</td>
      <td>199.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1000.000000</td>
      <td>1265.205000</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>138933.250000</td>
      <td>267.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1627.000000</td>
      <td>1396.605000</td>
      <td>4.859610e+05</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>max</th>
      <td>148619.000000</td>
      <td>479.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2000.000000</td>
      <td>2047.590000</td>
      <td>1.000000e+07</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-1ea542e7-dd65-41ef-8af1-c40324ab9f61')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-1ea542e7-dd65-41ef-8af1-c40324ab9f61 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-1ea542e7-dd65-41ef-8af1-c40324ab9f61');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="35" data-colab="{&quot;height&quot;:458,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="RykItTCemVsQ" data-outputId="2e322cb8-7ef0-4765-95a1-48b693e11b5d">
<div class="sourceCode" id="cb50"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>policy_test.describe(include<span class="op">=</span><span class="st">&#39;all&#39;</span>,datetime_is_numeric<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="35">

  <div id="df-41eb56b2-5835-49ce-b61b-118cb2c603d6">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>InsurancePolicyNumber</th>
      <th>CustomerLoyaltyPeriod</th>
      <th>DateOfPolicyCoverage</th>
      <th>InsurancePolicyState</th>
      <th>Policy_CombinedSingleLimit</th>
      <th>Policy_Deductible</th>
      <th>PolicyAnnualPremium</th>
      <th>UmbrellaLimit</th>
      <th>InsuredRelationship</th>
      <th>CustomerID</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>8912.000000</td>
      <td>8912.000000</td>
      <td>8912</td>
      <td>8912</td>
      <td>8912</td>
      <td>8912.000000</td>
      <td>8912.000000</td>
      <td>8.912000e+03</td>
      <td>8912</td>
      <td>8912</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>4533</td>
      <td>3</td>
      <td>9</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>6</td>
      <td>8912</td>
    </tr>
    <tr>
      <th>top</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>1992-04-14</td>
      <td>State3</td>
      <td>100/300</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>own-child</td>
      <td>Cust1003</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>15</td>
      <td>3132</td>
      <td>2561</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1643</td>
      <td>1</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>130481.939295</td>
      <td>203.055206</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1123.580790</td>
      <td>1253.583573</td>
      <td>9.318594e+05</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>std</th>
      <td>10879.022180</td>
      <td>98.423250</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>553.139684</td>
      <td>224.426443</td>
      <td>1.919603e+06</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>min</th>
      <td>110124.000000</td>
      <td>0.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>500.000000</td>
      <td>-1.000000</td>
      <td>-8.836920e+05</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>121312.500000</td>
      <td>127.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>622.000000</td>
      <td>1117.010000</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>130807.000000</td>
      <td>199.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1000.000000</td>
      <td>1264.615000</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>139904.000000</td>
      <td>265.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1691.250000</td>
      <td>1398.722500</td>
      <td>2.836810e+05</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>max</th>
      <td>148617.000000</td>
      <td>478.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2000.000000</td>
      <td>2033.540000</td>
      <td>9.699227e+06</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-41eb56b2-5835-49ce-b61b-118cb2c603d6')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-41eb56b2-5835-49ce-b61b-118cb2c603d6 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-41eb56b2-5835-49ce-b61b-118cb2c603d6');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="36" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="zPdFJgq2mAVY" data-outputId="0a469699-b93e-47dd-dfd8-ba339703b139">
<div class="sourceCode" id="cb51"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x <span class="kw">in</span> policy.drop(<span class="st">&#39;CustomerID&#39;</span>,axis<span class="op">=</span><span class="dv">1</span>).select_dtypes(include<span class="op">=</span><span class="st">&#39;object&#39;</span>).columns:</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(policy[x].value_counts())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>1998-11-11    38
1995-08-19    32
1999-05-23    28
2001-06-10    27
2005-06-17    27
              ..
2012-09-27     1
2004-12-31     1
1999-07-31     1
1997-12-22     1
2010-12-14     1
Name: DateOfPolicyCoverage, Length: 6779, dtype: int64
State3    10146
State1     9716
State2     8974
Name: InsurancePolicyState, dtype: int64
250/500     8260
100/300     8050
500/1000    7000
250/300     1024
100/500      962
250/1000     953
500/500      872
500/300      868
100/1000     847
Name: Policy_CombinedSingleLimit, dtype: int64
own-child         5242
not-in-family     5222
other-relative    5153
husband           5002
wife              4224
unmarried         3993
Name: InsuredRelationship, dtype: int64
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="37" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="SEngklOlmaQ9" data-outputId="2d5f220f-c0f3-4ea4-9b9f-abd20bf98d4d">
<div class="sourceCode" id="cb53"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x <span class="kw">in</span> policy_test.drop(<span class="st">&#39;CustomerID&#39;</span>,axis<span class="op">=</span><span class="dv">1</span>).select_dtypes(include<span class="op">=</span><span class="st">&#39;object&#39;</span>).columns:</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(policy_test[x].value_counts())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>1992-04-14    15
2003-03-09    12
1994-08-21    12
1995-08-19    11
1996-12-21     9
              ..
2007-11-07     1
2007-07-06     1
2008-12-16     1
1999-01-15     1
2011-11-17     1
Name: DateOfPolicyCoverage, Length: 4533, dtype: int64
State3    3132
State1    2971
State2    2809
Name: InsurancePolicyState, dtype: int64
100/300     2561
250/500     2532
500/1000    2195
250/300      308
100/500      302
100/1000     278
250/1000     264
500/300      236
500/500      236
Name: Policy_CombinedSingleLimit, dtype: int64
own-child         1643
husband           1583
not-in-family     1559
other-relative    1503
wife              1336
unmarried         1288
Name: InsuredRelationship, dtype: int64
</code></pre>
</div>
</div>
<div class="cell markdown" id="7kUsqlyZdnvy">
<p><strong>Observations</strong></p>
<p>Categorical_Features: InsurancePolicyState, Policy_CombinedSingleLimit, InsuredRelationship</p>
<p>Continous_Features: CustomerLoyaltyPeriod, Policy_Deductible, PolicyAnnualPremium, UmbrellaLimit, InsurancePolicyNumber</p>
<p>Datetime_Features: DateOfPolicyCoverage</p>
</div>
<div class="cell code" data-execution_count="38" id="Pqwl-PACWYnH">
<div class="sourceCode" id="cb55"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Converting DateOfPolicyCoverage into datetime format:</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>dop<span class="op">=</span>policy[<span class="st">&#39;DateOfPolicyCoverage&#39;</span>].to_list()</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>new_dop<span class="op">=</span>[]</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(dop)):</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  y<span class="op">=</span><span class="bu">str</span>(dop[x]).split(<span class="st">&quot; &quot;</span>)</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>  new_dop.append(datetime.strptime(y[<span class="dv">0</span>],<span class="st">&quot;%Y-%m-</span><span class="sc">%d</span><span class="st">&quot;</span>))</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>policy[<span class="st">&#39;DateOfPolicyCoverage&#39;</span>]<span class="op">=</span>pd.Series(new_dop)</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a><span class="co">###############################################################</span></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>dop_test<span class="op">=</span>policy_test[<span class="st">&#39;DateOfPolicyCoverage&#39;</span>].to_list()</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>new_dop_test<span class="op">=</span>[]</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(dop_test)):</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>  y<span class="op">=</span><span class="bu">str</span>(dop_test[x]).split(<span class="st">&quot; &quot;</span>)</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>  new_dop_test.append(datetime.strptime(y[<span class="dv">0</span>],<span class="st">&quot;%Y-%m-</span><span class="sc">%d</span><span class="st">&quot;</span>))</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>policy_test[<span class="st">&#39;DateOfPolicyCoverage&#39;</span>]<span class="op">=</span>pd.Series(new_dop_test)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="39" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="6Ez10l2OmAYM" data-outputId="5b078148-8d8f-4a9a-bcc9-4152cc81da57">
<div class="sourceCode" id="cb56"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co">#seems there are no missing values in the set</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>policy.isna().<span class="bu">sum</span>()</span></code></pre></div>
<div class="output execute_result" data-execution_count="39">
<pre><code>InsurancePolicyNumber         0
CustomerLoyaltyPeriod         0
DateOfPolicyCoverage          0
InsurancePolicyState          0
Policy_CombinedSingleLimit    0
Policy_Deductible             0
PolicyAnnualPremium           0
UmbrellaLimit                 0
InsuredRelationship           0
CustomerID                    0
dtype: int64</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="40" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="w1ycsWbcmAbq" data-outputId="0169c447-cf6f-42fb-8b93-12466bd3fff7">
<div class="sourceCode" id="cb58"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>policy_test.isna().<span class="bu">sum</span>()</span></code></pre></div>
<div class="output execute_result" data-execution_count="40">
<pre><code>InsurancePolicyNumber         0
CustomerLoyaltyPeriod         0
DateOfPolicyCoverage          0
InsurancePolicyState          0
Policy_CombinedSingleLimit    0
Policy_Deductible             0
PolicyAnnualPremium           0
UmbrellaLimit                 0
InsuredRelationship           0
CustomerID                    0
dtype: int64</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="41" id="zoVAYJu5mAh6">
<div class="sourceCode" id="cb60"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co">#to covert the cols into cat</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>cat_cols<span class="op">=</span>policy.drop(<span class="st">&#39;CustomerID&#39;</span>,axis<span class="op">=</span><span class="dv">1</span>).select_dtypes(include<span class="op">=</span><span class="st">&#39;object&#39;</span>).columns</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>policy[cat_cols]<span class="op">=</span>policy[cat_cols].astype(<span class="st">&#39;category&#39;</span>)</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>policy_test[cat_cols]<span class="op">=</span>policy_test[cat_cols].astype(<span class="st">&#39;category&#39;</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="42" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="GlUf62ltnAbJ" data-outputId="40c51b6c-b396-4fd4-faf7-c47d540d1a8a">
<div class="sourceCode" id="cb61"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(vehicle.shape)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(vehicle_test.shape)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>(115344, 3)
(35648, 3)
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="43" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="kAMXZb39nEjs" data-outputId="8fe7815f-ebae-4751-d735-2e6fd2e2a42c">
<div class="sourceCode" id="cb63"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(vehicle.head())</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(vehicle_test.head())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>  CustomerID VehicleAttribute VehicleAttributeDetails
0  Cust20179        VehicleID             Vehicle8898
1  Cust21384     VehicleModel                  Malibu
2  Cust33335      VehicleMake                  Toyota
3  Cust27118     VehicleModel                    Neon
4  Cust13038        VehicleID            Vehicle30212
  CustomerID VehicleAttribute VehicleAttributeDetails
0  Cust28465     VehicleModel                     92x
1  Cust20319     VehicleModel                   Jetta
2   Cust3683        VehicleID            Vehicle22709
3  Cust29385        VehicleID            Vehicle20347
4  Cust34403     VehicleModel                   Camry
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="44" data-colab="{&quot;height&quot;:175,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="SbDZGu1UnEmb" data-outputId="b51f3ca5-5deb-468b-f0aa-3597c4c56d9c">
<div class="sourceCode" id="cb65"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>vehicle.describe(include<span class="op">=</span><span class="st">&#39;all&#39;</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="44">

  <div id="df-e5eae640-9a0d-458a-82b2-547ca16a6348">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CustomerID</th>
      <th>VehicleAttribute</th>
      <th>VehicleAttributeDetails</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>115344</td>
      <td>115344</td>
      <td>115344</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>28836</td>
      <td>4</td>
      <td>28911</td>
    </tr>
    <tr>
      <th>top</th>
      <td>Cust20179</td>
      <td>VehicleID</td>
      <td>Saab</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>4</td>
      <td>28836</td>
      <td>2415</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-e5eae640-9a0d-458a-82b2-547ca16a6348')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-e5eae640-9a0d-458a-82b2-547ca16a6348 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-e5eae640-9a0d-458a-82b2-547ca16a6348');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="45" data-colab="{&quot;height&quot;:175,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="0s3dGjeGnRmY" data-outputId="e5a491c4-8f9c-4ada-c61a-3fc61e448853">
<div class="sourceCode" id="cb66"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>vehicle_test.describe(include<span class="op">=</span><span class="st">&#39;all&#39;</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="45">

  <div id="df-6cdddf6e-9560-4246-923b-a50ab64b604d">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CustomerID</th>
      <th>VehicleAttribute</th>
      <th>VehicleAttributeDetails</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>35648</td>
      <td>35648</td>
      <td>35648</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>8912</td>
      <td>4</td>
      <td>8986</td>
    </tr>
    <tr>
      <th>top</th>
      <td>Cust28465</td>
      <td>VehicleModel</td>
      <td>Suburu</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>4</td>
      <td>8912</td>
      <td>743</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-6cdddf6e-9560-4246-923b-a50ab64b604d')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-6cdddf6e-9560-4246-923b-a50ab64b604d button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-6cdddf6e-9560-4246-923b-a50ab64b604d');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="46" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="dT6-RsMEnEoq" data-outputId="aa8384c4-089b-4a9d-c713-a4d1aefaddb0">
<div class="sourceCode" id="cb67"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co">#both VehicleAttribute and VehicleAttributeDetails are cat</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x <span class="kw">in</span> vehicle.drop(<span class="st">&#39;CustomerID&#39;</span>,axis<span class="op">=</span><span class="dv">1</span>).columns:</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(vehicle[x].value_counts())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>VehicleID       28836
VehicleModel    28836
VehicleMake     28836
VehicleYOM      28836
Name: VehicleAttribute, dtype: int64
Saab            2415
Suburu          2313
Nissan          2300
Dodge           2263
Chevrolet       2174
                ... 
Vehicle10389       1
Vehicle17695       1
Vehicle2852        1
Vehicle24978       1
Vehicle19680       1
Name: VehicleAttributeDetails, Length: 28911, dtype: int64
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="47" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="koOuqU4JnEq4" data-outputId="0153e1d6-abe5-43c3-cc97-5efbce535f8b">
<div class="sourceCode" id="cb69"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x <span class="kw">in</span> vehicle_test.drop(<span class="st">&#39;CustomerID&#39;</span>,axis<span class="op">=</span><span class="dv">1</span>).columns:</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(vehicle_test[x].value_counts())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>VehicleModel    8912
VehicleID       8912
VehicleYOM      8912
VehicleMake     8912
Name: VehicleAttribute, dtype: int64
Suburu          743
Nissan          741
Jeep            725
Chevrolet       718
Saab            714
               ... 
Vehicle25558      1
Vehicle32691      1
Vehicle3354       1
Vehicle33760      1
Vehicle33407      1
Name: VehicleAttributeDetails, Length: 8986, dtype: int64
</code></pre>
</div>
</div>
<div class="cell markdown" id="yZH0LO42enuP">
<p><strong>Observations</strong></p>
<p>The column VehicleAttribute contains 4 different data categories which can be split into separate 4 columns:</p>
<p>VehicleID, VehicleModel, VehicleMake, Vehicle YearOfManufacture(YOM)</p>
</div>
<div class="cell code" data-execution_count="48" id="uSEJO3G0nXyP">
<div class="sourceCode" id="cb71"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>vehicle[<span class="st">&#39;VehicleAttribute&#39;</span>]<span class="op">=</span>vehicle[<span class="st">&#39;VehicleAttribute&#39;</span>].astype(<span class="st">&#39;category&#39;</span>)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>vehicle_test[<span class="st">&#39;VehicleAttribute&#39;</span>]<span class="op">=</span>vehicle_test[<span class="st">&#39;VehicleAttribute&#39;</span>].astype(<span class="st">&#39;category&#39;</span>)</span></code></pre></div>
</div>
<div class="cell markdown">
<p><strong>To separate the values VehicleAttribute,VehicleMake,Vehicle Year of Make</strong></p>
</div>
<div class="cell code" data-execution_count="49" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="2RWzMXPtnean" data-outputId="edc90746-e607-4f1a-efc9-e968836565b3">
<div class="sourceCode" id="cb72"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>new_v<span class="op">=</span>pd.DataFrame(vehicle[<span class="st">&#39;CustomerID&#39;</span>].unique(),columns<span class="op">=</span>[<span class="st">&#39;CustomerID&#39;</span>])</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>df<span class="op">=</span>vehicle.groupby(by<span class="op">=</span><span class="st">&#39;VehicleAttribute&#39;</span>)</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>by_model<span class="op">=</span>pd.DataFrame(df.get_group(<span class="st">&#39;VehicleModel&#39;</span>))</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>model_details<span class="op">=</span>pd.Series(by_model.VehicleAttributeDetails)</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>new_v<span class="op">=</span>new_v.merge(by_model,on<span class="op">=</span><span class="st">&#39;CustomerID&#39;</span>,how<span class="op">=</span><span class="st">&#39;inner&#39;</span>)</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>by_make<span class="op">=</span>pd.DataFrame(df.get_group(<span class="st">&#39;VehicleMake&#39;</span>))</span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>make_details<span class="op">=</span>pd.Series(by_make.VehicleAttributeDetails)</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>new_v<span class="op">=</span>new_v.merge(by_make,on<span class="op">=</span><span class="st">&#39;CustomerID&#39;</span>,how<span class="op">=</span><span class="st">&#39;inner&#39;</span>)</span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>by_yom<span class="op">=</span>pd.DataFrame(df.get_group(<span class="st">&#39;VehicleYOM&#39;</span>))</span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>yom_details<span class="op">=</span>pd.Series(by_yom.VehicleAttributeDetails)</span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a>new_v<span class="op">=</span>new_v.merge(by_yom,on<span class="op">=</span><span class="st">&#39;CustomerID&#39;</span>,how<span class="op">=</span><span class="st">&#39;inner&#39;</span>)</span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a>by_ID<span class="op">=</span>pd.DataFrame(df.get_group(<span class="st">&#39;VehicleID&#39;</span>))</span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a>ID_details<span class="op">=</span>pd.Series(by_ID.VehicleAttributeDetails)</span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a>new_v<span class="op">=</span>new_v.merge(by_ID,on<span class="op">=</span><span class="st">&#39;CustomerID&#39;</span>,how<span class="op">=</span><span class="st">&#39;inner&#39;</span>)</span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-21"><a href="#cb72-21" aria-hidden="true" tabindex="-1"></a>new_v.columns<span class="op">=</span>[<span class="st">&#39;CustomerID&#39;</span>,<span class="st">&#39;VM&#39;</span>,<span class="st">&#39;Model&#39;</span>,<span class="st">&#39;VMK&#39;</span>,<span class="st">&#39;Make&#39;</span>,<span class="st">&#39;VYOM&#39;</span>,<span class="st">&#39;YOM&#39;</span>,<span class="st">&#39;VID&#39;</span>,<span class="st">&#39;ID&#39;</span>]</span>
<span id="cb72-22"><a href="#cb72-22" aria-hidden="true" tabindex="-1"></a><span class="co">#############################################################################</span></span>
<span id="cb72-23"><a href="#cb72-23" aria-hidden="true" tabindex="-1"></a>new_v_test<span class="op">=</span>pd.DataFrame(vehicle_test[<span class="st">&#39;CustomerID&#39;</span>].unique(),columns<span class="op">=</span>[<span class="st">&#39;CustomerID&#39;</span>])</span>
<span id="cb72-24"><a href="#cb72-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-25"><a href="#cb72-25" aria-hidden="true" tabindex="-1"></a>df_test<span class="op">=</span>vehicle_test.groupby(by<span class="op">=</span><span class="st">&#39;VehicleAttribute&#39;</span>)</span>
<span id="cb72-26"><a href="#cb72-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-27"><a href="#cb72-27" aria-hidden="true" tabindex="-1"></a>by_model_test<span class="op">=</span>pd.DataFrame(df_test.get_group(<span class="st">&#39;VehicleModel&#39;</span>))</span>
<span id="cb72-28"><a href="#cb72-28" aria-hidden="true" tabindex="-1"></a>model_details_test<span class="op">=</span>pd.Series(by_model_test.VehicleAttributeDetails)</span>
<span id="cb72-29"><a href="#cb72-29" aria-hidden="true" tabindex="-1"></a>new_v_test<span class="op">=</span>new_v_test.merge(by_model_test,on<span class="op">=</span><span class="st">&#39;CustomerID&#39;</span>,how<span class="op">=</span><span class="st">&#39;inner&#39;</span>)</span>
<span id="cb72-30"><a href="#cb72-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-31"><a href="#cb72-31" aria-hidden="true" tabindex="-1"></a>by_make_test<span class="op">=</span>pd.DataFrame(df_test.get_group(<span class="st">&#39;VehicleMake&#39;</span>))</span>
<span id="cb72-32"><a href="#cb72-32" aria-hidden="true" tabindex="-1"></a>make_details_test<span class="op">=</span>pd.Series(by_make_test.VehicleAttributeDetails)</span>
<span id="cb72-33"><a href="#cb72-33" aria-hidden="true" tabindex="-1"></a>new_v_test<span class="op">=</span>new_v_test.merge(by_make_test,on<span class="op">=</span><span class="st">&#39;CustomerID&#39;</span>,how<span class="op">=</span><span class="st">&#39;inner&#39;</span>)</span>
<span id="cb72-34"><a href="#cb72-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-35"><a href="#cb72-35" aria-hidden="true" tabindex="-1"></a>by_yom_test<span class="op">=</span>pd.DataFrame(df_test.get_group(<span class="st">&#39;VehicleYOM&#39;</span>))</span>
<span id="cb72-36"><a href="#cb72-36" aria-hidden="true" tabindex="-1"></a>yom_details_test<span class="op">=</span>pd.Series(by_yom_test.VehicleAttributeDetails)</span>
<span id="cb72-37"><a href="#cb72-37" aria-hidden="true" tabindex="-1"></a>new_v_test<span class="op">=</span>new_v_test.merge(by_yom_test,on<span class="op">=</span><span class="st">&#39;CustomerID&#39;</span>,how<span class="op">=</span><span class="st">&#39;inner&#39;</span>)</span>
<span id="cb72-38"><a href="#cb72-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-39"><a href="#cb72-39" aria-hidden="true" tabindex="-1"></a>by_ID_test<span class="op">=</span>pd.DataFrame(df_test.get_group(<span class="st">&#39;VehicleID&#39;</span>))</span>
<span id="cb72-40"><a href="#cb72-40" aria-hidden="true" tabindex="-1"></a>ID_details_test<span class="op">=</span>pd.Series(by_ID_test.VehicleAttributeDetails)</span>
<span id="cb72-41"><a href="#cb72-41" aria-hidden="true" tabindex="-1"></a>new_v_test<span class="op">=</span>new_v_test.merge(by_ID_test,on<span class="op">=</span><span class="st">&#39;CustomerID&#39;</span>,how<span class="op">=</span><span class="st">&#39;inner&#39;</span>)</span>
<span id="cb72-42"><a href="#cb72-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-43"><a href="#cb72-43" aria-hidden="true" tabindex="-1"></a>new_v_test.columns<span class="op">=</span>[<span class="st">&#39;CustomerID&#39;</span>,<span class="st">&#39;VM&#39;</span>,<span class="st">&#39;Model&#39;</span>,<span class="st">&#39;VMK&#39;</span>,<span class="st">&#39;Make&#39;</span>,<span class="st">&#39;VYOM&#39;</span>,<span class="st">&#39;YOM&#39;</span>,<span class="st">&#39;VID&#39;</span>,<span class="st">&#39;ID&#39;</span>]</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/usr/local/lib/python3.7/dist-packages/pandas/core/frame.py:9203: FutureWarning: Passing &#39;suffixes&#39; which cause duplicate columns {&#39;VehicleAttribute_x&#39;, &#39;VehicleAttributeDetails_x&#39;} in the result is deprecated and will raise a MergeError in a future version.
  validate=validate,
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="50" data-colab="{&quot;height&quot;:424,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="GgD3jlySoaIG" data-outputId="65b38379-bb68-4a7f-f643-34040af5aa2b">
<div class="sourceCode" id="cb74"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>new_v</span></code></pre></div>
<div class="output execute_result" data-execution_count="50">

  <div id="df-72b528a7-2b00-41f5-98a7-eb0819420265">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CustomerID</th>
      <th>VM</th>
      <th>Model</th>
      <th>VMK</th>
      <th>Make</th>
      <th>VYOM</th>
      <th>YOM</th>
      <th>VID</th>
      <th>ID</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Cust20179</td>
      <td>VehicleModel</td>
      <td>Forrestor</td>
      <td>VehicleMake</td>
      <td>BMW</td>
      <td>VehicleYOM</td>
      <td>2011</td>
      <td>VehicleID</td>
      <td>Vehicle8898</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Cust21384</td>
      <td>VehicleModel</td>
      <td>Malibu</td>
      <td>VehicleMake</td>
      <td>Chevrolet</td>
      <td>VehicleYOM</td>
      <td>2010</td>
      <td>VehicleID</td>
      <td>Vehicle18688</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Cust33335</td>
      <td>VehicleModel</td>
      <td>Highlander</td>
      <td>VehicleMake</td>
      <td>Toyota</td>
      <td>VehicleYOM</td>
      <td>2001</td>
      <td>VehicleID</td>
      <td>Vehicle8998</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Cust27118</td>
      <td>VehicleModel</td>
      <td>Neon</td>
      <td>VehicleMake</td>
      <td>Saab</td>
      <td>VehicleYOM</td>
      <td>1998</td>
      <td>VehicleID</td>
      <td>Vehicle28504</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Cust13038</td>
      <td>VehicleModel</td>
      <td>Maxima</td>
      <td>VehicleMake</td>
      <td>Toyota</td>
      <td>VehicleYOM</td>
      <td>2000</td>
      <td>VehicleID</td>
      <td>Vehicle30212</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>28831</th>
      <td>Cust38038</td>
      <td>VehicleModel</td>
      <td>Legacy</td>
      <td>VehicleMake</td>
      <td>Suburu</td>
      <td>VehicleYOM</td>
      <td>2015</td>
      <td>VehicleID</td>
      <td>Vehicle35675</td>
    </tr>
    <tr>
      <th>28832</th>
      <td>Cust19790</td>
      <td>VehicleModel</td>
      <td>Highlander</td>
      <td>VehicleMake</td>
      <td>Toyota</td>
      <td>VehicleYOM</td>
      <td>2004</td>
      <td>VehicleID</td>
      <td>Vehicle25421</td>
    </tr>
    <tr>
      <th>28833</th>
      <td>Cust24765</td>
      <td>VehicleModel</td>
      <td>Camry</td>
      <td>VehicleMake</td>
      <td>Toyota</td>
      <td>VehicleYOM</td>
      <td>2008</td>
      <td>VehicleID</td>
      <td>Vehicle6349</td>
    </tr>
    <tr>
      <th>28834</th>
      <td>Cust10942</td>
      <td>VehicleModel</td>
      <td>95</td>
      <td>VehicleMake</td>
      <td>Saab</td>
      <td>VehicleYOM</td>
      <td>2010</td>
      <td>VehicleID</td>
      <td>Vehicle23641</td>
    </tr>
    <tr>
      <th>28835</th>
      <td>Cust15237</td>
      <td>VehicleModel</td>
      <td>Jetta</td>
      <td>VehicleMake</td>
      <td>Volkswagen</td>
      <td>VehicleYOM</td>
      <td>2010</td>
      <td>VehicleID</td>
      <td>Vehicle25510</td>
    </tr>
  </tbody>
</table>
<p>28836 rows  9 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-72b528a7-2b00-41f5-98a7-eb0819420265')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-72b528a7-2b00-41f5-98a7-eb0819420265 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-72b528a7-2b00-41f5-98a7-eb0819420265');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="51" data-colab="{&quot;height&quot;:424,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="LL2iAr6poaOs" data-outputId="e1277d09-11f7-42b2-87c2-6e564369e112">
<div class="sourceCode" id="cb75"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>new_v_test</span></code></pre></div>
<div class="output execute_result" data-execution_count="51">

  <div id="df-29a715a4-495b-4dfa-a510-3de6031c4d4b">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CustomerID</th>
      <th>VM</th>
      <th>Model</th>
      <th>VMK</th>
      <th>Make</th>
      <th>VYOM</th>
      <th>YOM</th>
      <th>VID</th>
      <th>ID</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Cust28465</td>
      <td>VehicleModel</td>
      <td>92x</td>
      <td>VehicleMake</td>
      <td>Suburu</td>
      <td>VehicleYOM</td>
      <td>2001</td>
      <td>VehicleID</td>
      <td>Vehicle36793</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Cust20319</td>
      <td>VehicleModel</td>
      <td>Jetta</td>
      <td>VehicleMake</td>
      <td>Dodge</td>
      <td>VehicleYOM</td>
      <td>2006</td>
      <td>VehicleID</td>
      <td>Vehicle7679</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Cust3683</td>
      <td>VehicleModel</td>
      <td>ML350</td>
      <td>VehicleMake</td>
      <td>Audi</td>
      <td>VehicleYOM</td>
      <td>1997</td>
      <td>VehicleID</td>
      <td>Vehicle22709</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Cust29385</td>
      <td>VehicleModel</td>
      <td>Grand Cherokee</td>
      <td>VehicleMake</td>
      <td>Suburu</td>
      <td>VehicleYOM</td>
      <td>2003</td>
      <td>VehicleID</td>
      <td>Vehicle20347</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Cust34403</td>
      <td>VehicleModel</td>
      <td>Camry</td>
      <td>VehicleMake</td>
      <td>Toyota</td>
      <td>VehicleYOM</td>
      <td>2014</td>
      <td>VehicleID</td>
      <td>Vehicle26765</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>8907</th>
      <td>Cust31324</td>
      <td>VehicleModel</td>
      <td>MDX</td>
      <td>VehicleMake</td>
      <td>Toyota</td>
      <td>VehicleYOM</td>
      <td>2001</td>
      <td>VehicleID</td>
      <td>Vehicle26914</td>
    </tr>
    <tr>
      <th>8908</th>
      <td>Cust25423</td>
      <td>VehicleModel</td>
      <td>Tahoe</td>
      <td>VehicleMake</td>
      <td>Chevrolet</td>
      <td>VehicleYOM</td>
      <td>2009</td>
      <td>VehicleID</td>
      <td>Vehicle24940</td>
    </tr>
    <tr>
      <th>8909</th>
      <td>Cust15558</td>
      <td>VehicleModel</td>
      <td>MDX</td>
      <td>VehicleMake</td>
      <td>Accura</td>
      <td>VehicleYOM</td>
      <td>1995</td>
      <td>VehicleID</td>
      <td>Vehicle23640</td>
    </tr>
    <tr>
      <th>8910</th>
      <td>Cust20134</td>
      <td>VehicleModel</td>
      <td>F150</td>
      <td>VehicleMake</td>
      <td>Ford</td>
      <td>VehicleYOM</td>
      <td>1997</td>
      <td>VehicleID</td>
      <td>Vehicle30549</td>
    </tr>
    <tr>
      <th>8911</th>
      <td>Cust8371</td>
      <td>VehicleModel</td>
      <td>Legacy</td>
      <td>VehicleMake</td>
      <td>Suburu</td>
      <td>VehicleYOM</td>
      <td>2005</td>
      <td>VehicleID</td>
      <td>Vehicle5195</td>
    </tr>
  </tbody>
</table>
<p>8912 rows  9 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-29a715a4-495b-4dfa-a510-3de6031c4d4b')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-29a715a4-495b-4dfa-a510-3de6031c4d4b button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-29a715a4-495b-4dfa-a510-3de6031c4d4b');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-execution_count="52" id="0FhVeTtF0zOk">
<div class="sourceCode" id="cb76"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co">#To remove the prefix Vehicle from the VehicleID in train and test sets.</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>v_id<span class="op">=</span>new_v[<span class="st">&#39;ID&#39;</span>]</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>v_id_rm<span class="op">=</span>[]</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(v_id)):</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>  y<span class="op">=</span><span class="bu">str</span>(v_id[x])</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>  v_id_rm.append(<span class="bu">int</span>(y[<span class="dv">7</span>:]))</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>new_v[<span class="st">&#39;ID&#39;</span>]<span class="op">=</span>v_id_rm</span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>v_id_test<span class="op">=</span>new_v_test[<span class="st">&#39;ID&#39;</span>]</span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>v_id_rm_test<span class="op">=</span>[]</span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(v_id_test)):</span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a>  y<span class="op">=</span><span class="bu">str</span>(v_id_test[x])</span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a>  v_id_rm_test.append(<span class="bu">int</span>(y[<span class="dv">7</span>:]))</span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a>new_v_test[<span class="st">&#39;ID&#39;</span>]<span class="op">=</span>v_id_rm_test</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="53" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="xk6lz1GVok5g" data-outputId="16852b35-0a89-4749-87a6-be4edf872434">
<div class="sourceCode" id="cb77"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Train data&quot;</span>)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>vehicle<span class="op">=</span>pd.DataFrame()</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>vehicle[<span class="st">&#39;CustomerID&#39;</span>]<span class="op">=</span>new_v[<span class="st">&#39;CustomerID&#39;</span>]</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>vehicle[<span class="st">&#39;VehicleModel&#39;</span>]<span class="op">=</span>new_v[<span class="st">&#39;Model&#39;</span>].astype(<span class="st">&#39;category&#39;</span>)</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>vehicle[<span class="st">&#39;VehicleMake&#39;</span>]<span class="op">=</span>new_v[<span class="st">&#39;Make&#39;</span>].astype(<span class="st">&#39;category&#39;</span>)</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>vehicle[<span class="st">&#39;VehicleYOM&#39;</span>]<span class="op">=</span>new_v[<span class="st">&#39;YOM&#39;</span>].astype(<span class="st">&#39;category&#39;</span>)</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>vehicle[<span class="st">&#39;VehicleID&#39;</span>]<span class="op">=</span>new_v[<span class="st">&#39;ID&#39;</span>].astype(<span class="st">&#39;int&#39;</span>)</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(vehicle.head())</span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st"> Test data&quot;</span>)</span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>vehicle_test<span class="op">=</span>pd.DataFrame()</span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>vehicle_test[<span class="st">&#39;CustomerID&#39;</span>]<span class="op">=</span>new_v_test[<span class="st">&#39;CustomerID&#39;</span>]</span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a>vehicle_test[<span class="st">&#39;VehicleModel&#39;</span>]<span class="op">=</span>new_v_test[<span class="st">&#39;Model&#39;</span>].astype(<span class="st">&#39;category&#39;</span>)</span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a>vehicle_test[<span class="st">&#39;VehicleMake&#39;</span>]<span class="op">=</span>new_v_test[<span class="st">&#39;Make&#39;</span>].astype(<span class="st">&#39;category&#39;</span>)</span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a>vehicle_test[<span class="st">&#39;VehicleYOM&#39;</span>]<span class="op">=</span>new_v_test[<span class="st">&#39;YOM&#39;</span>].astype(<span class="st">&#39;category&#39;</span>)</span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a>vehicle_test[<span class="st">&#39;VehicleID&#39;</span>]<span class="op">=</span>new_v_test[<span class="st">&#39;ID&#39;</span>].astype(<span class="st">&#39;int&#39;</span>)</span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(vehicle_test.head())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Train data
  CustomerID VehicleModel VehicleMake VehicleYOM  VehicleID
0  Cust20179    Forrestor         BMW       2011       8898
1  Cust21384       Malibu   Chevrolet       2010      18688
2  Cust33335   Highlander      Toyota       2001       8998
3  Cust27118         Neon        Saab       1998      28504
4  Cust13038       Maxima      Toyota       2000      30212

 Test data
  CustomerID    VehicleModel VehicleMake VehicleYOM  VehicleID
0  Cust28465             92x      Suburu       2001      36793
1  Cust20319           Jetta       Dodge       2006       7679
2   Cust3683           ML350        Audi       1997      22709
3  Cust29385  Grand Cherokee      Suburu       2003      20347
4  Cust34403           Camry      Toyota       2014      26765
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="54" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="Qjbzwhf1ok72" data-outputId="9af6d9af-e897-49e6-a55c-2a59d53867f3">
<div class="sourceCode" id="cb79"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(vehicle.shape)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(vehicle_test.shape)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>(28836, 5)
(8912, 5)
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="55" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="JJMKS9rIpAQj" data-outputId="4ed926bc-7c24-4496-ebd1-3f33a8e891ce">
<div class="sourceCode" id="cb81"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x <span class="kw">in</span> vehicle.drop(<span class="st">&#39;CustomerID&#39;</span>,axis<span class="op">=</span><span class="dv">1</span>).columns:</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(vehicle[x].value_counts())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>RAM               1344
Wrangler          1261
A3                1102
MDX               1054
Jetta             1037
Neon               928
Pathfinder         919
Passat             888
Legacy             887
92x                859
Malibu             828
95                 820
A5                 812
F150               797
Forrestor          784
Camry              771
Tahoe              736
93                 724
Maxima             722
Grand Cherokee     718
Escape             706
Ultima             698
E400               695
X5                 691
TL                 684
Silverado          668
Fusion             650
Highlander         633
Civic              604
ML350              599
Impreza            562
CRV                542
Corolla            530
M5                 509
C300               477
X6                 454
3 Series           436
RSX                397
Accord             310
Name: VehicleModel, dtype: int64
Saab          2415
Suburu        2313
Nissan        2300
Dodge         2263
Chevrolet     2174
Ford          2158
Accura        2099
BMW           2073
Toyota        1981
Volkswagen    1960
Audi          1952
Jeep          1946
Mercedes      1659
Honda         1493
???             50
Name: VehicleMake, dtype: int64
2007    1730
2004    1691
2010    1686
2006    1680
2009    1655
2008    1655
2005    1653
2003    1606
2011    1581
2002    1551
2000    1548
1999    1521
2001    1458
2012    1357
1998    1319
2013    1271
1997    1151
2014     889
1996     851
1995     555
2015     428
Name: VehicleYOM, dtype: int64
8898     1
7050     1
14973    1
37156    1
27123    1
        ..
27561    1
10861    1
7158     1
20462    1
25510    1
Name: VehicleID, Length: 28836, dtype: int64
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="56" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="bT4_fNkzpEBf" data-outputId="21664667-32fe-4353-cfc8-57bd01c2ad87">
<div class="sourceCode" id="cb83"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x <span class="kw">in</span> vehicle_test.drop(<span class="st">&#39;CustomerID&#39;</span>,axis<span class="op">=</span><span class="dv">1</span>).columns:</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(vehicle_test[x].value_counts())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Wrangler          507
RAM               400
Jetta             400
MDX               344
A3                339
Neon              329
Legacy            314
Malibu            298
Pathfinder        281
A5                277
Forrestor         270
92x               260
95                247
Passat            240
Camry             239
Ultima            237
93                233
F150              222
TL                221
Tahoe             219
Grand Cherokee    216
Highlander        206
Escape            206
Maxima            205
E400              195
Silverado         187
X5                186
Civic             185
Fusion            181
Impreza           165
3 Series          159
Corolla           155
CRV               153
ML350             148
M5                148
C300              139
X6                107
Accord             94
Name: VehicleModel, dtype: int64
Suburu        743
Nissan        741
Jeep          725
Chevrolet     718
Saab          714
Dodge         706
Volkswagen    627
Accura        626
Ford          612
BMW           595
Toyota        590
Audi          587
Mercedes      478
Honda         442
???             8
Name: VehicleMake, dtype: int64
2010    544
2007    533
2005    531
2006    526
2009    500
2004    499
2001    496
2003    495
2000    491
2008    486
2011    486
2002    485
1999    465
2012    417
1997    365
2013    361
1998    359
2014    293
1996    242
1995    192
2015    146
Name: VehicleYOM, dtype: int64
36793    1
15553    1
3802     1
31417    1
28138    1
        ..
34998    1
31799    1
13376    1
9381     1
5195     1
Name: VehicleID, Length: 8912, dtype: int64
</code></pre>
</div>
</div>
<div class="cell markdown" id="Id9x5YKBgt0e">
<p><strong>Insights</strong></p>
<p>VehicleMake has missing values in the form:'???'</p>
<p>VehicleModel in test data does not have RSX, which is present in train data</p>
</div>
<div class="cell markdown" id="zdTOYtBOOYyE">
<p><strong>Important Features</strong></p>
<p>VehicleMake,CustomerLoyaltyPeriod,Policy_CombinedSingleLimit,InsurancePolicyState, InsuredRelationship,InsuredEducationLevel,InsuredOccupation,InsuredHobbies,TypeOfIncident,TypeOfCollission,SeverityOfIncident,AuthoritiesContacted,IncidentState,IncidentAddress,NumberOfVehicles,BodilyInjuries,AmountOfTotalClaim, AmountOfInjuryClaim,AmountOfVehicleDamage.</p>
</div>
<div class="cell markdown" id="iRszfV_lhJy4">
<p><strong>Replacing the missing values with np.nan</strong></p>
<p>It would be easy to drop the np.nan values and proceed with Data Visualization as missing values affect the visualization process.</p>
<p>Also,imputing data before visualization is not preferred as it may manipulate the original data distribution.</p>
</div>
<div class="cell code" data-execution_count="57" id="hLI0B8FzbLeo">
<div class="sourceCode" id="cb85"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Missing Value Treatment</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>claim.TypeOfCollission.replace(<span class="st">&#39;?&#39;</span>,np.nan,inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>claim.IncidentTime.replace(<span class="op">-</span><span class="dv">5</span>,np.nan,inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>claim.PropertyDamage.replace(<span class="st">&#39;?&#39;</span>,np.nan,inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>claim.AmountOfTotalClaim.replace(<span class="st">&#39;MISSEDDATA&#39;</span>,np.nan,inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>claim.PoliceReport.replace(<span class="st">&#39;?&#39;</span>,np.nan,inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>claim.Witnesses.replace(<span class="st">&#39;MISSINGVALUE&#39;</span>,np.nan,inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>claim_test.TypeOfCollission.replace(<span class="st">&#39;?&#39;</span>,np.nan,inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>claim_test.IncidentTime.replace(<span class="op">-</span><span class="dv">5</span>,np.nan,inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a>claim_test.PropertyDamage.replace(<span class="st">&#39;?&#39;</span>,np.nan,inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a>claim_test.AmountOfTotalClaim.replace(<span class="st">&#39;MISSEDDATA&#39;</span>,np.nan,inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a>claim_test.PoliceReport.replace(<span class="st">&#39;?&#39;</span>,np.nan,inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a>claim_test.Witnesses.replace(<span class="st">&#39;MISSINGVALUE&#39;</span>,np.nan,inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb85-15"><a href="#cb85-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-16"><a href="#cb85-16" aria-hidden="true" tabindex="-1"></a>claim[<span class="st">&#39;AmountOfTotalClaim&#39;</span>]<span class="op">=</span>claim[<span class="st">&#39;AmountOfTotalClaim&#39;</span>].astype(<span class="st">&quot;float&quot;</span>)        </span>
<span id="cb85-17"><a href="#cb85-17" aria-hidden="true" tabindex="-1"></a>claim_test[<span class="st">&#39;AmountOfTotalClaim&#39;</span>]<span class="op">=</span>claim_test[<span class="st">&#39;AmountOfTotalClaim&#39;</span>].astype(<span class="st">&quot;float&quot;</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="58" id="pJDASJ7Yh8Tv">
<div class="sourceCode" id="cb86"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>demo.InsuredGender.replace(<span class="st">&#39;NA&#39;</span>,np.nan,inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>demo_test.InsuredGender.replace(<span class="st">&#39;NA&#39;</span>,np.nan,inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>demo.Country.replace(<span class="st">&#39;NA&#39;</span>,np.nan,inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>demo_test.Country.replace(<span class="st">&#39;NA&#39;</span>,np.nan,inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a><span class="co">#the int and cat columns are predefined yet once again to avoid any confusions</span></span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>cat_cols<span class="op">=</span>demo.select_dtypes(include<span class="op">=</span><span class="st">&#39;object&#39;</span>).columns</span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>demo[cat_cols]<span class="op">=</span>demo[cat_cols].astype(<span class="st">&#39;category&#39;</span>)</span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>demo_test[cat_cols]<span class="op">=</span>demo_test[cat_cols].astype(<span class="st">&#39;category&#39;</span>)</span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a>num_cols<span class="op">=</span>demo.drop(<span class="st">&#39;CustomerID&#39;</span>,axis<span class="op">=</span><span class="dv">1</span>).select_dtypes(exclude<span class="op">=</span><span class="st">&#39;category&#39;</span>).columns</span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a>demo[num_cols]<span class="op">=</span>demo[num_cols].astype(<span class="st">&#39;int&#39;</span>)</span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a>demo_test[num_cols]<span class="op">=</span>demo_test[num_cols].astype(<span class="st">&#39;int&#39;</span>)</span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-15"><a href="#cb86-15" aria-hidden="true" tabindex="-1"></a><span class="co">#to replace missing values in VehicleMake with np.nan</span></span>
<span id="cb86-16"><a href="#cb86-16" aria-hidden="true" tabindex="-1"></a>vehicle.VehicleMake.replace(<span class="st">&#39;???&#39;</span>,np.nan,inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb86-17"><a href="#cb86-17" aria-hidden="true" tabindex="-1"></a>vehicle_test.VehicleMake.replace(<span class="st">&#39;???&#39;</span>,np.nan,inplace<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
</div>
<div class="cell markdown" id="9EcWs3UbhfB7">
<p><strong>Merging the multiple sets to obtain a single dataset</strong></p>
<p>Performed with the help of merge() and by considering CustomerID as the common column among all the individual datasets</p>
</div>
<div class="cell code" data-execution_count="59" id="dJetM7blhpaS">
<div class="sourceCode" id="cb87"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Train dataset</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>data<span class="op">=</span>pd.DataFrame()</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>data<span class="op">=</span>vehicle</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>data<span class="op">=</span>data.merge(right<span class="op">=</span>policy,on<span class="op">=</span><span class="st">&#39;CustomerID&#39;</span>,how<span class="op">=</span><span class="st">&#39;inner&#39;</span>)</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>data<span class="op">=</span>data.merge(right<span class="op">=</span>demo,on<span class="op">=</span><span class="st">&#39;CustomerID&#39;</span>,how<span class="op">=</span><span class="st">&#39;inner&#39;</span>)</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>data<span class="op">=</span>data.merge(right<span class="op">=</span>claim,on<span class="op">=</span><span class="st">&#39;CustomerID&#39;</span>,how<span class="op">=</span><span class="st">&#39;inner&#39;</span>)</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>data<span class="op">=</span>data.merge(right<span class="op">=</span>with_target,on<span class="op">=</span><span class="st">&#39;CustomerID&#39;</span>,how<span class="op">=</span><span class="st">&#39;inner&#39;</span>)</span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>dataset<span class="op">=</span>data.dropna()</span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a><span class="co">#############################################################################</span></span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a><span class="co">#Test dataset</span></span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>data_test<span class="op">=</span>pd.DataFrame()</span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>data_test<span class="op">=</span>vehicle_test</span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a>data_test<span class="op">=</span>data_test.merge(right<span class="op">=</span>policy_test,on<span class="op">=</span><span class="st">&#39;CustomerID&#39;</span>,how<span class="op">=</span><span class="st">&#39;inner&#39;</span>)</span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a>data_test<span class="op">=</span>data_test.merge(right<span class="op">=</span>demo_test,on<span class="op">=</span><span class="st">&#39;CustomerID&#39;</span>,how<span class="op">=</span><span class="st">&#39;inner&#39;</span>)</span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a>data_test<span class="op">=</span>data_test.merge(right<span class="op">=</span>claim_test,on<span class="op">=</span><span class="st">&#39;CustomerID&#39;</span>,how<span class="op">=</span><span class="st">&#39;inner&#39;</span>)</span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a>data_test<span class="op">=</span>data_test.merge(right<span class="op">=</span>without_target,on<span class="op">=</span><span class="st">&#39;CustomerID&#39;</span>,how<span class="op">=</span><span class="st">&#39;inner&#39;</span>)</span>
<span id="cb87-17"><a href="#cb87-17" aria-hidden="true" tabindex="-1"></a>dataset_test<span class="op">=</span>data_test.dropna()</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="60" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="X2tEKG7z9KGc" data-outputId="20862656-b47b-410b-844a-f3023c795561">
<div class="sourceCode" id="cb88"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>dataset.columns</span></code></pre></div>
<div class="output execute_result" data-execution_count="60">
<pre><code>Index([&#39;CustomerID&#39;, &#39;VehicleModel&#39;, &#39;VehicleMake&#39;, &#39;VehicleYOM&#39;, &#39;VehicleID&#39;,
       &#39;InsurancePolicyNumber&#39;, &#39;CustomerLoyaltyPeriod&#39;,
       &#39;DateOfPolicyCoverage&#39;, &#39;InsurancePolicyState&#39;,
       &#39;Policy_CombinedSingleLimit&#39;, &#39;Policy_Deductible&#39;,
       &#39;PolicyAnnualPremium&#39;, &#39;UmbrellaLimit&#39;, &#39;InsuredRelationship&#39;,
       &#39;InsuredAge&#39;, &#39;InsuredZipCode&#39;, &#39;InsuredGender&#39;,
       &#39;InsuredEducationLevel&#39;, &#39;InsuredOccupation&#39;, &#39;InsuredHobbies&#39;,
       &#39;CapitalGains&#39;, &#39;CapitalLoss&#39;, &#39;Country&#39;, &#39;DateOfIncident&#39;,
       &#39;TypeOfIncident&#39;, &#39;TypeOfCollission&#39;, &#39;SeverityOfIncident&#39;,
       &#39;AuthoritiesContacted&#39;, &#39;IncidentState&#39;, &#39;IncidentCity&#39;,
       &#39;IncidentAddress&#39;, &#39;IncidentTime&#39;, &#39;NumberOfVehicles&#39;, &#39;PropertyDamage&#39;,
       &#39;BodilyInjuries&#39;, &#39;Witnesses&#39;, &#39;PoliceReport&#39;, &#39;AmountOfTotalClaim&#39;,
       &#39;AmountOfInjuryClaim&#39;, &#39;AmountOfPropertyClaim&#39;, &#39;AmountOfVehicleDamage&#39;,
       &#39;ReportedFraud&#39;],
      dtype=&#39;object&#39;)</code></pre>
</div>
</div>
<section id="data-visualization" class="cell markdown" id="BKwHmbkvh8F7">
<h1>Data Visualization</h1>
</section>
<div class="cell markdown" id="rSpqGFpqsdMo">
<p>In order to understand the data we will have to look into these claims and understand their distribution and the features influencing them with the help of Data Analysis.</p>
</div>
<div class="cell code" data-execution_count="61" data-colab="{&quot;height&quot;:1000,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="iHXdZETigjic" data-outputId="bec391dd-a572-40e5-948e-7fba5e5d1322">
<div class="sourceCode" id="cb90"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>sns.pairplot(dataset.drop([<span class="st">&#39;VehicleID&#39;</span>,<span class="st">&#39;InsurancePolicyNumber&#39;</span>,<span class="st">&#39;InsuredZipCode&#39;</span>],axis<span class="op">=</span><span class="dv">1</span>))</span></code></pre></div>
<div class="output execute_result" data-execution_count="61">
<pre><code>&lt;seaborn.axisgrid.PairGrid at 0x7fc99e9cf390&gt;</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_307199db045148b8a4807fd051a00805/4e9a1003e4b48a2221125dce35661a0f36f3d308.png" /></p>
</div>
</div>
<div class="cell markdown" id="70fE369qEnYY">
<p><strong>Pair Plot</strong></p>
<p>1.The features Customer Loyalty period and Insured Age are highly correlated</p>
<p>2.The features Amount Of total claim,Amount of injury claim,Amount of property claim and Amount of vehicle damage are correlated.</p>
</div>
<div class="cell code" data-execution_count="62" data-colab="{&quot;height&quot;:497,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="jMUGxoRANtDW" data-outputId="5712973b-8b1f-44ad-824c-61e4bae6c95d">
<div class="sourceCode" id="cb92"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>,<span class="dv">6</span>))</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>ax<span class="op">=</span>sns.heatmap(dataset.corr(),annot<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_307199db045148b8a4807fd051a00805/0946328bc6816faf3747a2760ba6d2b2b65b5905.png" /></p>
</div>
</div>
<div class="cell markdown" id="HEN2bqIBOL8D">
<p><strong>Plot1:Correlation Map to find the strength of correlation between features</strong></p>
<p>1.Insured Age and Customer Loyalty Period are highly correlated</p>
<p>2.The total claim amount,Injury claim,property claim and Vehicle damage claims are all correlated.</p>
</div>
<div class="cell code" data-execution_count="63" data-colab="{&quot;height&quot;:404,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="DrMc3trs7C9P" data-outputId="9ac07315-540e-4654-d6fe-b6679266241a">
<div class="sourceCode" id="cb93"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>vehicle_claim<span class="op">=</span><span class="bu">sum</span>(dataset[<span class="st">&#39;AmountOfVehicleDamage&#39;</span>].dropna())</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>property_claim<span class="op">=</span><span class="bu">sum</span>(dataset[<span class="st">&#39;AmountOfPropertyClaim&#39;</span>].dropna())</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>injury_claim<span class="op">=</span><span class="bu">sum</span>(dataset[<span class="st">&#39;AmountOfInjuryClaim&#39;</span>].dropna())</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>values<span class="op">=</span>[vehicle_claim,property_claim,injury_claim]</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>labels<span class="op">=</span>[<span class="st">&#39;Vehicle Claim&#39;</span>,<span class="st">&#39;Property Claim&#39;</span>,<span class="st">&#39;Injury Claim&#39;</span>]</span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>palette_color <span class="op">=</span> sns.color_palette(<span class="st">&#39;bright&#39;</span>)</span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>plt.pie(x<span class="op">=</span>values, labels<span class="op">=</span>labels, colors<span class="op">=</span>palette_color,autopct<span class="op">=</span><span class="st">&quot;</span><span class="sc">%.3f</span><span class="st">&quot;</span>)</span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a><span class="co">#majority of claims are in vehicle claim</span></span></code></pre></div>
<div class="output execute_result" data-execution_count="63">
<pre><code>([&lt;matplotlib.patches.Wedge at 0x7fc6cad4ff90&gt;,
  &lt;matplotlib.patches.Wedge at 0x7fc6cad586d0&gt;,
  &lt;matplotlib.patches.Wedge at 0x7fc6cad58f50&gt;],
 [Text(-0.7030053634744902, 0.8460398684022523, &#39;Vehicle Claim&#39;),
  Text(0.27245948716148244, -1.0657231478464293, &#39;Property Claim&#39;),
  Text(0.9938044308828546, -0.47154294943048997, &#39;Injury Claim&#39;)],
 [Text(-0.3834574709860855, 0.4614762918557739, &#39;72.069&#39;),
  Text(0.14861426572444494, -0.5813035351889614, &#39;13.829&#39;),
  Text(0.5420751441179207, -0.2572052451439036, &#39;14.102&#39;)])</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_307199db045148b8a4807fd051a00805/9a3f53dc15e56cb538104fc7584fc29a35637f1c.png" /></p>
</div>
</div>
<div class="cell markdown" id="WajnDIcTvymg">
<p><strong>Plot2:Total Claim Distribution</strong></p>
<p>Division of Total claim amount paid by Insurance company into Vehicle,Property and Injury claims.</p>
<p>Amount claimed for Vehicle is 72.069% of the total claimed amount</p>
</div>
<div class="cell code" data-execution_count="64" data-colab="{&quot;height&quot;:389,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="gMoENvHpwm13" data-outputId="849a0a12-7cb1-4ea1-c7c2-fcd578cd13e1">
<div class="sourceCode" id="cb95"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>relation<span class="op">=</span>dataset.InsuredRelationship.unique().to_list()</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>values<span class="op">=</span>[]</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> relation:</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>  values.append(np.count_nonzero(dataset[<span class="st">&#39;AmountOfTotalClaim&#39;</span>][dataset[<span class="st">&#39;InsuredRelationship&#39;</span>]<span class="op">==</span>i]))</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>values<span class="op">=</span>values</span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>labels<span class="op">=</span>[<span class="st">&#39;husband&#39;</span>,<span class="st">&#39;not-in-family&#39;</span>,<span class="st">&#39;other-relative&#39;</span>,<span class="st">&#39;own-child&#39;</span>,<span class="st">&#39;unmarried&#39;</span>,<span class="st">&#39;wife&#39;</span>]</span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>palette_color <span class="op">=</span> sns.color_palette(<span class="st">&#39;bright&#39;</span>)</span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>)</span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>plt.pie(x<span class="op">=</span>values, labels<span class="op">=</span>labels, colors<span class="op">=</span>palette_color,autopct<span class="op">=</span><span class="st">&#39;</span><span class="sc">%.3f</span><span class="st">&#39;</span>)</span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Plot3:Claims </span><span class="ch">\n</span><span class="st">&#39;</span>)</span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a>fraud<span class="op">=</span>dataset[[<span class="st">&#39;AmountOfTotalClaim&#39;</span>,<span class="st">&#39;InsuredRelationship&#39;</span>]][dataset[<span class="st">&#39;ReportedFraud&#39;</span>]<span class="op">==</span><span class="st">&#39;Y&#39;</span>]</span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a>values_fraud<span class="op">=</span>[]</span>
<span id="cb95-16"><a href="#cb95-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> relation:</span>
<span id="cb95-17"><a href="#cb95-17" aria-hidden="true" tabindex="-1"></a>  values_fraud.append(np.count_nonzero(fraud[<span class="st">&#39;AmountOfTotalClaim&#39;</span>][fraud[<span class="st">&#39;InsuredRelationship&#39;</span>]<span class="op">==</span>i]))</span>
<span id="cb95-18"><a href="#cb95-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-19"><a href="#cb95-19" aria-hidden="true" tabindex="-1"></a>values<span class="op">=</span>values_fraud</span>
<span id="cb95-20"><a href="#cb95-20" aria-hidden="true" tabindex="-1"></a>labels<span class="op">=</span>[<span class="st">&#39;husband&#39;</span>,<span class="st">&#39;not-in-family&#39;</span>,<span class="st">&#39;other-relative&#39;</span>,<span class="st">&#39;own-child&#39;</span>,<span class="st">&#39;unmarried&#39;</span>,<span class="st">&#39;wife&#39;</span>]</span>
<span id="cb95-21"><a href="#cb95-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-22"><a href="#cb95-22" aria-hidden="true" tabindex="-1"></a>palette_color <span class="op">=</span> sns.color_palette(<span class="st">&#39;bright&#39;</span>)</span>
<span id="cb95-23"><a href="#cb95-23" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb95-24"><a href="#cb95-24" aria-hidden="true" tabindex="-1"></a>plt.pie(x<span class="op">=</span>values, labels<span class="op">=</span>labels, colors<span class="op">=</span>palette_color,autopct<span class="op">=</span><span class="st">&#39;</span><span class="sc">%.3f</span><span class="st">&#39;</span>)</span>
<span id="cb95-25"><a href="#cb95-25" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Plot4:Fraud Claims&#39;</span>)</span>
<span id="cb95-26"><a href="#cb95-26" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_307199db045148b8a4807fd051a00805/180c6147aa2b52e3c5a5e8f19f8084f9d7271153.png" /></p>
</div>
<div class="output display_data">
<p><img src="vertopal_307199db045148b8a4807fd051a00805/5293631d98205212fa8ae7b816f2b720e060ce1b.png" /></p>
</div>
</div>
<div class="cell markdown" id="Jh3I-jwG8EZZ">
<p><strong>Plot3 &amp; 4:Frequency distribution of Total Claim Amount w.r.t Insured Relationship</strong></p>
<p>Above plot shows that majority of the claims were in the name of not-in-family and other-relative both in case of total claims and fraud claims.</p>
</div>
<div class="cell code" data-execution_count="65" data-colab="{&quot;height&quot;:811,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="D-ALtJ_fB51o" data-outputId="3e7f74f1-3d97-442f-83c8-a67bcc0b859b">
<div class="sourceCode" id="cb96"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>states<span class="op">=</span>dataset.IncidentState.unique().to_list()</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="co">#to calculate statewise claim ratio</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>values<span class="op">=</span>[]</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states)):</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>  values.append((np.count_nonzero(dataset[<span class="st">&#39;ReportedFraud&#39;</span>][dataset[<span class="st">&#39;IncidentState&#39;</span>]<span class="op">==</span>states[i]]))<span class="op">/</span>(dataset.shape[<span class="dv">0</span>]))</span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>,<span class="dv">6</span>))</span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>ax<span class="op">=</span>sns.barplot(x<span class="op">=</span>states,y<span class="op">=</span>values)</span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Incident States&#39;</span>)</span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Statewise reports/Total reports&#39;</span>)</span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Plot5:Statewise ratio of claims</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a><span class="co">#to calculate fraudulent claim ratio statewise#multivariate</span></span>
<span id="cb96-14"><a href="#cb96-14" aria-hidden="true" tabindex="-1"></a>values_ratio<span class="op">=</span>[]</span>
<span id="cb96-15"><a href="#cb96-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> states:</span>
<span id="cb96-16"><a href="#cb96-16" aria-hidden="true" tabindex="-1"></a>  values_ratio.append(np.count_nonzero(dataset[<span class="st">&#39;ReportedFraud&#39;</span>][dataset[<span class="st">&#39;IncidentState&#39;</span>]<span class="op">==</span>i]<span class="op">==</span><span class="st">&#39;Y&#39;</span>)<span class="op">/</span>(np.count_nonzero(dataset[<span class="st">&#39;ReportedFraud&#39;</span>][dataset[<span class="st">&#39;IncidentState&#39;</span>]<span class="op">==</span>i])))</span>
<span id="cb96-17"><a href="#cb96-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-18"><a href="#cb96-18" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>,<span class="dv">6</span>))</span>
<span id="cb96-19"><a href="#cb96-19" aria-hidden="true" tabindex="-1"></a>ax<span class="op">=</span>sns.barplot(x<span class="op">=</span>states,y<span class="op">=</span>values_ratio)</span>
<span id="cb96-20"><a href="#cb96-20" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Incident States&#39;</span>)</span>
<span id="cb96-21"><a href="#cb96-21" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Statewise Fraud claims/Total Reports in State&#39;</span>)</span>
<span id="cb96-22"><a href="#cb96-22" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb96-23"><a href="#cb96-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Plot6:Statewise ratio of Fraudulent claims&#39;</span>)</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_307199db045148b8a4807fd051a00805/bdc5c7ccb1df7cc60d4c6d1d439a45a500c8d2e9.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>Plot5:Statewise ratio of claims

</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_307199db045148b8a4807fd051a00805/7aa45dc0f181212bd72617a0d9cf3b485bb86c50.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>Plot6:Statewise ratio of Fraudulent claims
</code></pre>
</div>
</div>
<div class="cell markdown" id="yNDPaTFVOvqX">
<p><strong>Plot5:Incident statewise representation of Frauds</strong></p>
<p>State 5 followed by State 7 have the highest ratio of reports among the total reports.</p>
<p><strong>Plot6:Incident statewise fraud claim reports</strong></p>
<p>State3 followed by state 4 have the highest ratio of fraud claim reports to the total reports within the state</p>
</div>
<div class="cell code" data-execution_count="66" data-colab="{&quot;height&quot;:719,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="-qQoW-c1oUqG" data-outputId="a9e2c04d-8090-4814-cf90-64bcb951fcef">
<div class="sourceCode" id="cb99"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>claim<span class="op">=</span>dataset[[<span class="st">&#39;SeverityOfIncident&#39;</span>,<span class="st">&#39;AmountOfTotalClaim&#39;</span>]]</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>damages<span class="op">=</span>claim[<span class="st">&#39;SeverityOfIncident&#39;</span>].unique().to_list()</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>sns.countplot(x<span class="op">=</span><span class="st">&#39;SeverityOfIncident&#39;</span>,data<span class="op">=</span>claim)</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Plot7:Count of different Severity of Incidents under total claims&quot;</span>)</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>values<span class="op">=</span>[]</span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> damages:</span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>  values.append(np.<span class="bu">sum</span>(claim[<span class="st">&#39;AmountOfTotalClaim&#39;</span>][claim[<span class="st">&#39;SeverityOfIncident&#39;</span>]<span class="op">==</span>i]))</span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st"> The Amount of Claim under each the incidents&quot;</span>)</span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Total Claim Amount under Major Damage:&quot;</span>,values[<span class="dv">0</span>])</span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Total Claim Amount under Minor Damage:&quot;</span>,values[<span class="dv">1</span>])</span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Total Claim Amount under Trivial Damage:&quot;</span>,values[<span class="dv">3</span>])</span>
<span id="cb99-15"><a href="#cb99-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Total Claim Amount under Total Loss:&quot;</span>,values[<span class="dv">2</span>])</span>
<span id="cb99-16"><a href="#cb99-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb99-17"><a href="#cb99-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-18"><a href="#cb99-18" aria-hidden="true" tabindex="-1"></a>fraud<span class="op">=</span>dataset[[<span class="st">&#39;SeverityOfIncident&#39;</span>,<span class="st">&#39;AmountOfTotalClaim&#39;</span>]][dataset[<span class="st">&#39;ReportedFraud&#39;</span>]<span class="op">==</span><span class="st">&#39;Y&#39;</span>]</span>
<span id="cb99-19"><a href="#cb99-19" aria-hidden="true" tabindex="-1"></a>values<span class="op">=</span>[]</span>
<span id="cb99-20"><a href="#cb99-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> damages:</span>
<span id="cb99-21"><a href="#cb99-21" aria-hidden="true" tabindex="-1"></a>  values.append((<span class="bu">sum</span>(fraud[<span class="st">&#39;AmountOfTotalClaim&#39;</span>][fraud[<span class="st">&#39;SeverityOfIncident&#39;</span>]<span class="op">==</span>i]))<span class="op">/</span>(np.<span class="bu">sum</span>(claim[<span class="st">&#39;AmountOfTotalClaim&#39;</span>][claim[<span class="st">&#39;SeverityOfIncident&#39;</span>]<span class="op">==</span>i])))</span>
<span id="cb99-22"><a href="#cb99-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-23"><a href="#cb99-23" aria-hidden="true" tabindex="-1"></a>sns.barplot(x<span class="op">=</span>damages,y<span class="op">=</span>values)</span>
<span id="cb99-24"><a href="#cb99-24" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Severity Of Incident&#39;</span>)</span>
<span id="cb99-25"><a href="#cb99-25" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Fraudulent claim Amount/Total claim amount&#39;</span>)</span>
<span id="cb99-26"><a href="#cb99-26" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb99-27"><a href="#cb99-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Plot8:Severity wise Fraudulent claim Amount/Total claim amount&quot;</span>)</span>
<span id="cb99-28"><a href="#cb99-28" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_307199db045148b8a4807fd051a00805/258d29b867efce16044946b513646751d40a0932.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>Plot7:Count of different Severity of Incidents under total claims

 The Amount of Claim under each the incidents
Total Claim Amount under Major Damage: 209525973.0
Total Claim Amount under Minor Damage: 181703375.0
Total Claim Amount under Trivial Damage: 550329.0
Total Claim Amount under Total Loss: 212459599.0


</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_307199db045148b8a4807fd051a00805/5e67574ce70680dbff384f09b13a403ed5bd7cff.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>Plot8:Severity wise Fraudulent claim Amount/Total claim amount
</code></pre>
</div>
</div>
<div class="cell markdown" id="rlryQ1aJ1wZA">
<p><strong>Plot7:Visualisation of number of claims according to the Severity Of the Incident</strong></p>
<p>1.Number of claims under Minor and Major damage are the highest.</p>
<p>2.Amount claimed under Total Loss followed by Major damage are the highest.</p>
<p><strong>Plot8:Severity wise Fraudulent claim Amount/Total claim amount</strong></p>
<p>Frauds under the Major Damage are the highest.</p>
</div>
<div class="cell code" data-execution_count="67" data-colab="{&quot;height&quot;:374,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="7B8XRAf15iWA" data-outputId="18b64deb-8a3f-48a8-8b0c-3f0dce42d013">
<div class="sourceCode" id="cb102"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>limit<span class="op">=</span>dataset[[<span class="st">&#39;Policy_CombinedSingleLimit&#39;</span>,<span class="st">&#39;InsuredAge&#39;</span>]]</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>policy<span class="op">=</span>limit[<span class="st">&#39;Policy_CombinedSingleLimit&#39;</span>].unique().to_list()</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>sns.catplot(y<span class="op">=</span><span class="st">&#39;Policy_CombinedSingleLimit&#39;</span>,kind<span class="op">=</span><span class="st">&#39;violin&#39;</span>,x<span class="op">=</span><span class="st">&#39;InsuredAge&#39;</span>,data<span class="op">=</span>limit)</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">30</span>)</span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_307199db045148b8a4807fd051a00805/72a19b4794d015009d1627dc8f0df51f5363631f.png" /></p>
</div>
</div>
<div class="cell markdown" id="FsOdlTtVluY0">
<p><strong>Plot9:Type of Policy and the respective Age group of Insured people</strong></p>
<p>1.The horizontal lines represent the Type of Policy owned by the age group of Customers</p>
<p>2.The thickness of the violin plots resemble the density of Insured people in the age group.</p>
<p><strong>Reason</strong></p>
<p>To identify the type of policies owned by different age group of people</p>
</div>
<div class="cell code" data-execution_count="68" data-colab="{&quot;height&quot;:457,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="GOw1dreFjbG5" data-outputId="cadcb220-86e6-4502-a4f1-547837540f23">
<div class="sourceCode" id="cb103"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>fraud<span class="op">=</span>dataset[[<span class="st">&#39;TypeOfIncident&#39;</span>,<span class="st">&#39;AmountOfTotalClaim&#39;</span>]][dataset[<span class="st">&#39;ReportedFraud&#39;</span>]<span class="op">==</span><span class="st">&#39;Y&#39;</span>]</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>,<span class="dv">6</span>))</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>sns.countplot(x<span class="op">=</span><span class="st">&#39;TypeOfIncident&#39;</span>,data<span class="op">=</span>fraud)</span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a>incident<span class="op">=</span>fraud[<span class="st">&#39;TypeOfIncident&#39;</span>].unique().to_list()</span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> incident:</span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="st">&quot;The Amount of total fraud claim in&quot;</span>,i,<span class="bu">sum</span>(fraud[<span class="st">&#39;AmountOfTotalClaim&#39;</span>][fraud[<span class="st">&#39;TypeOfIncident&#39;</span>]<span class="op">==</span>i]))</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_307199db045148b8a4807fd051a00805/d4217f3fb3bacd607acc14c5635bd116de235461.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>The Amount of total fraud claim in Single Vehicle Collision 98881243.0
The Amount of total fraud claim in Multi-vehicle Collision 74569402.0
The Amount of total fraud claim in Vehicle Theft 39736.0
The Amount of total fraud claim in Parked Car 53044.0
</code></pre>
</div>
</div>
<div class="cell markdown" id="A50F9Fc8F8l7">
<p><strong>Plot10:Peek into the Claims as per the Type Of Incident</strong></p>
<p>1.The plot shows that:count(Single Vehicle Collission claims) &gt;&gt; count(Multi Vehicle Collission claims)</p>
<p>2.The total amount under (Single Vehicle Collission claims) &gt;&gt; (Multi Vehicle Collission claims)</p>
</div>
<div class="cell code" data-execution_count="69" data-colab="{&quot;height&quot;:399,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="p0m16q0gIe4f" data-outputId="07d2fd7d-f9cd-4805-9d9e-f4f35e65a640">
<div class="sourceCode" id="cb105"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>fraud<span class="op">=</span>dataset[[<span class="st">&#39;InsuredEducationLevel&#39;</span>,<span class="st">&#39;AmountOfPropertyClaim&#39;</span>,<span class="st">&#39;PropertyDamage&#39;</span>]][dataset[<span class="st">&#39;ReportedFraud&#39;</span>]<span class="op">==</span><span class="st">&#39;Y&#39;</span>]</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>fraud<span class="op">=</span>fraud[[<span class="st">&#39;InsuredEducationLevel&#39;</span>,<span class="st">&#39;AmountOfPropertyClaim&#39;</span>]]</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>degree<span class="op">=</span>fraud[<span class="st">&#39;InsuredEducationLevel&#39;</span>].unique().to_list()</span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>values<span class="op">=</span>[]</span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> degree:</span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>  values.append(<span class="bu">sum</span>(fraud[<span class="st">&#39;AmountOfPropertyClaim&#39;</span>][fraud[<span class="st">&#39;InsuredEducationLevel&#39;</span>]<span class="op">==</span>i]))</span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>,<span class="dv">6</span>))</span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a>ax<span class="op">=</span>sns.lineplot(x<span class="op">=</span>degree,y<span class="op">=</span>values)</span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Insured Education Level&#39;</span>)</span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Total Amount Of Property Claims&#39;</span>)</span>
<span id="cb105-13"><a href="#cb105-13" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_307199db045148b8a4807fd051a00805/fadc5c2267940bbc13da000d6bbe8d73358dbbb3.png" /></p>
</div>
</div>
<div class="cell markdown" id="soTsig_nLHbp">
<p><strong>Plot11:Insured Education level vs The amount of Fake Property claims</strong></p>
<p>Customers with MD and Masters degree have claimed most amount in fraud Property claims</p>
</div>
<div class="cell code" data-execution_count="70" data-colab="{&quot;height&quot;:975,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="fFcKqzw2UF8S" data-outputId="775c3fbb-8138-4a03-968d-ccdfa78da0cd">
<div class="sourceCode" id="cb106"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co">#multi</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>fraud<span class="op">=</span>dataset[[<span class="st">&#39;AmountOfTotalClaim&#39;</span>,<span class="st">&#39;InsuredOccupation&#39;</span>,<span class="st">&#39;InsuredGender&#39;</span>]][dataset[<span class="st">&#39;ReportedFraud&#39;</span>]<span class="op">==</span><span class="st">&#39;Y&#39;</span>]</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>roles<span class="op">=</span>fraud[<span class="st">&#39;InsuredOccupation&#39;</span>].unique().to_list()</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>men<span class="op">=</span>fraud[[<span class="st">&#39;AmountOfTotalClaim&#39;</span>,<span class="st">&#39;InsuredOccupation&#39;</span>]][fraud[<span class="st">&#39;InsuredGender&#39;</span>]<span class="op">==</span><span class="st">&#39;MALE&#39;</span>]</span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>women<span class="op">=</span>fraud[[<span class="st">&#39;AmountOfTotalClaim&#39;</span>,<span class="st">&#39;InsuredOccupation&#39;</span>]][fraud[<span class="st">&#39;InsuredGender&#39;</span>]<span class="op">==</span><span class="st">&#39;FEMALE&#39;</span>]</span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>values<span class="op">=</span>[]</span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a>male_values<span class="op">=</span>[]</span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a>female_values<span class="op">=</span>[]</span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> roles:</span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a>  values.append(np.<span class="bu">sum</span>(fraud[<span class="st">&#39;AmountOfTotalClaim&#39;</span>][fraud[<span class="st">&#39;InsuredOccupation&#39;</span>]<span class="op">==</span>i]))</span>
<span id="cb106-12"><a href="#cb106-12" aria-hidden="true" tabindex="-1"></a>  male_values.append(np.<span class="bu">sum</span>(men[<span class="st">&#39;AmountOfTotalClaim&#39;</span>][men[<span class="st">&#39;InsuredOccupation&#39;</span>]<span class="op">==</span>i]))</span>
<span id="cb106-13"><a href="#cb106-13" aria-hidden="true" tabindex="-1"></a>  female_values.append(np.<span class="bu">sum</span>(women[<span class="st">&#39;AmountOfTotalClaim&#39;</span>][women[<span class="st">&#39;InsuredOccupation&#39;</span>]<span class="op">==</span>i]))</span>
<span id="cb106-14"><a href="#cb106-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-15"><a href="#cb106-15" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>,<span class="dv">6</span>))</span>
<span id="cb106-16"><a href="#cb106-16" aria-hidden="true" tabindex="-1"></a>ax<span class="op">=</span>sns.barplot(x<span class="op">=</span>roles,y<span class="op">=</span>values)</span>
<span id="cb106-17"><a href="#cb106-17" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">30</span>)</span>
<span id="cb106-18"><a href="#cb106-18" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Insured Occupations&#39;</span>)</span>
<span id="cb106-19"><a href="#cb106-19" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Number of Fraud Reports&#39;</span>)</span>
<span id="cb106-20"><a href="#cb106-20" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb106-21"><a href="#cb106-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;                                              Plot8</span><span class="ch">\n</span><span class="st">&#39;</span>)</span>
<span id="cb106-22"><a href="#cb106-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-23"><a href="#cb106-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-24"><a href="#cb106-24" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>,<span class="dv">6</span>))</span>
<span id="cb106-25"><a href="#cb106-25" aria-hidden="true" tabindex="-1"></a>line1,<span class="op">=</span>plt.plot(roles,male_values)</span>
<span id="cb106-26"><a href="#cb106-26" aria-hidden="true" tabindex="-1"></a>line2,<span class="op">=</span>plt.plot(roles,female_values)</span>
<span id="cb106-27"><a href="#cb106-27" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Insured Occupation&#39;</span>)</span>
<span id="cb106-28"><a href="#cb106-28" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Fraud Amount&#39;</span>)</span>
<span id="cb106-29"><a href="#cb106-29" aria-hidden="true" tabindex="-1"></a>plt.legend([line1,line2],[<span class="st">&#39;Male&#39;</span>,<span class="st">&#39;Female&#39;</span>])</span>
<span id="cb106-30"><a href="#cb106-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-31"><a href="#cb106-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-32"><a href="#cb106-32" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">30</span>)</span>
<span id="cb106-33"><a href="#cb106-33" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb106-34"><a href="#cb106-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;                                              Plot9</span><span class="ch">\n</span><span class="st">&#39;</span>)</span>
<span id="cb106-35"><a href="#cb106-35" aria-hidden="true" tabindex="-1"></a>male<span class="op">=</span>np.<span class="bu">sum</span>(fraud[<span class="st">&#39;AmountOfTotalClaim&#39;</span>][fraud[<span class="st">&#39;InsuredGender&#39;</span>]<span class="op">==</span><span class="st">&#39;MALE&#39;</span>])</span>
<span id="cb106-36"><a href="#cb106-36" aria-hidden="true" tabindex="-1"></a>female<span class="op">=</span>np.<span class="bu">sum</span>(fraud[<span class="st">&#39;AmountOfTotalClaim&#39;</span>][fraud[<span class="st">&#39;InsuredGender&#39;</span>]<span class="op">==</span><span class="st">&#39;FEMALE&#39;</span>])</span>
<span id="cb106-37"><a href="#cb106-37" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;The Sum of Fraud claim amount by Male:&quot;</span>,male)</span>
<span id="cb106-38"><a href="#cb106-38" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;The Sum of Fraud claim amount by Female:&quot;</span>,female)</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_307199db045148b8a4807fd051a00805/6820c35634dbaab29d13da442bd1f3f60155b8f4.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>                                              Plot8

</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_307199db045148b8a4807fd051a00805/277d08aa2eb5483e89dccf92ed2270c1212838a8.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>                                              Plot9

The Sum of Fraud claim amount by Male: 85706801.0
The Sum of Fraud claim amount by Female: 87836624.0
</code></pre>
</div>
</div>
<div class="cell markdown" id="lcsx1WCc8wGX">
<p><strong>Plot12:Fraud Reports vs Insured Occupations</strong></p>
<p>Those working under Sales and Tech-support have the highest fraud reports.</p>
<p><strong>Plot13:Sum Of Fraud Amount vs Insured Occupations vs Insured Gender</strong></p>
<p>Sum of fraud amounts claimed by female customers is more than that claimed by men.</p>
</div>
<div class="cell code" data-execution_count="71" data-colab="{&quot;height&quot;:404,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="O4dumvuoHa_D" data-outputId="b2548dad-6c70-4fec-cc14-15f2b634988d">
<div class="sourceCode" id="cb109"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>sns.catplot(x<span class="op">=</span><span class="st">&#39;PropertyDamage&#39;</span>,y<span class="op">=</span><span class="st">&#39;AmountOfPropertyClaim&#39;</span>,kind<span class="op">=</span><span class="st">&#39;violin&#39;</span>,data<span class="op">=</span>dataset)</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;The </span><span class="sc">% o</span><span class="st">f amount claimed under Property claim though there wasn&#39;t any damage to property:&quot;</span>,(<span class="bu">sum</span>(dataset[<span class="st">&#39;AmountOfPropertyClaim&#39;</span>][dataset[<span class="st">&#39;PropertyDamage&#39;</span>]<span class="op">==</span><span class="st">&#39;YES&#39;</span>])<span class="op">/</span><span class="bu">sum</span>(dataset[<span class="st">&#39;AmountOfPropertyClaim&#39;</span>])<span class="op">*</span><span class="dv">100</span>))</span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;The </span><span class="sc">% o</span><span class="st">f amount claimed under Property claim in presence of damage to property:&quot;</span>,(<span class="bu">sum</span>(dataset[<span class="st">&#39;AmountOfPropertyClaim&#39;</span>][dataset[<span class="st">&#39;PropertyDamage&#39;</span>]<span class="op">==</span><span class="st">&#39;NO&#39;</span>])<span class="op">/</span><span class="bu">sum</span>(dataset[<span class="st">&#39;AmountOfPropertyClaim&#39;</span>])<span class="op">*</span><span class="dv">100</span>))</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_307199db045148b8a4807fd051a00805/9e4b009b5786c79788bc10317c736c1d1f3450d6.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>The % of amount claimed under Property claim though there wasn&#39;t any damage to property: 47.3002683734676
The % of amount claimed under Property claim in presence of damage to property: 52.6997316265324
</code></pre>
</div>
</div>
<div class="cell markdown" id="-869nOjhIE8n">
<p><strong>Plot14:Property Damage Claims</strong></p>
<p>The maximum amount for property damage in a single claim is claimed by the customers that have reported no damage to property that is 47.3% of claim amount under property.</p>
</div>
<section id="data-cleaning" class="cell markdown" id="yOKmuVluiLdN">
<h1>Data Cleaning</h1>
</section>
<section id="missing-value-treatment" class="cell markdown" id="FkvNIkFAiQPC">
<h2>Missing Value Treatment</h2>
</section>
<div class="cell code" data-execution_count="62" id="Crl6Ce0Oh8T1">
<div class="sourceCode" id="cb111"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co">#dropping the columns which are not required for the processing ahead.</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>df<span class="op">=</span>data.drop([<span class="st">&#39;CustomerID&#39;</span>,<span class="st">&#39;ReportedFraud&#39;</span>,<span class="st">&#39;DateOfPolicyCoverage&#39;</span>,<span class="st">&#39;DateOfIncident&#39;</span>],axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>df_test<span class="op">=</span>data_test.drop([<span class="st">&#39;CustomerID&#39;</span>,<span class="st">&#39;DateOfPolicyCoverage&#39;</span>,<span class="st">&#39;DateOfIncident&#39;</span>],axis<span class="op">=</span><span class="dv">1</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="63" id="eC8jxsgOh8T2">
<div class="sourceCode" id="cb112"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>cat_cols<span class="op">=</span>df.select_dtypes(include<span class="op">=</span><span class="st">&#39;category&#39;</span>).columns</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>num_cols<span class="op">=</span>df.select_dtypes(include<span class="op">=</span>[<span class="st">&#39;int&#39;</span>,<span class="st">&#39;float&#39;</span>]).columns</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>cat_cols_test<span class="op">=</span>df_test.select_dtypes(include<span class="op">=</span><span class="st">&#39;category&#39;</span>).columns</span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>num_cols_test<span class="op">=</span>df_test.select_dtypes(include<span class="op">=</span>[<span class="st">&#39;int&#39;</span>,<span class="st">&#39;float&#39;</span>]).columns</span></code></pre></div>
</div>
<div class="cell markdown" id="pDtNVfeW-AqU">
<p>Reading the categorical and numerical column names to use for respective imputations.</p>
</div>
<div class="cell markdown" id="h3O26cCGibgk">
<p><strong>To obtain the %age of missing values in each column of both Train and Test datasets</strong></p>
</div>
<div class="cell code" data-execution_count="64" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="QBmL6x7F2-jq" data-outputId="878b393b-3660-41e1-9edb-9b03b22a88be">
<div class="sourceCode" id="cb113"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co">#to calculate % of missing values:</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Percentage of Missing Values in %&quot;</span>)</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x <span class="kw">in</span> df.columns:</span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>  y<span class="op">=</span>((df[x].isna().<span class="bu">sum</span>()<span class="op">/</span>df[x].shape[<span class="dv">0</span>])<span class="op">*</span><span class="dv">100</span>)</span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(x,<span class="st">&quot;:&quot;</span>,y)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Percentage of Missing Values in %
VehicleModel : 0.0
VehicleMake : 0.17339436815092246
VehicleYOM : 0.0
VehicleID : 0.0
InsurancePolicyNumber : 0.0
CustomerLoyaltyPeriod : 0.0
InsurancePolicyState : 0.0
Policy_CombinedSingleLimit : 0.0
Policy_Deductible : 0.0
PolicyAnnualPremium : 0.0
UmbrellaLimit : 0.0
InsuredRelationship : 0.0
InsuredAge : 0.0
InsuredZipCode : 0.0
InsuredGender : 0.10403662089055349
InsuredEducationLevel : 0.0
InsuredOccupation : 0.0
InsuredHobbies : 0.0
CapitalGains : 0.0
CapitalLoss : 0.0
Country : 0.006935774726036899
TypeOfIncident : 0.0
TypeOfCollission : 17.901234567901234
SeverityOfIncident : 0.0
AuthoritiesContacted : 0.0
IncidentState : 0.0
IncidentCity : 0.0
IncidentAddress : 0.0
IncidentTime : 0.10750450825357193
NumberOfVehicles : 0.0
PropertyDamage : 36.27063392980996
BodilyInjuries : 0.0
Witnesses : 0.15952281869884866
PoliceReport : 34.00263559439589
AmountOfTotalClaim : 0.17339436815092246
AmountOfInjuryClaim : 0.0
AmountOfPropertyClaim : 0.0
AmountOfVehicleDamage : 0.0
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="65" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="R8-f4FAi2-nP" data-outputId="f3d73301-b2ca-4825-fbac-bf00304e5aca">
<div class="sourceCode" id="cb115"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co">#to calculate % of missing values in test:</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Percentage of Missing Values in test %&quot;</span>)</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x <span class="kw">in</span> df_test.columns:</span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>  y<span class="op">=</span>((df_test[x].isna().<span class="bu">sum</span>()<span class="op">/</span>df_test[x].shape[<span class="dv">0</span>])<span class="op">*</span><span class="dv">100</span>)</span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(x,<span class="st">&quot;:&quot;</span>,y)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Percentage of Missing Values in test %
VehicleModel : 0.0
VehicleMake : 0.08976660682226212
VehicleYOM : 0.0
VehicleID : 0.0
InsurancePolicyNumber : 0.0
CustomerLoyaltyPeriod : 0.0
InsurancePolicyState : 0.0
Policy_CombinedSingleLimit : 0.0
Policy_Deductible : 0.0
PolicyAnnualPremium : 0.0
UmbrellaLimit : 0.0
InsuredRelationship : 0.0
InsuredAge : 0.0
InsuredZipCode : 0.0
InsuredGender : 0.08976660682226212
InsuredEducationLevel : 0.0
InsuredOccupation : 0.0
InsuredHobbies : 0.0
CapitalGains : 0.0
CapitalLoss : 0.0
Country : 0.04488330341113106
TypeOfIncident : 0.0
TypeOfCollission : 19.782315978456015
SeverityOfIncident : 0.0
AuthoritiesContacted : 0.0
IncidentState : 0.0
IncidentCity : 0.0
IncidentAddress : 0.0
IncidentTime : 0.07854578096947935
NumberOfVehicles : 0.0
PropertyDamage : 35.89542190305207
BodilyInjuries : 0.0
Witnesses : 0.13464991023339318
PoliceReport : 33.819569120287255
AmountOfTotalClaim : 0.08976660682226212
AmountOfInjuryClaim : 0.0
AmountOfPropertyClaim : 0.0
AmountOfVehicleDamage : 0.0
</code></pre>
</div>
</div>
<div class="cell markdown" id="i38iuJAklw9z">
<p>Iterative Imputer is highly accurate in estimating the missing values compared to other imputers.Features with higher number of missing values will be imputed by Iterative Imputer.</p>
<p>Witnesses,Incident Time,Type Of Collission,Insured gender,\Country and Vehicle Make we can impute the missing values wth the help of Simple Imputer</p>
</div>
<div class="cell code" data-execution_count="66" id="qPy6sm_x3COd">
<div class="sourceCode" id="cb117"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>si_cat<span class="op">=</span>SimpleImputer(missing_values<span class="op">=</span>np.nan,strategy<span class="op">=</span><span class="st">&#39;most_frequent&#39;</span>)</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>df[[<span class="st">&#39;Witnesses&#39;</span>,<span class="st">&#39;IncidentTime&#39;</span>,<span class="st">&#39;InsuredGender&#39;</span>,<span class="st">&#39;Country&#39;</span>,<span class="st">&#39;VehicleMake&#39;</span>]]<span class="op">=</span>si_cat.fit_transform(df[[<span class="st">&#39;Witnesses&#39;</span>,<span class="st">&#39;IncidentTime&#39;</span>,<span class="st">&#39;InsuredGender&#39;</span>,<span class="st">&#39;Country&#39;</span>,<span class="st">&#39;VehicleMake&#39;</span>]])</span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>df_test[[<span class="st">&#39;Witnesses&#39;</span>,<span class="st">&#39;IncidentTime&#39;</span>,<span class="st">&#39;InsuredGender&#39;</span>,<span class="st">&#39;Country&#39;</span>,<span class="st">&#39;VehicleMake&#39;</span>]]<span class="op">=</span>si_cat.transform(df_test[[<span class="st">&#39;Witnesses&#39;</span>,<span class="st">&#39;IncidentTime&#39;</span>,<span class="st">&#39;InsuredGender&#39;</span>,<span class="st">&#39;Country&#39;</span>,<span class="st">&#39;VehicleMake&#39;</span>]])</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="67" id="jHpK_HgK3KR3">
<div class="sourceCode" id="cb118"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>cat_le<span class="op">=</span>[<span class="st">&#39;VehicleModel&#39;</span>, <span class="st">&#39;VehicleMake&#39;</span>, <span class="st">&#39;VehicleYOM&#39;</span>, <span class="st">&#39;InsurancePolicyState&#39;</span>,</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>       <span class="st">&#39;Policy_CombinedSingleLimit&#39;</span>, <span class="st">&#39;InsuredRelationship&#39;</span>, <span class="st">&#39;InsuredGender&#39;</span>,</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>       <span class="st">&#39;InsuredEducationLevel&#39;</span>, <span class="st">&#39;InsuredOccupation&#39;</span>, <span class="st">&#39;InsuredHobbies&#39;</span>,</span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>       <span class="st">&#39;Country&#39;</span>, <span class="st">&#39;TypeOfIncident&#39;</span>,<span class="st">&#39;SeverityOfIncident&#39;</span>,</span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>       <span class="st">&#39;AuthoritiesContacted&#39;</span>, <span class="st">&#39;IncidentState&#39;</span>, <span class="st">&#39;IncidentCity&#39;</span>,</span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a>       <span class="st">&#39;IncidentAddress&#39;</span>, <span class="st">&#39;IncidentTime&#39;</span>, <span class="st">&#39;NumberOfVehicles&#39;</span>,</span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a>       <span class="st">&#39;BodilyInjuries&#39;</span>, <span class="st">&#39;Witnesses&#39;</span>,<span class="st">&#39;InsuredZipCode&#39;</span>]</span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a>cat_le_test<span class="op">=</span>[<span class="st">&#39;VehicleModel&#39;</span>, <span class="st">&#39;VehicleMake&#39;</span>, <span class="st">&#39;VehicleYOM&#39;</span>, <span class="st">&#39;InsurancePolicyState&#39;</span>,</span>
<span id="cb118-9"><a href="#cb118-9" aria-hidden="true" tabindex="-1"></a>       <span class="st">&#39;Policy_CombinedSingleLimit&#39;</span>, <span class="st">&#39;InsuredRelationship&#39;</span>, <span class="st">&#39;InsuredGender&#39;</span>,</span>
<span id="cb118-10"><a href="#cb118-10" aria-hidden="true" tabindex="-1"></a>       <span class="st">&#39;InsuredEducationLevel&#39;</span>, <span class="st">&#39;InsuredOccupation&#39;</span>, <span class="st">&#39;InsuredHobbies&#39;</span>,</span>
<span id="cb118-11"><a href="#cb118-11" aria-hidden="true" tabindex="-1"></a>       <span class="st">&#39;Country&#39;</span>, <span class="st">&#39;TypeOfIncident&#39;</span>,<span class="st">&#39;SeverityOfIncident&#39;</span>,</span>
<span id="cb118-12"><a href="#cb118-12" aria-hidden="true" tabindex="-1"></a>       <span class="st">&#39;AuthoritiesContacted&#39;</span>, <span class="st">&#39;IncidentState&#39;</span>, <span class="st">&#39;IncidentCity&#39;</span>,</span>
<span id="cb118-13"><a href="#cb118-13" aria-hidden="true" tabindex="-1"></a>       <span class="st">&#39;IncidentAddress&#39;</span>, <span class="st">&#39;IncidentTime&#39;</span>, <span class="st">&#39;NumberOfVehicles&#39;</span>,</span>
<span id="cb118-14"><a href="#cb118-14" aria-hidden="true" tabindex="-1"></a>       <span class="st">&#39;BodilyInjuries&#39;</span>, <span class="st">&#39;Witnesses&#39;</span>,<span class="st">&#39;InsuredZipCode&#39;</span>]</span></code></pre></div>
</div>
<div class="cell markdown" id="zbo7Gu1JVvRA">
<p>Encoding categorical features using LabelEncoder(),as Iterative Imputer expects numerical values as input.</p>
</div>
<div class="cell code" data-execution_count="68" id="ai3g0f_w3SRS">
<div class="sourceCode" id="cb119"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>le<span class="op">=</span>LabelEncoder()</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>df_le<span class="op">=</span>pd.DataFrame()</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>df_le<span class="op">=</span>df.drop([<span class="st">&#39;PoliceReport&#39;</span>,<span class="st">&#39;PropertyDamage&#39;</span>,<span class="st">&#39;TypeOfCollission&#39;</span>],axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Encoding labels to categorical data.</span></span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x <span class="kw">in</span> cat_le:</span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a>  df_le[x]<span class="op">=</span>le.fit_transform(df_le[x])</span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Encoding and Mapping the labels to the features with missing values separately and merging them with dataset.</span></span>
<span id="cb119-9"><a href="#cb119-9" aria-hidden="true" tabindex="-1"></a>PoliceReport<span class="op">=</span>le.fit(df[<span class="st">&#39;PoliceReport&#39;</span>].dropna())</span>
<span id="cb119-10"><a href="#cb119-10" aria-hidden="true" tabindex="-1"></a>PoliceReport_map <span class="op">=</span> <span class="bu">dict</span>(<span class="bu">zip</span>(le.classes_, <span class="bu">range</span>(<span class="bu">len</span>(le.classes_)))) </span>
<span id="cb119-11"><a href="#cb119-11" aria-hidden="true" tabindex="-1"></a>df_le[<span class="st">&#39;PoliceReport&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;PoliceReport&#39;</span>].<span class="bu">map</span>(PoliceReport_map)</span>
<span id="cb119-12"><a href="#cb119-12" aria-hidden="true" tabindex="-1"></a>df_le[<span class="st">&#39;PoliceReport&#39;</span>] <span class="op">=</span> df_le[<span class="st">&#39;PoliceReport&#39;</span>].astype(<span class="st">&#39;category&#39;</span>)</span>
<span id="cb119-13"><a href="#cb119-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-14"><a href="#cb119-14" aria-hidden="true" tabindex="-1"></a>PropertyDamage<span class="op">=</span>le.fit(df[<span class="st">&#39;PropertyDamage&#39;</span>].dropna())</span>
<span id="cb119-15"><a href="#cb119-15" aria-hidden="true" tabindex="-1"></a>PropertyDamage_map <span class="op">=</span> <span class="bu">dict</span>(<span class="bu">zip</span>(le.classes_, <span class="bu">range</span>(<span class="bu">len</span>(le.classes_)))) </span>
<span id="cb119-16"><a href="#cb119-16" aria-hidden="true" tabindex="-1"></a>df_le[<span class="st">&#39;PropertyDamage&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;PropertyDamage&#39;</span>].<span class="bu">map</span>(PropertyDamage_map)</span>
<span id="cb119-17"><a href="#cb119-17" aria-hidden="true" tabindex="-1"></a>df_le[<span class="st">&#39;PropertyDamage&#39;</span>] <span class="op">=</span> df_le[<span class="st">&#39;PropertyDamage&#39;</span>].astype(<span class="st">&#39;category&#39;</span>)</span>
<span id="cb119-18"><a href="#cb119-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-19"><a href="#cb119-19" aria-hidden="true" tabindex="-1"></a>TypeOfCollission<span class="op">=</span>le.fit(df[<span class="st">&#39;TypeOfCollission&#39;</span>].dropna())</span>
<span id="cb119-20"><a href="#cb119-20" aria-hidden="true" tabindex="-1"></a>TypeOfCollission_map <span class="op">=</span> <span class="bu">dict</span>(<span class="bu">zip</span>(le.classes_, <span class="bu">range</span>(<span class="bu">len</span>(le.classes_)))) </span>
<span id="cb119-21"><a href="#cb119-21" aria-hidden="true" tabindex="-1"></a>df_le[<span class="st">&#39;TypeOfCollission&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;TypeOfCollission&#39;</span>].<span class="bu">map</span>(TypeOfCollission_map)</span>
<span id="cb119-22"><a href="#cb119-22" aria-hidden="true" tabindex="-1"></a>df_le[<span class="st">&#39;TypeOfCollission&#39;</span>] <span class="op">=</span> df_le[<span class="st">&#39;TypeOfCollission&#39;</span>].astype(<span class="st">&#39;category&#39;</span>)</span>
<span id="cb119-23"><a href="#cb119-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-24"><a href="#cb119-24" aria-hidden="true" tabindex="-1"></a><span class="co">#Applying imputer to the dataset.</span></span>
<span id="cb119-25"><a href="#cb119-25" aria-hidden="true" tabindex="-1"></a>imp <span class="op">=</span> IterativeImputer()</span>
<span id="cb119-26"><a href="#cb119-26" aria-hidden="true" tabindex="-1"></a>imp_cols <span class="op">=</span> df_le.columns</span>
<span id="cb119-27"><a href="#cb119-27" aria-hidden="true" tabindex="-1"></a>df_le<span class="op">=</span>pd.DataFrame(imp.fit_transform(df_le),columns<span class="op">=</span>imp_cols)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="69" id="kyhfLPpV28eI">
<div class="sourceCode" id="cb120"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Repeating same procedure for Test data.</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>le<span class="op">=</span>LabelEncoder()</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>df_le_test<span class="op">=</span>pd.DataFrame()</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>df_le_test<span class="op">=</span>df_test.drop([<span class="st">&#39;PoliceReport&#39;</span>,<span class="st">&#39;PropertyDamage&#39;</span>,<span class="st">&#39;TypeOfCollission&#39;</span>],axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x <span class="kw">in</span> cat_le_test:</span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a>  df_le_test[x]<span class="op">=</span>le.fit_transform(df_le_test[x])</span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb120-9"><a href="#cb120-9" aria-hidden="true" tabindex="-1"></a>df_le_test[<span class="st">&#39;PoliceReport&#39;</span>] <span class="op">=</span> df_test[<span class="st">&#39;PoliceReport&#39;</span>].<span class="bu">map</span>(PoliceReport_map)</span>
<span id="cb120-10"><a href="#cb120-10" aria-hidden="true" tabindex="-1"></a>df_le_test[<span class="st">&#39;PoliceReport&#39;</span>] <span class="op">=</span> df_le_test[<span class="st">&#39;PoliceReport&#39;</span>].astype(<span class="st">&#39;category&#39;</span>)</span>
<span id="cb120-11"><a href="#cb120-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-12"><a href="#cb120-12" aria-hidden="true" tabindex="-1"></a>df_le_test[<span class="st">&#39;PropertyDamage&#39;</span>] <span class="op">=</span> df_test[<span class="st">&#39;PropertyDamage&#39;</span>].<span class="bu">map</span>(PropertyDamage_map)</span>
<span id="cb120-13"><a href="#cb120-13" aria-hidden="true" tabindex="-1"></a>df_le_test[<span class="st">&#39;PropertyDamage&#39;</span>] <span class="op">=</span> df_le_test[<span class="st">&#39;PropertyDamage&#39;</span>].astype(<span class="st">&#39;category&#39;</span>)</span>
<span id="cb120-14"><a href="#cb120-14" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb120-15"><a href="#cb120-15" aria-hidden="true" tabindex="-1"></a>df_le_test[<span class="st">&#39;TypeOfCollission&#39;</span>] <span class="op">=</span> df_test[<span class="st">&#39;TypeOfCollission&#39;</span>].<span class="bu">map</span>(TypeOfCollission_map)</span>
<span id="cb120-16"><a href="#cb120-16" aria-hidden="true" tabindex="-1"></a>df_le_test[<span class="st">&#39;TypeOfCollission&#39;</span>] <span class="op">=</span> df_le_test[<span class="st">&#39;TypeOfCollission&#39;</span>].astype(<span class="st">&#39;category&#39;</span>)</span>
<span id="cb120-17"><a href="#cb120-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-18"><a href="#cb120-18" aria-hidden="true" tabindex="-1"></a>imp_cols_test <span class="op">=</span> df_le_test.columns</span>
<span id="cb120-19"><a href="#cb120-19" aria-hidden="true" tabindex="-1"></a>df_le_test<span class="op">=</span>pd.DataFrame(imp.transform(df_le_test),columns<span class="op">=</span>imp_cols_test)</span></code></pre></div>
</div>
<div class="cell markdown" id="EukAPtK5_0G_">
<p>Taking the imputed features and merging them with the dataset without labels.</p>
</div>
<div class="cell code" data-execution_count="70" id="318uJnF-3eZg">
<div class="sourceCode" id="cb121"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>df_le[[<span class="st">&#39;TypeOfCollission&#39;</span>,<span class="st">&#39;PoliceReport&#39;</span>,<span class="st">&#39;PropertyDamage&#39;</span>]]<span class="op">=</span>np.<span class="bu">round</span>(df_le[[<span class="st">&#39;TypeOfCollission&#39;</span>,<span class="st">&#39;PoliceReport&#39;</span>,<span class="st">&#39;PropertyDamage&#39;</span>]])</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>df_le_test[[<span class="st">&#39;TypeOfCollission&#39;</span>,<span class="st">&#39;PoliceReport&#39;</span>,<span class="st">&#39;PropertyDamage&#39;</span>]]<span class="op">=</span>np.<span class="bu">round</span>(df_le_test[[<span class="st">&#39;TypeOfCollission&#39;</span>,<span class="st">&#39;PoliceReport&#39;</span>,<span class="st">&#39;PropertyDamage&#39;</span>]])</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;PoliceReport&#39;</span>]<span class="op">=</span>df_le[<span class="st">&#39;PoliceReport&#39;</span>].astype(<span class="st">&#39;category&#39;</span>)</span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;TypeOfCollission&#39;</span>]<span class="op">=</span>df_le[<span class="st">&#39;TypeOfCollission&#39;</span>].astype(<span class="st">&#39;category&#39;</span>)</span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;PropertyDamage&#39;</span>]<span class="op">=</span>df_le[<span class="st">&#39;PropertyDamage&#39;</span>].astype(<span class="st">&#39;category&#39;</span>)</span>
<span id="cb121-7"><a href="#cb121-7" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;AmountOfTotalClaim&#39;</span>]<span class="op">=</span>df_le[<span class="st">&#39;AmountOfTotalClaim&#39;</span>]</span>
<span id="cb121-8"><a href="#cb121-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-9"><a href="#cb121-9" aria-hidden="true" tabindex="-1"></a>df_test[<span class="st">&#39;PoliceReport&#39;</span>]<span class="op">=</span>df_le_test[<span class="st">&#39;PoliceReport&#39;</span>].astype(<span class="st">&#39;category&#39;</span>)</span>
<span id="cb121-10"><a href="#cb121-10" aria-hidden="true" tabindex="-1"></a>df_test[<span class="st">&#39;TypeOfCollission&#39;</span>]<span class="op">=</span>df_le_test[<span class="st">&#39;TypeOfCollission&#39;</span>].astype(<span class="st">&#39;category&#39;</span>)</span>
<span id="cb121-11"><a href="#cb121-11" aria-hidden="true" tabindex="-1"></a>df_test[<span class="st">&#39;PropertyDamage&#39;</span>]<span class="op">=</span>df_le_test[<span class="st">&#39;PropertyDamage&#39;</span>].astype(<span class="st">&#39;category&#39;</span>)</span>
<span id="cb121-12"><a href="#cb121-12" aria-hidden="true" tabindex="-1"></a>df_test[<span class="st">&#39;AmountOfTotalClaim&#39;</span>]<span class="op">=</span>df_le_test[<span class="st">&#39;AmountOfTotalClaim&#39;</span>]</span></code></pre></div>
</div>
<div class="cell code" id="9qV5hVEoBiF5">
<div class="sourceCode" id="cb122"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>df.dtypes</span></code></pre></div>
</div>
<div class="cell code" id="AR7DtM9y1NeE">
<div class="sourceCode" id="cb123"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>df_test.dtypes</span></code></pre></div>
</div>
<div class="cell markdown" id="ayj-4UnvAD3o">
<p>Some columns have been missing their dtype,so reassigning the type to those columns.</p>
</div>
<div class="cell code" data-execution_count="73" id="LpC4RYL1i6QE">
<div class="sourceCode" id="cb124"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>df[[<span class="st">&#39;VehicleMake&#39;</span>,<span class="st">&#39;Witnesses&#39;</span>,<span class="st">&#39;Country&#39;</span>,<span class="st">&#39;InsuredGender&#39;</span>,<span class="st">&#39;IncidentTime&#39;</span>,</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;InsuredZipCode&#39;</span>]]<span class="op">=</span>df[[<span class="st">&#39;VehicleMake&#39;</span>,<span class="st">&#39;Witnesses&#39;</span>,<span class="st">&#39;Country&#39;</span>,<span class="st">&#39;InsuredGender&#39;</span>,<span class="st">&#39;IncidentTime&#39;</span>,<span class="st">&#39;InsuredZipCode&#39;</span>]].astype(<span class="st">&#39;category&#39;</span>)</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>df_test[[<span class="st">&#39;VehicleMake&#39;</span>,<span class="st">&#39;Witnesses&#39;</span>,<span class="st">&#39;Country&#39;</span>,<span class="st">&#39;InsuredGender&#39;</span>,<span class="st">&#39;IncidentTime&#39;</span>,</span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>         <span class="st">&#39;InsuredZipCode&#39;</span>]]<span class="op">=</span>df_test[[<span class="st">&#39;VehicleMake&#39;</span>,<span class="st">&#39;Witnesses&#39;</span>,<span class="st">&#39;Country&#39;</span>,<span class="st">&#39;InsuredGender&#39;</span>,<span class="st">&#39;IncidentTime&#39;</span>,<span class="st">&#39;InsuredZipCode&#39;</span>]].astype(<span class="st">&#39;category&#39;</span>)</span></code></pre></div>
</div>
<section id="outlier-detection-and-treatment" class="cell markdown" id="jVAiJ617ksyC">
<h2>Outlier Detection and Treatment</h2>
</section>
<div class="cell code" data-execution_count="74" data-colab="{&quot;height&quot;:364,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="dHOFzM_GrvVE" data-outputId="dd66861b-a1b3-4ce8-d350-0d6840ed897c">
<div class="sourceCode" id="cb125"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>box<span class="op">=</span>df[num_cols]</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>box.describe()</span></code></pre></div>
<div class="output execute_result" data-execution_count="74">

  <div id="df-13f8dd22-3110-49a1-a272-d64f133864a7">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>VehicleID</th>
      <th>InsurancePolicyNumber</th>
      <th>CustomerLoyaltyPeriod</th>
      <th>Policy_Deductible</th>
      <th>PolicyAnnualPremium</th>
      <th>UmbrellaLimit</th>
      <th>InsuredAge</th>
      <th>CapitalGains</th>
      <th>CapitalLoss</th>
      <th>AmountOfTotalClaim</th>
      <th>AmountOfInjuryClaim</th>
      <th>AmountOfPropertyClaim</th>
      <th>AmountOfVehicleDamage</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>28836.000000</td>
      <td>28836.000000</td>
      <td>28836.000000</td>
      <td>28836.000000</td>
      <td>28836.000000</td>
      <td>2.883600e+04</td>
      <td>28836.000000</td>
      <td>28836.000000</td>
      <td>28836.000000</td>
      <td>28836.000000</td>
      <td>28836.000000</td>
      <td>28836.000000</td>
      <td>28836.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>20651.174261</td>
      <td>129312.517097</td>
      <td>203.067867</td>
      <td>1114.282529</td>
      <td>1255.528382</td>
      <td>9.836680e+05</td>
      <td>38.815370</td>
      <td>23066.569566</td>
      <td>-24940.612429</td>
      <td>52308.118012</td>
      <td>7337.118428</td>
      <td>7283.870197</td>
      <td>37687.129387</td>
    </tr>
    <tr>
      <th>std</th>
      <td>11114.833360</td>
      <td>11114.060267</td>
      <td>99.932951</td>
      <td>546.632816</td>
      <td>223.013899</td>
      <td>1.969282e+06</td>
      <td>7.996377</td>
      <td>27637.813724</td>
      <td>27913.209608</td>
      <td>25101.479144</td>
      <td>4427.638593</td>
      <td>4375.842738</td>
      <td>17977.048232</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1401.000000</td>
      <td>110122.000000</td>
      <td>1.000000</td>
      <td>500.000000</td>
      <td>-1.000000</td>
      <td>-1.000000e+06</td>
      <td>19.000000</td>
      <td>0.000000</td>
      <td>-111100.000000</td>
      <td>150.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>109.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>11035.750000</td>
      <td>119698.750000</td>
      <td>126.000000</td>
      <td>622.000000</td>
      <td>1122.007500</td>
      <td>0.000000e+00</td>
      <td>33.000000</td>
      <td>0.000000</td>
      <td>-50000.000000</td>
      <td>44652.000000</td>
      <td>4743.750000</td>
      <td>4862.000000</td>
      <td>32193.250000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>20623.000000</td>
      <td>129278.500000</td>
      <td>199.000000</td>
      <td>1000.000000</td>
      <td>1265.205000</td>
      <td>0.000000e+00</td>
      <td>38.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>58359.500000</td>
      <td>7147.000000</td>
      <td>7051.000000</td>
      <td>42457.500000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>30275.250000</td>
      <td>138933.250000</td>
      <td>267.000000</td>
      <td>1627.000000</td>
      <td>1396.605000</td>
      <td>4.859610e+05</td>
      <td>44.000000</td>
      <td>49000.000000</td>
      <td>0.000000</td>
      <td>68977.000000</td>
      <td>10571.250000</td>
      <td>10327.000000</td>
      <td>49535.750000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>39898.000000</td>
      <td>148619.000000</td>
      <td>479.000000</td>
      <td>2000.000000</td>
      <td>2047.590000</td>
      <td>1.000000e+07</td>
      <td>64.000000</td>
      <td>100500.000000</td>
      <td>0.000000</td>
      <td>114920.000000</td>
      <td>21450.000000</td>
      <td>23670.000000</td>
      <td>79560.000000</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-13f8dd22-3110-49a1-a272-d64f133864a7')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-13f8dd22-3110-49a1-a272-d64f133864a7 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-13f8dd22-3110-49a1-a272-d64f133864a7');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell markdown" id="H6XkxBwOtNal">
<p>We can see that PolicyAnnualPremium and Umbrella Limit which are expected to be +ve values, have minimum in -ve which are definitely outliers.</p>
<p>We will be replacing them with the median. For the Umbrella Limit its better to inverse the sign maybe.</p>
<p>Rest all columns appear pretty normal for now so wont change anything</p>
</div>
<div class="cell code" data-execution_count="75" data-colab="{&quot;height&quot;:351,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="0Pw8O0Cvbp3w" data-outputId="edb73e11-1e96-4269-a57d-a18c17854fb2">
<div class="sourceCode" id="cb126"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>policy_premium<span class="op">=</span>df[<span class="st">&#39;PolicyAnnualPremium&#39;</span>].to_list()</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(policy_premium)):</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(policy_premium[x]<span class="op">&lt;</span><span class="dv">0</span>):</span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>    policy_premium[x]<span class="op">=</span>median(policy_premium)</span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;PolicyAnnualPremium&#39;</span>]<span class="op">=</span>policy_premium</span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a>sns.boxplot(df[<span class="st">&#39;PolicyAnnualPremium&#39;</span>])</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/usr/local/lib/python3.7/dist-packages/seaborn/_decorators.py:43: FutureWarning: Pass the following variable as a keyword arg: x. From version 0.12, the only valid positional argument will be `data`, and passing other arguments without an explicit keyword will result in an error or misinterpretation.
  FutureWarning
</code></pre>
</div>
<div class="output execute_result" data-execution_count="75">
<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fc998ddd150&gt;</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_307199db045148b8a4807fd051a00805/d7e7fc3ec3a28e23950a2e4d88a842ef4c6796a5.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="76" data-colab="{&quot;height&quot;:351,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="N9P-EWY4W-O5" data-outputId="e22dd3d2-6ffe-4809-f0ec-81037a9ebc7e">
<div class="sourceCode" id="cb129"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co">#the figure shows Umbrella limit has some outlier(-ve values):from industrial view -ve umbrella limit is invalid.so lets multiply them with -1,to make them positive</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>umbrella_limit<span class="op">=</span>df[<span class="st">&#39;UmbrellaLimit&#39;</span>].to_list()</span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(umbrella_limit)):</span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(umbrella_limit[x]<span class="op">&lt;</span><span class="dv">0</span>):</span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>    umbrella_limit[x]<span class="op">=</span>umbrella_limit[x]<span class="op">*</span>(<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;UmbrellaLimit&#39;</span>]<span class="op">=</span>umbrella_limit</span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-9"><a href="#cb129-9" aria-hidden="true" tabindex="-1"></a>sns.boxplot(df[<span class="st">&#39;UmbrellaLimit&#39;</span>])</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/usr/local/lib/python3.7/dist-packages/seaborn/_decorators.py:43: FutureWarning: Pass the following variable as a keyword arg: x. From version 0.12, the only valid positional argument will be `data`, and passing other arguments without an explicit keyword will result in an error or misinterpretation.
  FutureWarning
</code></pre>
</div>
<div class="output execute_result" data-execution_count="76">
<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fc996e2a5d0&gt;</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_307199db045148b8a4807fd051a00805/6cf90cc72fd5f9d0ad629f00173f699cfd9a07c1.png" /></p>
</div>
</div>
<section id="feature-engineering" class="cell markdown" id="lsvBzi0iwxiD">
<h1>Feature Engineering</h1>
</section>
<div class="cell markdown" id="RtgOfjTmSFl6">
<p><strong>Delta Days</strong></p>
<p>The difference in number of days between the Date Of Policy Coverage and the Date of the incident is calculated and stored as Delta Days.The difference in days is the time taken by the customer to report and claim the money from company which i believe might be useful.</p>
</div>
<div class="cell code" data-execution_count="77" id="kRHQraQ_wm37">
<div class="sourceCode" id="cb132"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>delta,z<span class="op">=</span>[],[]</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(date)):</span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>  y<span class="op">=</span>(date[x]<span class="op">-</span>new_dop[x])</span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>  delta.append(y)</span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a>DifferenceOfDays<span class="op">=</span>pd.Series(delta)</span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(DifferenceOfDays)):</span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a>  y<span class="op">=</span>(<span class="bu">str</span>(DifferenceOfDays[x]).split(<span class="st">&quot; &quot;</span>))</span>
<span id="cb132-9"><a href="#cb132-9" aria-hidden="true" tabindex="-1"></a>  z.append(y[<span class="dv">0</span>])</span>
<span id="cb132-10"><a href="#cb132-10" aria-hidden="true" tabindex="-1"></a><span class="co">#######################################</span></span>
<span id="cb132-11"><a href="#cb132-11" aria-hidden="true" tabindex="-1"></a>delta_test,z_test<span class="op">=</span>[],[]</span>
<span id="cb132-12"><a href="#cb132-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(date_test)):</span>
<span id="cb132-13"><a href="#cb132-13" aria-hidden="true" tabindex="-1"></a>  y<span class="op">=</span>(date_test[x]<span class="op">-</span>new_dop_test[x])</span>
<span id="cb132-14"><a href="#cb132-14" aria-hidden="true" tabindex="-1"></a>  delta_test.append(y)</span>
<span id="cb132-15"><a href="#cb132-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-16"><a href="#cb132-16" aria-hidden="true" tabindex="-1"></a>DifferenceOfDays_test<span class="op">=</span>pd.Series(delta_test)</span>
<span id="cb132-17"><a href="#cb132-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(DifferenceOfDays_test)):</span>
<span id="cb132-18"><a href="#cb132-18" aria-hidden="true" tabindex="-1"></a>  y<span class="op">=</span>(<span class="bu">str</span>(DifferenceOfDays_test[x]).split(<span class="st">&quot; &quot;</span>))</span>
<span id="cb132-19"><a href="#cb132-19" aria-hidden="true" tabindex="-1"></a>  z_test.append(y[<span class="dv">0</span>])</span>
<span id="cb132-20"><a href="#cb132-20" aria-hidden="true" tabindex="-1"></a><span class="co">############################################################</span></span>
<span id="cb132-21"><a href="#cb132-21" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;DeltaDays&#39;</span>]<span class="op">=</span>z</span>
<span id="cb132-22"><a href="#cb132-22" aria-hidden="true" tabindex="-1"></a>df_test[<span class="st">&#39;DeltaDays&#39;</span>]<span class="op">=</span>z_test</span>
<span id="cb132-23"><a href="#cb132-23" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;DeltaDays&#39;</span>]<span class="op">=</span>df[<span class="st">&#39;DeltaDays&#39;</span>].astype(<span class="st">&#39;int&#39;</span>)</span>
<span id="cb132-24"><a href="#cb132-24" aria-hidden="true" tabindex="-1"></a>df_test[<span class="st">&#39;DeltaDays&#39;</span>]<span class="op">=</span>df_test[<span class="st">&#39;DeltaDays&#39;</span>].astype(<span class="st">&#39;int&#39;</span>)</span></code></pre></div>
</div>
<section id="feature-transformation" class="cell markdown" id="FSbfMRI3w-OF">
<h1>Feature Transformation</h1>
</section>
<div class="cell markdown" id="OZX3esx9Qg-e">
<p><strong>Numerical To Categorical:Binning</strong></p>
<p>Can reduce the impact of measurement errors and improves the model performance.</p>
<p>1.Umbrella_Limit:There are some datapoints with 0 limit and some very high.As its value is of not much use but the presence or absence of the limit might help us.</p>
<p>2.InsuredAge:</p>
<p>20-35:Young</p>
<p>36-50:Senior</p>
<p>50+:Old</p>
</div>
<div class="cell code" data-execution_count="78" id="K0j46-sbPzKJ">
<div class="sourceCode" id="cb133"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>umbrella<span class="op">=</span>np.<span class="bu">round</span>(df[<span class="st">&#39;UmbrellaLimit&#39;</span>].to_list())</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>new_limit<span class="op">=</span>[]</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(umbrella)):</span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(umbrella[i]<span class="op">==</span><span class="dv">0</span>):</span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>    new_limit.append(<span class="st">&#39;Absent&#39;</span>)</span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>:</span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a>    new_limit.append(<span class="st">&#39;Present&#39;</span>)</span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-9"><a href="#cb133-9" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;UmbrellaLimit&#39;</span>]<span class="op">=</span>new_limit</span>
<span id="cb133-10"><a href="#cb133-10" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;UmbrellaLimit&#39;</span>]<span class="op">=</span>df[<span class="st">&#39;UmbrellaLimit&#39;</span>].astype(<span class="st">&#39;category&#39;</span>)</span>
<span id="cb133-11"><a href="#cb133-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-12"><a href="#cb133-12" aria-hidden="true" tabindex="-1"></a>umbrella_test<span class="op">=</span>np.<span class="bu">round</span>(df_test[<span class="st">&#39;UmbrellaLimit&#39;</span>].to_list())</span>
<span id="cb133-13"><a href="#cb133-13" aria-hidden="true" tabindex="-1"></a>new_limit_test<span class="op">=</span>[]</span>
<span id="cb133-14"><a href="#cb133-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(umbrella_test)):</span>
<span id="cb133-15"><a href="#cb133-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(umbrella_test[i]<span class="op">==</span><span class="dv">0</span>):</span>
<span id="cb133-16"><a href="#cb133-16" aria-hidden="true" tabindex="-1"></a>    new_limit_test.append(<span class="st">&#39;Absent&#39;</span>)</span>
<span id="cb133-17"><a href="#cb133-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>:</span>
<span id="cb133-18"><a href="#cb133-18" aria-hidden="true" tabindex="-1"></a>    new_limit_test.append(<span class="st">&#39;Present&#39;</span>)</span>
<span id="cb133-19"><a href="#cb133-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-20"><a href="#cb133-20" aria-hidden="true" tabindex="-1"></a>df_test[<span class="st">&#39;UmbrellaLimit&#39;</span>]<span class="op">=</span>new_limit_test</span>
<span id="cb133-21"><a href="#cb133-21" aria-hidden="true" tabindex="-1"></a>df_test[<span class="st">&#39;UmbrellaLimit&#39;</span>]<span class="op">=</span>df_test[<span class="st">&#39;UmbrellaLimit&#39;</span>].astype(<span class="st">&#39;category&#39;</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="79" id="yqxuI5FZQnsV">
<div class="sourceCode" id="cb134"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>age<span class="op">=</span>df[<span class="st">&#39;InsuredAge&#39;</span>].to_list()</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>new_age<span class="op">=</span>[]</span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(age)):</span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(age[i]<span class="op">&lt;=</span><span class="dv">35</span>):</span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a>    new_age.append(<span class="st">&#39;Young&#39;</span>)</span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">elif</span>(<span class="dv">35</span><span class="op">&lt;</span>age[i]<span class="op">&lt;=</span><span class="dv">50</span>):</span>
<span id="cb134-7"><a href="#cb134-7" aria-hidden="true" tabindex="-1"></a>    new_age.append(<span class="st">&#39;Senior&#39;</span>)</span>
<span id="cb134-8"><a href="#cb134-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>:</span>
<span id="cb134-9"><a href="#cb134-9" aria-hidden="true" tabindex="-1"></a>    new_age.append(<span class="st">&#39;Old&#39;</span>)</span>
<span id="cb134-10"><a href="#cb134-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-11"><a href="#cb134-11" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;InsuredAge&#39;</span>]<span class="op">=</span>new_age</span>
<span id="cb134-12"><a href="#cb134-12" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;InsuredAge&#39;</span>]<span class="op">=</span>df[<span class="st">&#39;InsuredAge&#39;</span>].astype(<span class="st">&#39;category&#39;</span>)</span>
<span id="cb134-13"><a href="#cb134-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-14"><a href="#cb134-14" aria-hidden="true" tabindex="-1"></a>age_test<span class="op">=</span>df_test[<span class="st">&#39;InsuredAge&#39;</span>].to_list()</span>
<span id="cb134-15"><a href="#cb134-15" aria-hidden="true" tabindex="-1"></a>new_age_test<span class="op">=</span>[]</span>
<span id="cb134-16"><a href="#cb134-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(age_test)):</span>
<span id="cb134-17"><a href="#cb134-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(age_test[i]<span class="op">&lt;=</span><span class="dv">35</span>):</span>
<span id="cb134-18"><a href="#cb134-18" aria-hidden="true" tabindex="-1"></a>    new_age_test.append(<span class="st">&#39;Young&#39;</span>)</span>
<span id="cb134-19"><a href="#cb134-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">elif</span>(<span class="dv">35</span><span class="op">&lt;</span>age_test[i]<span class="op">&lt;=</span><span class="dv">50</span>):</span>
<span id="cb134-20"><a href="#cb134-20" aria-hidden="true" tabindex="-1"></a>    new_age_test.append(<span class="st">&#39;Senior&#39;</span>)</span>
<span id="cb134-21"><a href="#cb134-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>:</span>
<span id="cb134-22"><a href="#cb134-22" aria-hidden="true" tabindex="-1"></a>    new_age_test.append(<span class="st">&#39;Old&#39;</span>)</span>
<span id="cb134-23"><a href="#cb134-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-24"><a href="#cb134-24" aria-hidden="true" tabindex="-1"></a>df_test[<span class="st">&#39;InsuredAge&#39;</span>]<span class="op">=</span>new_age_test</span>
<span id="cb134-25"><a href="#cb134-25" aria-hidden="true" tabindex="-1"></a>df_test[<span class="st">&#39;InsuredAge&#39;</span>]<span class="op">=</span>df_test[<span class="st">&#39;InsuredAge&#39;</span>].astype(<span class="st">&#39;category&#39;</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="80" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="wHJejwsrw311" data-outputId="4d5deed6-f6bf-417f-c3e0-d57dda2f7adc">
<div class="sourceCode" id="cb135"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>df.dtypes</span></code></pre></div>
<div class="output execute_result" data-execution_count="80">
<pre><code>VehicleModel                  category
VehicleMake                   category
VehicleYOM                    category
VehicleID                        int64
InsurancePolicyNumber            int64
CustomerLoyaltyPeriod            int64
InsurancePolicyState          category
Policy_CombinedSingleLimit    category
Policy_Deductible                int64
PolicyAnnualPremium            float64
UmbrellaLimit                 category
InsuredRelationship           category
InsuredAge                    category
InsuredZipCode                category
InsuredGender                 category
InsuredEducationLevel         category
InsuredOccupation             category
InsuredHobbies                category
CapitalGains                     int64
CapitalLoss                      int64
Country                       category
TypeOfIncident                category
TypeOfCollission              category
SeverityOfIncident            category
AuthoritiesContacted          category
IncidentState                 category
IncidentCity                  category
IncidentAddress               category
IncidentTime                  category
NumberOfVehicles              category
PropertyDamage                category
BodilyInjuries                category
Witnesses                     category
PoliceReport                  category
AmountOfTotalClaim             float64
AmountOfInjuryClaim              int64
AmountOfPropertyClaim            int64
AmountOfVehicleDamage            int64
DeltaDays                        int64
dtype: object</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="81" id="xmgmIcKEj2Kj">
<div class="sourceCode" id="cb137"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>cat_cols<span class="op">=</span>df.select_dtypes(include<span class="op">=</span><span class="st">&#39;category&#39;</span>).columns</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>num_cols<span class="op">=</span>df.select_dtypes(include<span class="op">=</span>np.number).columns</span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>num_cols_test<span class="op">=</span>num_cols</span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>cat_cols_test<span class="op">=</span>cat_cols</span></code></pre></div>
</div>
<div class="cell markdown" id="-piNVV7QxW58">
<p><strong>Categorical To Numerical</strong></p>
<p>1.Response Encoding:Used to convert categorical features with more unique values into numerical values.Where each unique data in a feature is assigned its respective F- test score.Done to retain data importance and to save computation time as it reduces the number of columns as well.</p>
<p>2.One Hot Encoding:To convert categorical features into 0's and 1's.</p>
</div>
<div class="cell markdown" id="Axqrc6v-BzFS">
<p><strong>Reponse Encoding</strong></p>
</div>
<div class="cell code" id="WzWwbSo7wiEq">
<div class="sourceCode" id="cb138"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1.Response Encoding</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Response Encoding:To handle columns with more number of unique categorical values:helps to reduce column count</span></span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a><span class="co">#find the related scores of each incident location with target..then map them to their places in dataframe</span></span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> response_encoding(data,data_test,target):</span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a>  bin_data<span class="op">=</span>pd.get_dummies(data<span class="op">=</span>data,prefix_sep<span class="op">=</span><span class="st">&quot;_&quot;</span>)</span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a>  fraud<span class="op">=</span>pd.get_dummies(data<span class="op">=</span>target,drop_first<span class="op">=</span><span class="va">True</span>,prefix_sep<span class="op">=</span><span class="st">&quot;_&quot;</span>).astype(<span class="st">&#39;category&#39;</span>)</span>
<span id="cb138-7"><a href="#cb138-7" aria-hidden="true" tabindex="-1"></a>  features <span class="op">=</span> array(bin_data.columns)</span>
<span id="cb138-8"><a href="#cb138-8" aria-hidden="true" tabindex="-1"></a>  model<span class="op">=</span>SelectKBest(f_classif,k<span class="op">=</span><span class="st">&#39;all&#39;</span>)</span>
<span id="cb138-9"><a href="#cb138-9" aria-hidden="true" tabindex="-1"></a>  model.fit_transform(X<span class="op">=</span>bin_data,y<span class="op">=</span>fraud)</span>
<span id="cb138-10"><a href="#cb138-10" aria-hidden="true" tabindex="-1"></a>  <span class="bu">filter</span><span class="op">=</span>model.get_support()</span>
<span id="cb138-11"><a href="#cb138-11" aria-hidden="true" tabindex="-1"></a>  scores<span class="op">=</span>model.scores_</span>
<span id="cb138-12"><a href="#cb138-12" aria-hidden="true" tabindex="-1"></a>  bin_map<span class="op">=</span><span class="bu">dict</span>(<span class="bu">zip</span>(features,scores))</span>
<span id="cb138-13"><a href="#cb138-13" aria-hidden="true" tabindex="-1"></a>  data<span class="op">=</span>data.<span class="bu">map</span>(bin_map).astype(<span class="st">&#39;float&#39;</span>)</span>
<span id="cb138-14"><a href="#cb138-14" aria-hidden="true" tabindex="-1"></a>  data_test<span class="op">=</span>data_test.<span class="bu">map</span>(bin_map).astype(<span class="st">&#39;float&#39;</span>)</span>
<span id="cb138-15"><a href="#cb138-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> data,data_test</span>
<span id="cb138-16"><a href="#cb138-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-17"><a href="#cb138-17" aria-hidden="true" tabindex="-1"></a>cols<span class="op">=</span>[<span class="st">&#39;VehicleModel&#39;</span>,<span class="st">&#39;Policy_CombinedSingleLimit&#39;</span>,<span class="st">&#39;InsuredOccupation&#39;</span>,<span class="st">&#39;InsuredHobbies&#39;</span>,<span class="st">&#39;InsuredEducationLevel&#39;</span>,</span>
<span id="cb138-18"><a href="#cb138-18" aria-hidden="true" tabindex="-1"></a>      <span class="st">&#39;IncidentCity&#39;</span>,<span class="st">&#39;IncidentAddress&#39;</span>,<span class="st">&#39;VehicleMake&#39;</span>,<span class="st">&#39;VehicleYOM&#39;</span>,<span class="st">&#39;IncidentTime&#39;</span>,<span class="st">&#39;InsuredRelationship&#39;</span>,<span class="st">&#39;InsuredZipCode&#39;</span>,<span class="st">&#39;InsurancePolicyState&#39;</span>]</span>
<span id="cb138-19"><a href="#cb138-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x <span class="kw">in</span> cols:</span>
<span id="cb138-20"><a href="#cb138-20" aria-hidden="true" tabindex="-1"></a>  df[x],df_test[x]<span class="op">=</span>response_encoding(df[x],df_test[x],data[<span class="st">&#39;ReportedFraud&#39;</span>])</span></code></pre></div>
</div>
<div class="cell markdown" id="3ZTB_v8JxcqR">
<p><strong>One Hot Encoding</strong></p>
</div>
<div class="cell code" data-execution_count="83" id="0tw3WQOvLvkr">
<div class="sourceCode" id="cb139"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>cat_cols<span class="op">=</span>df.select_dtypes(include<span class="op">=</span><span class="st">&#39;category&#39;</span>).columns</span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>num_cols<span class="op">=</span>df.select_dtypes(include<span class="op">=</span>np.number).columns</span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>num_cols_test<span class="op">=</span>num_cols</span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>cat_cols_test<span class="op">=</span>cat_cols</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="84" id="7TWn7loVA_f_">
<div class="sourceCode" id="cb140"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>ohe<span class="op">=</span>OneHotEncoder(handle_unknown<span class="op">=</span><span class="st">&#39;ignore&#39;</span>,sparse<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>df_dum<span class="op">=</span>pd.DataFrame(data<span class="op">=</span>ohe.fit_transform(df[cat_cols]),columns<span class="op">=</span>ohe.get_feature_names_out())</span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>df_dum_test<span class="op">=</span>pd.DataFrame(data<span class="op">=</span>ohe.fit_transform(df_test[cat_cols_test]),columns<span class="op">=</span>ohe.get_feature_names_out())</span></code></pre></div>
</div>
<section id="feature-scaling" class="cell markdown" id="6M2oPzJ0w6zs">
<h1>Feature Scaling</h1>
</section>
<div class="cell markdown" id="5kEFgpAzSWHL">
<p><strong>Robust Scaler()</strong></p>
<p>Not sensitive to outliers as it uses IQR to scale the data.</p>
</div>
<div class="cell code" data-execution_count="85" id="s6Vr5Ouy_37L">
<div class="sourceCode" id="cb141"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>rs<span class="op">=</span>RobustScaler()</span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>df[num_cols]<span class="op">=</span>rs.fit_transform(df[num_cols])</span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>df_test[num_cols_test]<span class="op">=</span>rs.transform(df_test[num_cols_test])</span></code></pre></div>
</div>
<div class="cell markdown" id="WUHvgyLCxGEU">
<p>#Feature Selection and Elimination</p>
<p>To eliminate the features of less importance that helps to avoid overfitting as well as to save computation time and resources.</p>
</div>
<div class="cell code" data-execution_count="86" id="u-EOj7iBwpKS">
<div class="sourceCode" id="cb142"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>fs_x<span class="op">=</span>pd.DataFrame()</span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>fs_x<span class="op">=</span>pd.concat((df[num_cols],df_dum),axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>fs_y<span class="op">=</span>pd.get_dummies(data<span class="op">=</span>data[<span class="st">&#39;ReportedFraud&#39;</span>],drop_first<span class="op">=</span><span class="va">True</span>,prefix_sep<span class="op">=</span><span class="st">&quot;_&quot;</span>).astype(<span class="st">&#39;category&#39;</span>)</span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a>fs_x_test<span class="op">=</span>pd.DataFrame()</span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a>fs_x_test<span class="op">=</span>pd.concat((df_test[num_cols],df_dum_test),axis<span class="op">=</span><span class="dv">1</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="97" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="KkE2BbHYzodG" data-outputId="fc86e2cd-eda0-468a-e7f7-edf1be0c4b41">
<div class="sourceCode" id="cb143"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Feature Selection#coz using chi2 test is conducted only when all features are categorical</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>model<span class="op">=</span>SelectKBest(f_classif,k<span class="op">=</span><span class="st">&#39;all&#39;</span>)</span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>model.fit_transform(X<span class="op">=</span>fs_x,y<span class="op">=</span>fs_y)</span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a><span class="bu">filter</span> <span class="op">=</span> model.get_support()</span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>features <span class="op">=</span> array(fs_x.columns)</span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a>scores<span class="op">=</span>model.scores_</span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a>new_score<span class="op">=</span>[]</span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a>feature_select<span class="op">=</span>[]</span>
<span id="cb143-9"><a href="#cb143-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(scores)):</span>
<span id="cb143-10"><a href="#cb143-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(scores[i]<span class="op">&gt;</span><span class="dv">50</span>):</span>
<span id="cb143-11"><a href="#cb143-11" aria-hidden="true" tabindex="-1"></a>    new_score.append(scores[i])</span>
<span id="cb143-12"><a href="#cb143-12" aria-hidden="true" tabindex="-1"></a>    feature_select.append(features[i])</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/usr/local/lib/python3.7/dist-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/usr/local/lib/python3.7/dist-packages/sklearn/feature_selection/_univariate_selection.py:112: UserWarning: Features [32] are constant.
  warnings.warn(&quot;Features %s are constant.&quot; % constant_features_idx, UserWarning)
/usr/local/lib/python3.7/dist-packages/sklearn/feature_selection/_univariate_selection.py:113: RuntimeWarning: invalid value encountered in true_divide
  f = msb / msw
</code></pre>
</div>
</div>
<div class="cell markdown" id="n4RKFOHKXx3T">
<p><strong>Relevance score of 50 is kept as threshold to select features hence able to eliminate low relevant features</strong></p>
</div>
<div class="cell code" data-execution_count="98" data-colab="{&quot;height&quot;:580,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="cO7L9PSHKuPx" data-outputId="2a0af843-bff7-402f-9df0-73d3e651f6ee">
<div class="sourceCode" id="cb145"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>,<span class="dv">8</span>))</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>top_features<span class="op">=</span>feature_select[<span class="dv">0</span>:<span class="dv">20</span>]</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>top_scores<span class="op">=</span>new_score[<span class="dv">0</span>:<span class="dv">20</span>]</span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a>plt.bar(x<span class="op">=</span>top_features,height<span class="op">=</span>top_scores)</span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">30</span>)</span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_307199db045148b8a4807fd051a00805/3f906c369bf49d629eaf196e54511c20c8b0639f.png" /></p>
</div>
</div>
<div class="cell markdown" id="Fvu4J5YERhEe">
<p>The important features are listed under the name 'feature_select' and stored in train and test.</p>
</div>
<div class="cell code" data-execution_count="99" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="k9thIx3SCbjR" data-outputId="6da9e4ed-f4e4-477d-f81b-3fb76579d3e7">
<div class="sourceCode" id="cb146"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>train<span class="op">=</span>fs_x[feature_select]</span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>train.drop(<span class="st">&#39;InsurancePolicyNumber&#39;</span>,axis<span class="op">=</span><span class="dv">1</span>,inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>test<span class="op">=</span>fs_x_test[feature_select]</span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>test.drop(<span class="st">&#39;InsurancePolicyNumber&#39;</span>,axis<span class="op">=</span><span class="dv">1</span>,inplace<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/usr/local/lib/python3.7/dist-packages/pandas/core/frame.py:4913: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  errors=errors,
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="100" id="lvF9zOoCvy8j">
<div class="sourceCode" id="cb148"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>X<span class="op">=</span>train</span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>y<span class="op">=</span>pd.get_dummies(data<span class="op">=</span>data[<span class="st">&#39;ReportedFraud&#39;</span>],drop_first<span class="op">=</span><span class="va">True</span>,prefix_sep<span class="op">=</span><span class="st">&quot;_&quot;</span>).astype(<span class="st">&#39;category&#39;</span>)</span></code></pre></div>
</div>
<div class="cell markdown" id="JHj3-JH55ltl">
<p>Splitting train data into Train and Validation sets to train and validate the models before applying the test data on it.</p>
</div>
<div class="cell code" data-execution_count="101" id="dEoIp6OmwWSr">
<div class="sourceCode" id="cb149"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>X_train,X_val,y_train,y_val<span class="op">=</span>train_test_split(X,y,stratify<span class="op">=</span>y,test_size<span class="op">=</span><span class="fl">0.1</span>,random_state<span class="op">=</span><span class="dv">322</span>)</span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>X_test<span class="op">=</span>test</span></code></pre></div>
</div>
<section id="model-building" class="cell markdown" id="uekYu0aHtAtd">
<h1>Model Building</h1>
</section>
<div class="cell markdown" id="hKHGfSy9ll_p">
<p>After a bit of research and recommendations from different sources and work experience i have listed the below classifiers to work on</p>
</div>
<section id="model-selection-and-training" class="cell markdown" id="XES4bukmn4AN">
<h2>Model Selection and Training</h2>
</section>
<div class="cell markdown" id="Sj25slzDpREr">
<p><strong>Logistic Regression</strong></p>
<p>Computationally low and Simple in execution,easy to understand the working process</p>
</div>
<div class="cell code" data-execution_count="136" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="xU7A5cEfpMKM" data-outputId="903f40bf-f84e-42ab-fcc2-6bc2539018cc">
<div class="sourceCode" id="cb150"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>st<span class="op">=</span>time.time()</span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>lr<span class="op">=</span>LogisticRegression(max_iter<span class="op">=</span><span class="dv">500</span>)</span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a>lr.fit(X_train,y_train)</span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a>y_lr<span class="op">=</span>lr.predict(X_val)</span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a>lr_prob<span class="op">=</span>lr.predict_proba(X_val)</span>
<span id="cb150-6"><a href="#cb150-6" aria-hidden="true" tabindex="-1"></a>et<span class="op">=</span>time.time()</span>
<span id="cb150-7"><a href="#cb150-7" aria-hidden="true" tabindex="-1"></a>time_lr<span class="op">=</span>et<span class="op">-</span>st</span>
<span id="cb150-8"><a href="#cb150-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_val,y_lr))</span>
<span id="cb150-9"><a href="#cb150-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Total time taken:&quot;</span>,time_lr)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/usr/local/lib/python3.7/dist-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>              precision    recall  f1-score   support

           0       0.94      0.98      0.96      2105
           1       0.95      0.83      0.89       779

    accuracy                           0.94      2884
   macro avg       0.95      0.91      0.92      2884
weighted avg       0.94      0.94      0.94      2884

Total time taken: 0.6672637462615967
</code></pre>
</div>
</div>
<div class="cell markdown" id="NpJ_I6R1pwbj">
<p><strong>Decision Tree Classifier</strong></p>
<p>Simple to interpret and faster than many others.</p>
</div>
<div class="cell code" data-execution_count="137" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="RY_XhtJmpvjj" data-outputId="22814dd2-13b8-4226-817c-16082c58379f">
<div class="sourceCode" id="cb153"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>st<span class="op">=</span>time.time()</span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>dtc<span class="op">=</span>DecisionTreeClassifier()</span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>dtc.fit(X_train,y_train)</span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a>y_dtc<span class="op">=</span>dtc.predict(X_val)</span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a>dtc_prob<span class="op">=</span>dtc.predict_proba(X_val)</span>
<span id="cb153-6"><a href="#cb153-6" aria-hidden="true" tabindex="-1"></a>et<span class="op">=</span>time.time()</span>
<span id="cb153-7"><a href="#cb153-7" aria-hidden="true" tabindex="-1"></a>time_dtc<span class="op">=</span>et<span class="op">-</span>st</span>
<span id="cb153-8"><a href="#cb153-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_val,y_dtc))</span>
<span id="cb153-9"><a href="#cb153-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Total time taken:&quot;</span>,time_dtc)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>              precision    recall  f1-score   support

           0       0.92      0.91      0.92      2105
           1       0.76      0.79      0.78       779

    accuracy                           0.88      2884
   macro avg       0.84      0.85      0.85      2884
weighted avg       0.88      0.88      0.88      2884

Total time taken: 0.44161486625671387
</code></pre>
</div>
</div>
<div class="cell markdown" id="TggvXfyY6vmV">
<p><strong>Random Forest Classifier</strong></p>
<p>Good at learning patterns with large datasets</p>
<p>Does not overfit on the data</p>
</div>
<div class="cell code" data-execution_count="138" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="dsLMWOSewrBX" data-outputId="cce1c643-4c5b-49c3-bc5e-4f04b2bb41fb">
<div class="sourceCode" id="cb155"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>st<span class="op">=</span>time.time()</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>rfc<span class="op">=</span>RandomForestClassifier()</span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>model<span class="op">=</span>rfc.fit(X_train,y_train)</span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a>y_rfc<span class="op">=</span>model.predict(X_val)</span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a>rfc_prob<span class="op">=</span>model.predict_proba(X_val)</span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a>et<span class="op">=</span>time.time()</span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a>time_rfc<span class="op">=</span>et<span class="op">-</span>st</span>
<span id="cb155-8"><a href="#cb155-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_val,y_rfc))</span>
<span id="cb155-9"><a href="#cb155-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Total time taken:&quot;</span>,time_rfc)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:3: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples,), for example using ravel().
  This is separate from the ipykernel package so we can avoid doing imports until
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>              precision    recall  f1-score   support

           0       0.94      0.98      0.96      2105
           1       0.94      0.84      0.89       779

    accuracy                           0.94      2884
   macro avg       0.94      0.91      0.93      2884
weighted avg       0.94      0.94      0.94      2884

Total time taken: 5.334174394607544
</code></pre>
</div>
</div>
<div class="cell markdown" id="q4SxjSeV672s">
<p><strong>Light Gradient Boosting Classifier</strong></p>
<p>Can handle large size of data and requires low memory for computation</p>
</div>
<div class="cell code" data-execution_count="139" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="LkUaWF5fSDKd" data-outputId="a132dfd2-e528-41b1-ec01-e1398dfd497a">
<div class="sourceCode" id="cb158"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a>st<span class="op">=</span>time.time()</span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>lgb<span class="op">=</span>lgbm.LGBMClassifier()</span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>lgb.fit(X_train,y_train)</span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a>y_lgb<span class="op">=</span>lgb.predict(X_val)</span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a>lgb_prob<span class="op">=</span>lgb.predict_proba(X_val)</span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a>et<span class="op">=</span>time.time()</span>
<span id="cb158-7"><a href="#cb158-7" aria-hidden="true" tabindex="-1"></a>time_lgb<span class="op">=</span>et<span class="op">-</span>st</span>
<span id="cb158-8"><a href="#cb158-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_val,y_lgb))</span>
<span id="cb158-9"><a href="#cb158-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Total time taken:&quot;</span>,time_lgb)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/usr/local/lib/python3.7/dist-packages/sklearn/preprocessing/_label.py:98: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/usr/local/lib/python3.7/dist-packages/sklearn/preprocessing/_label.py:133: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>              precision    recall  f1-score   support

           0       0.94      0.98      0.96      2105
           1       0.94      0.84      0.89       779

    accuracy                           0.94      2884
   macro avg       0.94      0.91      0.93      2884
weighted avg       0.94      0.94      0.94      2884

Total time taken: 0.5713889598846436
</code></pre>
</div>
</div>
<div class="cell markdown" id="Ej9TQUK-7BRq">
<p><strong>Voting Classifier</strong></p>
<p>Reduces variance as it considers the majority voting from the estimators.</p>
</div>
<div class="cell code" data-execution_count="140" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="a3bfkijhTt4t" data-outputId="46c1ab36-76f2-49c1-d8ac-c52c266d3f8d">
<div class="sourceCode" id="cb161"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a>st<span class="op">=</span>time.time()</span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>estimators_vote <span class="op">=</span> [(<span class="st">&#39;knn&#39;</span>,KNeighborsClassifier()),(<span class="st">&#39;lr&#39;</span>,LogisticRegression(max_iter<span class="op">=</span><span class="dv">500</span>)),(<span class="st">&#39;dtc&#39;</span>,DecisionTreeClassifier()),</span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a>               (<span class="st">&#39;nb&#39;</span>,GaussianNB()),(<span class="st">&#39;svc&#39;</span>,SVC(probability<span class="op">=</span><span class="va">True</span>))]</span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a>vote <span class="op">=</span> VotingClassifier(estimators<span class="op">=</span>estimators_vote,voting<span class="op">=</span><span class="st">&#39;hard&#39;</span>,verbose<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb161-6"><a href="#cb161-6" aria-hidden="true" tabindex="-1"></a>vote.fit(X_train, y_train)</span>
<span id="cb161-7"><a href="#cb161-7" aria-hidden="true" tabindex="-1"></a>y_vote<span class="op">=</span>vote.predict(X_val)</span>
<span id="cb161-8"><a href="#cb161-8" aria-hidden="true" tabindex="-1"></a>et<span class="op">=</span>time.time()</span>
<span id="cb161-9"><a href="#cb161-9" aria-hidden="true" tabindex="-1"></a>time_vote<span class="op">=</span>et<span class="op">-</span>st</span>
<span id="cb161-10"><a href="#cb161-10" aria-hidden="true" tabindex="-1"></a>vote1 <span class="op">=</span> VotingClassifier(estimators<span class="op">=</span>estimators_vote,voting<span class="op">=</span><span class="st">&#39;soft&#39;</span>,verbose<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb161-11"><a href="#cb161-11" aria-hidden="true" tabindex="-1"></a>vote1.fit(X_train, y_train)</span>
<span id="cb161-12"><a href="#cb161-12" aria-hidden="true" tabindex="-1"></a>vote_prob<span class="op">=</span>vote1.predict_proba(X_val)</span>
<span id="cb161-13"><a href="#cb161-13" aria-hidden="true" tabindex="-1"></a>vote_prob1<span class="op">=</span>[]</span>
<span id="cb161-14"><a href="#cb161-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(vote_prob[<span class="dv">0</span>])):</span>
<span id="cb161-15"><a href="#cb161-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(vote_prob[<span class="dv">0</span>][i]<span class="op">&gt;</span><span class="fl">0.5</span>):</span>
<span id="cb161-16"><a href="#cb161-16" aria-hidden="true" tabindex="-1"></a>    vote_prob1.append(vote_prob[<span class="dv">0</span>][i])</span>
<span id="cb161-17"><a href="#cb161-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>:</span>
<span id="cb161-18"><a href="#cb161-18" aria-hidden="true" tabindex="-1"></a>    vote_prob1.append(vote_prob[<span class="dv">1</span>][i])</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/usr/local/lib/python3.7/dist-packages/sklearn/preprocessing/_label.py:98: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/usr/local/lib/python3.7/dist-packages/sklearn/preprocessing/_label.py:133: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="141" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="DHFoxpjxyWTT" data-outputId="c69487d6-511e-4f32-8a20-773ef886d049">
<div class="sourceCode" id="cb163"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_val,y_vote))</span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Total time taken:&quot;</span>,time_vote)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>              precision    recall  f1-score   support

           0       0.94      0.98      0.96      2105
           1       0.95      0.84      0.89       779

    accuracy                           0.94      2884
   macro avg       0.94      0.91      0.93      2884
weighted avg       0.94      0.94      0.94      2884

Total time taken: 84.67640686035156
</code></pre>
</div>
</div>
<section id="model-evaluation" class="cell markdown" id="WMutyR8V7Fmt">
<h1>Model Evaluation</h1>
</section>
<div class="cell markdown" id="IeQgsRAj5pZn">
<p><strong>Model Cross Validation</strong> Why?: Applying K Fold cross validation to find the F1_score and Std deviation obtained after training on different subsets of train data to choose an optimal model.</p>
<p>Optimal Model:Low STD deviation,less Run Time,More F1_score,More roc_auc score</p>
<p><strong>Repeated Stratified K Fold cross validation</strong></p>
<p>Why??</p>
<p>1.Repeats Stratified K-Fold n times with different randomization in each repetition allowing model to run on different data subsets everytime.</p>
<p><strong>NOTE</strong> Stratified:ratio of target values(<a href="example:ratio" class="uri">example:ratio</a> of freq of labels 0 to 1) are maintained constant in all the subsets.</p>
</div>
<div class="cell code" id="V0DWdP5mCXvz">
<div class="sourceCode" id="cb165"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The entire dataset(X,y) is used for the process</span></span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>estimators_vote <span class="op">=</span> [(<span class="st">&#39;knn&#39;</span>,KNeighborsClassifier()),(<span class="st">&#39;lr&#39;</span>,LogisticRegression(max_iter<span class="op">=</span><span class="dv">500</span>,verbose<span class="op">=</span><span class="dv">0</span>)),(<span class="st">&#39;dtc&#39;</span>,DecisionTreeClassifier()),</span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a>               (<span class="st">&#39;nb&#39;</span>,GaussianNB()),(<span class="st">&#39;svc&#39;</span>,SVC())]</span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-5"><a href="#cb165-5" aria-hidden="true" tabindex="-1"></a>estimators<span class="op">=</span>[LogisticRegression(max_iter<span class="op">=</span><span class="dv">500</span>),DecisionTreeClassifier(),RandomForestClassifier(),</span>
<span id="cb165-6"><a href="#cb165-6" aria-hidden="true" tabindex="-1"></a>            lgbm.LGBMClassifier(),VotingClassifier(estimators<span class="op">=</span>estimators_vote,voting<span class="op">=</span><span class="st">&#39;hard&#39;</span>)]</span>
<span id="cb165-7"><a href="#cb165-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-8"><a href="#cb165-8" aria-hidden="true" tabindex="-1"></a>score_dict<span class="op">=</span>{}</span>
<span id="cb165-9"><a href="#cb165-9" aria-hidden="true" tabindex="-1"></a>n<span class="op">=</span><span class="dv">1</span></span>
<span id="cb165-10"><a href="#cb165-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> estimators:</span>
<span id="cb165-11"><a href="#cb165-11" aria-hidden="true" tabindex="-1"></a>  rsk<span class="op">=</span>RepeatedStratifiedKFold(n_splits<span class="op">=</span><span class="dv">5</span>,n_repeats<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb165-12"><a href="#cb165-12" aria-hidden="true" tabindex="-1"></a>  score<span class="op">=</span>[]</span>
<span id="cb165-13"><a href="#cb165-13" aria-hidden="true" tabindex="-1"></a>  score<span class="op">=</span>cross_val_score(estimator<span class="op">=</span>i,X<span class="op">=</span>X,y<span class="op">=</span>y,scoring<span class="op">=</span><span class="st">&#39;f1_weighted&#39;</span>,cv<span class="op">=</span>rsk,verbose<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb165-14"><a href="#cb165-14" aria-hidden="true" tabindex="-1"></a>  score_dict[n]<span class="op">=</span>[i,mean(score),std(score)]</span>
<span id="cb165-15"><a href="#cb165-15" aria-hidden="true" tabindex="-1"></a>  n<span class="op">=</span>n<span class="op">+</span><span class="dv">1</span></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="133" id="kGyQEDeScu6q">
<div class="sourceCode" id="cb166"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a>roc_score<span class="op">=</span>[]</span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a>y_val_scores<span class="op">=</span>[lr_prob[:,<span class="dv">1</span>],dtc_prob[:,<span class="dv">1</span>],rfc_prob[:,<span class="dv">1</span>],lgb_prob[:,<span class="dv">1</span>],vote_prob[:,<span class="dv">1</span>]]</span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> y_val_scores:</span>
<span id="cb166-4"><a href="#cb166-4" aria-hidden="true" tabindex="-1"></a>  roc_score.append(roc_auc_score(y_val,i))</span>
<span id="cb166-5"><a href="#cb166-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-6"><a href="#cb166-6" aria-hidden="true" tabindex="-1"></a>y_pred<span class="op">=</span>[y_lr,y_dtc,y_rfc,y_lgb,y_vote]</span>
<span id="cb166-7"><a href="#cb166-7" aria-hidden="true" tabindex="-1"></a>f1_scores<span class="op">=</span>[]</span>
<span id="cb166-8"><a href="#cb166-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> y_pred:</span>
<span id="cb166-9"><a href="#cb166-9" aria-hidden="true" tabindex="-1"></a>  f1_scores.append(f1_score(y_val,i,average<span class="op">=</span><span class="st">&#39;weighted&#39;</span>))</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="142" data-colab="{&quot;height&quot;:206,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="lQYiuFML6GK0" data-outputId="a4affa96-18ef-43a1-932e-f2ecf11219c7">
<div class="sourceCode" id="cb167"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a>model_evaluation<span class="op">=</span>pd.DataFrame(score_dict).T</span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>model_evaluation.columns<span class="op">=</span>[<span class="st">&#39;Estimator&#39;</span>,<span class="st">&#39;F1_score&#39;</span>,<span class="st">&#39;STD of score&#39;</span>]</span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a>model_evaluation[<span class="st">&#39;Run Time&#39;</span>]<span class="op">=</span>[time_lr,time_dtc,time_rfc,time_lgb,time_vote]</span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a>model_evaluation[<span class="st">&#39;F1_score_Train&#39;</span>]<span class="op">=</span>f1_scores</span>
<span id="cb167-5"><a href="#cb167-5" aria-hidden="true" tabindex="-1"></a>model_evaluation[<span class="st">&#39;roc_auc_score&#39;</span>]<span class="op">=</span>roc_score</span>
<span id="cb167-6"><a href="#cb167-6" aria-hidden="true" tabindex="-1"></a>model_evaluation</span></code></pre></div>
<div class="output execute_result" data-execution_count="142">

  <div id="df-c1f9fe96-70b8-4d45-95af-05f925db0d41">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Estimator</th>
      <th>F1_score</th>
      <th>STD of score</th>
      <th>Run Time</th>
      <th>F1_score_Train</th>
      <th>roc_auc_score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>LogisticRegression(max_iter=500)</td>
      <td>0.93802</td>
      <td>0.002625</td>
      <td>0.667264</td>
      <td>0.941675</td>
      <td>0.906006</td>
    </tr>
    <tr>
      <th>2</th>
      <td>DecisionTreeClassifier()</td>
      <td>0.883961</td>
      <td>0.00459</td>
      <td>0.441615</td>
      <td>0.942749</td>
      <td>0.932519</td>
    </tr>
    <tr>
      <th>3</th>
      <td>RandomForestClassifier()</td>
      <td>0.941362</td>
      <td>0.003541</td>
      <td>5.334174</td>
      <td>0.942749</td>
      <td>0.927693</td>
    </tr>
    <tr>
      <th>4</th>
      <td>LGBMClassifier()</td>
      <td>0.942217</td>
      <td>0.00259</td>
      <td>0.571389</td>
      <td>0.940404</td>
      <td>0.935511</td>
    </tr>
    <tr>
      <th>5</th>
      <td>VotingClassifier(estimators=[('knn', KNeighbor...</td>
      <td>0.941841</td>
      <td>0.003098</td>
      <td>84.676407</td>
      <td>0.942382</td>
      <td>0.913465</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-c1f9fe96-70b8-4d45-95af-05f925db0d41')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-c1f9fe96-70b8-4d45-95af-05f925db0d41 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-c1f9fe96-70b8-4d45-95af-05f925db0d41');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell markdown" id="rDhko3c86JdZ">
<p>Shows the classifiers with their performace summary.</p>
</div>
<section id="parameter-tuning" class="cell markdown" id="01jQBbu78d1M">
<h1>Parameter Tuning</h1>
<p>Tuning of parameters w.r.t the dataset can lead to improved performance of the model helping us to obtain better results.</p>
</section>
<div class="cell markdown" id="Y1aSxJBE0C4b">
<p>Using RandomizedSearchCV for hyper parameter tuning on the classifiers:</p>
<p>Random Forest,K Neighbors,Decision Tree,LGBM</p>
</div>
<div class="cell code" id="ejT_ZnuAQCJI">
<div class="sourceCode" id="cb168"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>param_distributions<span class="op">=</span><span class="bu">dict</span>(n_estimators <span class="op">=</span> [<span class="dv">200</span>,<span class="dv">300</span>,<span class="dv">500</span>],max_depth <span class="op">=</span> [<span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">12</span>],min_samples_split <span class="op">=</span> [<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>])</span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a>rfc_cv <span class="op">=</span> RandomizedSearchCV(RandomForestClassifier(), param_distributions<span class="op">=</span>param_distributions, scoring <span class="op">=</span> <span class="st">&#39;f1_weighted&#39;</span>, cv<span class="op">=</span><span class="dv">5</span>,verbose<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a>rfc_cv.fit(X,y)</span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-5"><a href="#cb168-5" aria-hidden="true" tabindex="-1"></a>param_distributions<span class="op">=</span><span class="bu">dict</span>(penalty<span class="op">=</span>[<span class="st">&#39;l2&#39;</span>,<span class="st">&#39;l1&#39;</span>,<span class="st">&#39;elasticnet&#39;</span>],C <span class="op">=</span> [<span class="dv">1</span>,<span class="dv">10</span>,<span class="fl">0.1</span>])</span>
<span id="cb168-6"><a href="#cb168-6" aria-hidden="true" tabindex="-1"></a>lr_cv <span class="op">=</span> RandomizedSearchCV(LogisticRegression(), param_distributions<span class="op">=</span>param_distributions, scoring <span class="op">=</span> <span class="st">&#39;f1_weighted&#39;</span>, cv<span class="op">=</span><span class="dv">5</span>,verbose<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb168-7"><a href="#cb168-7" aria-hidden="true" tabindex="-1"></a>lr_cv.fit(X,y)</span>
<span id="cb168-8"><a href="#cb168-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-9"><a href="#cb168-9" aria-hidden="true" tabindex="-1"></a>param_distributions<span class="op">=</span><span class="bu">dict</span>(n_neighbors <span class="op">=</span> [<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>],weights<span class="op">=</span>[<span class="st">&#39;distance&#39;</span>,<span class="st">&#39;uniform&#39;</span>],p<span class="op">=</span>[<span class="dv">1</span>,<span class="dv">2</span>])</span>
<span id="cb168-10"><a href="#cb168-10" aria-hidden="true" tabindex="-1"></a>knn_cv <span class="op">=</span> RandomizedSearchCV(KNeighborsClassifier(), param_distributions<span class="op">=</span>param_distributions, scoring <span class="op">=</span> <span class="st">&#39;f1_weighted&#39;</span>, cv<span class="op">=</span><span class="dv">5</span>,verbose<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb168-11"><a href="#cb168-11" aria-hidden="true" tabindex="-1"></a>knn_cv.fit(X,y)</span>
<span id="cb168-12"><a href="#cb168-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-13"><a href="#cb168-13" aria-hidden="true" tabindex="-1"></a>param_distributions<span class="op">=</span><span class="bu">dict</span>(max_depth <span class="op">=</span> [<span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">12</span>],min_samples_split <span class="op">=</span> [<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>])</span>
<span id="cb168-14"><a href="#cb168-14" aria-hidden="true" tabindex="-1"></a>dtc_cv <span class="op">=</span> RandomizedSearchCV(DecisionTreeClassifier(), param_distributions<span class="op">=</span>param_distributions, scoring <span class="op">=</span> <span class="st">&#39;f1_weighted&#39;</span>, cv<span class="op">=</span><span class="dv">5</span>,verbose<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb168-15"><a href="#cb168-15" aria-hidden="true" tabindex="-1"></a>dtc_cv.fit(X,y)</span>
<span id="cb168-16"><a href="#cb168-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-17"><a href="#cb168-17" aria-hidden="true" tabindex="-1"></a>param_distributions<span class="op">=</span><span class="bu">dict</span>(learning_rate <span class="op">=</span> [<span class="dv">1</span>,<span class="fl">0.1</span>,<span class="fl">0.001</span>],max_depth<span class="op">=</span>[<span class="dv">4</span>,<span class="dv">8</span>,<span class="dv">12</span>],n_estimators<span class="op">=</span>[<span class="dv">300</span>,<span class="dv">500</span>,<span class="dv">1000</span>])</span>
<span id="cb168-18"><a href="#cb168-18" aria-hidden="true" tabindex="-1"></a>lgb_cv <span class="op">=</span> RandomizedSearchCV(lgbm.LGBMClassifier(), param_distributions<span class="op">=</span>param_distributions, scoring <span class="op">=</span> <span class="st">&#39;f1_weighted&#39;</span>, cv<span class="op">=</span><span class="dv">5</span>,verbose<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb168-19"><a href="#cb168-19" aria-hidden="true" tabindex="-1"></a>lgb_cv.fit(X,y)</span>
<span id="cb168-20"><a href="#cb168-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-21"><a href="#cb168-21" aria-hidden="true" tabindex="-1"></a>param_distributions<span class="op">=</span><span class="bu">dict</span>(C<span class="op">=</span>[<span class="dv">1</span>,<span class="dv">10</span>,<span class="fl">0.1</span>])</span>
<span id="cb168-22"><a href="#cb168-22" aria-hidden="true" tabindex="-1"></a>svc_cv <span class="op">=</span> RandomizedSearchCV(SVC(), param_distributions<span class="op">=</span>param_distributions, scoring <span class="op">=</span> <span class="st">&#39;f1_weighted&#39;</span>, cv<span class="op">=</span><span class="dv">5</span>,verbose<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb168-23"><a href="#cb168-23" aria-hidden="true" tabindex="-1"></a>svc_cv.fit(X,y)</span></code></pre></div>
</div>
<div class="cell code" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="OBJY-hEn9Vwv" data-outputId="d6e55fc5-66fd-4b8d-89e4-7cbe782e1fcb">
<div class="sourceCode" id="cb169"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(rfc_cv.best_estimator_)</span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(knn_cv.best_estimator_)</span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(lr_cv.best_estimator_)</span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(dtc_cv.best_estimator_)</span>
<span id="cb169-5"><a href="#cb169-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(lgb_cv.best_estimator_)</span>
<span id="cb169-6"><a href="#cb169-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(svc_cv.best_estimator_)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>RandomForestClassifier(max_depth=12, n_estimators=500)
KNeighborsClassifier(n_neighbors=7, p=1)
LogisticRegression(C=10)
DecisionTreeClassifier(max_depth=8, min_samples_split=4)
LGBMClassifier(max_depth=8, n_estimators=500)
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="127" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="hdIh_frwDw1C" data-outputId="d1b3f789-e9f5-47ce-d060-7eab25fb1036">
<div class="sourceCode" id="cb171"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(svc_cv.best_estimator_)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>SVC(C=10)
</code></pre>
</div>
</div>
<div class="cell markdown" id="WJft-pIJKvKP">
<p><strong>Applying the Tuned parameters and checking the performance</strong></p>
</div>
<div class="cell code" data-execution_count="143" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="rBo9jAZhK3Q8" data-outputId="bfcd91e5-1629-447b-8817-169b8ca07299">
<div class="sourceCode" id="cb173"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>st<span class="op">=</span>time.time()</span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a>lr<span class="op">=</span>LogisticRegression(C<span class="op">=</span><span class="dv">10</span>,class_weight<span class="op">=</span><span class="st">&#39;balanced&#39;</span>,max_iter<span class="op">=</span><span class="dv">500</span>)</span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a>lr.fit(X_train,y_train)</span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true" tabindex="-1"></a>y_lr<span class="op">=</span>lr.predict(X_val)</span>
<span id="cb173-5"><a href="#cb173-5" aria-hidden="true" tabindex="-1"></a>lr_prob<span class="op">=</span>lr.predict_proba(X_val)</span>
<span id="cb173-6"><a href="#cb173-6" aria-hidden="true" tabindex="-1"></a>et<span class="op">=</span>time.time()</span>
<span id="cb173-7"><a href="#cb173-7" aria-hidden="true" tabindex="-1"></a>time_lr<span class="op">=</span>et<span class="op">-</span>st</span>
<span id="cb173-8"><a href="#cb173-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_val,y_lr))</span>
<span id="cb173-9"><a href="#cb173-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Total time taken:&quot;</span>,time_lr)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/usr/local/lib/python3.7/dist-packages/sklearn/utils/validation.py:993: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>              precision    recall  f1-score   support

           0       0.94      0.98      0.96      2105
           1       0.94      0.84      0.89       779

    accuracy                           0.94      2884
   macro avg       0.94      0.91      0.92      2884
weighted avg       0.94      0.94      0.94      2884

Total time taken: 0.3475217819213867
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="144" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="MAHel8-fK4EG" data-outputId="4738a04a-6626-4777-9a73-35d4e832fa79">
<div class="sourceCode" id="cb176"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a>st<span class="op">=</span>time.time()</span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a>dtc<span class="op">=</span>DecisionTreeClassifier(max_depth<span class="op">=</span><span class="dv">4</span>,min_samples_split<span class="op">=</span><span class="dv">4</span>,class_weight<span class="op">=</span><span class="st">&#39;balanced&#39;</span>)</span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a>dtc.fit(X_train,y_train)</span>
<span id="cb176-4"><a href="#cb176-4" aria-hidden="true" tabindex="-1"></a>y_dtc<span class="op">=</span>dtc.predict(X_val)</span>
<span id="cb176-5"><a href="#cb176-5" aria-hidden="true" tabindex="-1"></a>dtc_prob<span class="op">=</span>dtc.predict_proba(X_val)</span>
<span id="cb176-6"><a href="#cb176-6" aria-hidden="true" tabindex="-1"></a>et<span class="op">=</span>time.time()</span>
<span id="cb176-7"><a href="#cb176-7" aria-hidden="true" tabindex="-1"></a>time_dtc<span class="op">=</span>et<span class="op">-</span>st</span>
<span id="cb176-8"><a href="#cb176-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_val,y_dtc))</span>
<span id="cb176-9"><a href="#cb176-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Total time taken:&quot;</span>,time_dtc)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>              precision    recall  f1-score   support

           0       0.94      0.98      0.96      2105
           1       0.95      0.84      0.89       779

    accuracy                           0.94      2884
   macro avg       0.94      0.91      0.93      2884
weighted avg       0.94      0.94      0.94      2884

Total time taken: 0.13974404335021973
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="145" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="7-_EsUWdMngh" data-outputId="9f46c1ff-0e38-4b5c-8a4e-225a123ee029">
<div class="sourceCode" id="cb178"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a>st<span class="op">=</span>time.time()</span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a>rfc<span class="op">=</span>RandomForestClassifier(n_estimators<span class="op">=</span><span class="dv">300</span>,min_samples_split<span class="op">=</span><span class="dv">4</span>,max_depth<span class="op">=</span><span class="dv">8</span>,class_weight<span class="op">=</span><span class="st">&#39;balanced_subsample&#39;</span>,bootstrap<span class="op">=</span><span class="va">True</span>,oob_score<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a>rfc.fit(X_train,y_train)</span>
<span id="cb178-4"><a href="#cb178-4" aria-hidden="true" tabindex="-1"></a>y_rfc<span class="op">=</span>rfc.predict(X_val)</span>
<span id="cb178-5"><a href="#cb178-5" aria-hidden="true" tabindex="-1"></a>rfc_prob_t<span class="op">=</span>rfc.predict_proba(X_val)</span>
<span id="cb178-6"><a href="#cb178-6" aria-hidden="true" tabindex="-1"></a>et<span class="op">=</span>time.time()</span>
<span id="cb178-7"><a href="#cb178-7" aria-hidden="true" tabindex="-1"></a>time_rfc<span class="op">=</span>et<span class="op">-</span>st</span>
<span id="cb178-8"><a href="#cb178-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_val,y_rfc))</span>
<span id="cb178-9"><a href="#cb178-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Total time taken:&quot;</span>,time_rfc)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:3: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples,), for example using ravel().
  This is separate from the ipykernel package so we can avoid doing imports until
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>              precision    recall  f1-score   support

           0       0.94      0.98      0.96      2105
           1       0.95      0.84      0.89       779

    accuracy                           0.94      2884
   macro avg       0.94      0.91      0.93      2884
weighted avg       0.94      0.94      0.94      2884

Total time taken: 14.183610677719116
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="146" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="MYSfPdznMtmT" data-outputId="cc1e73fc-2473-4cab-ab27-ccdcc051dfd7">
<div class="sourceCode" id="cb181"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a>st<span class="op">=</span>time.time()</span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a>lgb<span class="op">=</span>lgbm.LGBMClassifier(max_depth<span class="op">=</span><span class="dv">8</span>,n_estimators<span class="op">=</span><span class="dv">1000</span>,learning_rate<span class="op">=</span><span class="fl">0.001</span>,class_weight<span class="op">=</span><span class="st">&#39;balanced&#39;</span>)</span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a>lgb.fit(X_train,y_train)</span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a>y_lgb<span class="op">=</span>lgb.predict(X_val)</span>
<span id="cb181-5"><a href="#cb181-5" aria-hidden="true" tabindex="-1"></a>lgb_prob_t<span class="op">=</span>lgb.predict_proba(X_val)</span>
<span id="cb181-6"><a href="#cb181-6" aria-hidden="true" tabindex="-1"></a>et<span class="op">=</span>time.time()</span>
<span id="cb181-7"><a href="#cb181-7" aria-hidden="true" tabindex="-1"></a>time_lgb<span class="op">=</span>et<span class="op">-</span>st</span>
<span id="cb181-8"><a href="#cb181-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_val,y_lgb))</span>
<span id="cb181-9"><a href="#cb181-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Total time taken:&quot;</span>,time_lgb)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/usr/local/lib/python3.7/dist-packages/sklearn/preprocessing/_label.py:98: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/usr/local/lib/python3.7/dist-packages/sklearn/preprocessing/_label.py:133: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>              precision    recall  f1-score   support

           0       0.94      0.98      0.96      2105
           1       0.93      0.84      0.89       779

    accuracy                           0.94      2884
   macro avg       0.94      0.91      0.92      2884
weighted avg       0.94      0.94      0.94      2884

Total time taken: 10.097801208496094
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="147" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="dCcQKVvIMtsW" data-outputId="8ae938c3-4339-4a17-e2fd-37df75b16a09">
<div class="sourceCode" id="cb184"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a>st<span class="op">=</span>time.time()</span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a>estimators <span class="op">=</span> [(<span class="st">&#39;knn&#39;</span>,KNeighborsClassifier(n_neighbors<span class="op">=</span><span class="dv">7</span>,p<span class="op">=</span><span class="dv">1</span>)),(<span class="st">&#39;dtc&#39;</span>,DecisionTreeClassifier(max_depth<span class="op">=</span><span class="dv">4</span>,min_samples_split<span class="op">=</span><span class="dv">4</span>,class_weight<span class="op">=</span><span class="st">&#39;balanced&#39;</span>)),</span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true" tabindex="-1"></a>              (<span class="st">&#39;lr&#39;</span>,LogisticRegression(max_iter<span class="op">=</span><span class="dv">500</span>,C<span class="op">=</span><span class="dv">10</span>,class_weight<span class="op">=</span><span class="st">&#39;balanced&#39;</span>)),</span>
<span id="cb184-4"><a href="#cb184-4" aria-hidden="true" tabindex="-1"></a>               (<span class="st">&#39;nb&#39;</span>,GaussianNB()),(<span class="st">&#39;svc&#39;</span>,SVC(probability<span class="op">=</span><span class="va">True</span>,C<span class="op">=</span><span class="dv">10</span>,class_weight<span class="op">=</span><span class="st">&#39;balanced&#39;</span>))]</span>
<span id="cb184-5"><a href="#cb184-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-6"><a href="#cb184-6" aria-hidden="true" tabindex="-1"></a>vote <span class="op">=</span> VotingClassifier(estimators<span class="op">=</span>estimators,voting<span class="op">=</span><span class="st">&#39;hard&#39;</span>,verbose<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb184-7"><a href="#cb184-7" aria-hidden="true" tabindex="-1"></a>vote.fit(X_train, y_train)</span>
<span id="cb184-8"><a href="#cb184-8" aria-hidden="true" tabindex="-1"></a>y_vote<span class="op">=</span>vote.predict(X_val)</span>
<span id="cb184-9"><a href="#cb184-9" aria-hidden="true" tabindex="-1"></a>et<span class="op">=</span>time.time()</span>
<span id="cb184-10"><a href="#cb184-10" aria-hidden="true" tabindex="-1"></a>time_vote<span class="op">=</span>et<span class="op">-</span>st</span>
<span id="cb184-11"><a href="#cb184-11" aria-hidden="true" tabindex="-1"></a>vote1 <span class="op">=</span> VotingClassifier(estimators<span class="op">=</span>estimators,voting<span class="op">=</span><span class="st">&#39;soft&#39;</span>,verbose<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb184-12"><a href="#cb184-12" aria-hidden="true" tabindex="-1"></a>vote1.fit(X_train, y_train)</span>
<span id="cb184-13"><a href="#cb184-13" aria-hidden="true" tabindex="-1"></a>vote_prob_t<span class="op">=</span>vote1.predict_proba(X_val)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/usr/local/lib/python3.7/dist-packages/sklearn/preprocessing/_label.py:98: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/usr/local/lib/python3.7/dist-packages/sklearn/preprocessing/_label.py:133: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/usr/local/lib/python3.7/dist-packages/sklearn/preprocessing/_label.py:98: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
/usr/local/lib/python3.7/dist-packages/sklearn/preprocessing/_label.py:133: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  y = column_or_1d(y, warn=True)
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="148" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="reYbxAj2LwRO" data-outputId="eaa3e954-e629-455c-e585-14f649cfc2dd">
<div class="sourceCode" id="cb186"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_val,y_vote))</span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Total time taken:&quot;</span>,time_vote)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>              precision    recall  f1-score   support

           0       0.94      0.98      0.96      2105
           1       0.95      0.84      0.89       779

    accuracy                           0.94      2884
   macro avg       0.94      0.91      0.93      2884
weighted avg       0.94      0.94      0.94      2884

Total time taken: 259.58430433273315
</code></pre>
</div>
</div>
<div class="cell markdown" id="EKtzskfuLDnR">
<p>Creating a summary table of models after parameter tuning</p>
</div>
<div class="cell code" data-execution_count="149" data-colab="{&quot;height&quot;:414,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="TroSvBMmNyCG" data-outputId="01fd8aed-f6a3-41bb-8b86-fc802eefcb31">
<div class="sourceCode" id="cb188"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a>roc_score_hp<span class="op">=</span>[]</span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a>y_val_scores_hp<span class="op">=</span>[lr_prob[:,<span class="dv">1</span>],dtc_prob[:,<span class="dv">1</span>],rfc_prob[:,<span class="dv">1</span>],lgb_prob_t[:,<span class="dv">1</span>],vote_prob_t[:,<span class="dv">1</span>]]</span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> y_val_scores_hp:</span>
<span id="cb188-4"><a href="#cb188-4" aria-hidden="true" tabindex="-1"></a>  roc_score_hp.append(roc_auc_score(y_val,i))</span>
<span id="cb188-5"><a href="#cb188-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-6"><a href="#cb188-6" aria-hidden="true" tabindex="-1"></a>y_pred_hp<span class="op">=</span>[y_lr,y_dtc,y_rfc,y_lgb,y_vote]</span>
<span id="cb188-7"><a href="#cb188-7" aria-hidden="true" tabindex="-1"></a>f1_scores_hp<span class="op">=</span>[]</span>
<span id="cb188-8"><a href="#cb188-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> y_pred_hp:</span>
<span id="cb188-9"><a href="#cb188-9" aria-hidden="true" tabindex="-1"></a>  f1_scores_hp.append(f1_score(y_val,i,average<span class="op">=</span><span class="st">&#39;weighted&#39;</span>))</span>
<span id="cb188-10"><a href="#cb188-10" aria-hidden="true" tabindex="-1"></a>model_hp<span class="op">=</span>model_evaluation[[<span class="st">&#39;Estimator&#39;</span>,<span class="st">&#39;F1_score&#39;</span>,<span class="st">&#39;STD of score&#39;</span>]]</span>
<span id="cb188-11"><a href="#cb188-11" aria-hidden="true" tabindex="-1"></a>model_hp[<span class="st">&#39;Run Time_hp&#39;</span>]<span class="op">=</span>[time_lr,time_dtc,time_rfc,time_lgb,time_vote]</span>
<span id="cb188-12"><a href="#cb188-12" aria-hidden="true" tabindex="-1"></a>model_hp[<span class="st">&#39;F1_score_hp&#39;</span>]<span class="op">=</span>f1_scores_hp</span>
<span id="cb188-13"><a href="#cb188-13" aria-hidden="true" tabindex="-1"></a>model_hp[<span class="st">&#39;F1_score_default&#39;</span>]<span class="op">=</span>model_evaluation[<span class="st">&#39;F1_score_Train&#39;</span>]</span>
<span id="cb188-14"><a href="#cb188-14" aria-hidden="true" tabindex="-1"></a>model_hp[<span class="st">&#39;roc_auc_score_hp&#39;</span>]<span class="op">=</span>roc_score_hp</span>
<span id="cb188-15"><a href="#cb188-15" aria-hidden="true" tabindex="-1"></a>model_hp[<span class="st">&#39;roc_auc_score_default&#39;</span>]<span class="op">=</span>model_evaluation[<span class="st">&#39;roc_auc_score&#39;</span>]</span>
<span id="cb188-16"><a href="#cb188-16" aria-hidden="true" tabindex="-1"></a>model_hp</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:11: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  # This is added back by InteractiveShellApp.init_path()
/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:12: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  if sys.path[0] == &#39;&#39;:
</code></pre>
</div>
<div class="output execute_result" data-execution_count="149">

  <div id="df-9a44325f-bf6c-4b38-b697-70e5014630b3">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Estimator</th>
      <th>F1_score</th>
      <th>STD of score</th>
      <th>Run Time_hp</th>
      <th>F1_score_hp</th>
      <th>F1_score_default</th>
      <th>roc_auc_score_hp</th>
      <th>roc_auc_score_default</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>LogisticRegression(max_iter=500)</td>
      <td>0.93802</td>
      <td>0.002625</td>
      <td>0.347522</td>
      <td>0.941675</td>
      <td>0.941675</td>
      <td>0.906006</td>
      <td>0.906006</td>
    </tr>
    <tr>
      <th>2</th>
      <td>DecisionTreeClassifier()</td>
      <td>0.883961</td>
      <td>0.00459</td>
      <td>0.139744</td>
      <td>0.943089</td>
      <td>0.942749</td>
      <td>0.932994</td>
      <td>0.932519</td>
    </tr>
    <tr>
      <th>3</th>
      <td>RandomForestClassifier()</td>
      <td>0.941362</td>
      <td>0.003541</td>
      <td>14.183611</td>
      <td>0.942749</td>
      <td>0.942749</td>
      <td>0.930575</td>
      <td>0.927693</td>
    </tr>
    <tr>
      <th>4</th>
      <td>LGBMClassifier()</td>
      <td>0.942217</td>
      <td>0.00259</td>
      <td>10.097801</td>
      <td>0.940404</td>
      <td>0.940404</td>
      <td>0.932755</td>
      <td>0.935511</td>
    </tr>
    <tr>
      <th>5</th>
      <td>VotingClassifier(estimators=[('knn', KNeighbor...</td>
      <td>0.941841</td>
      <td>0.003098</td>
      <td>259.584304</td>
      <td>0.942382</td>
      <td>0.942382</td>
      <td>0.929839</td>
      <td>0.913465</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-9a44325f-bf6c-4b38-b697-70e5014630b3')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-9a44325f-bf6c-4b38-b697-70e5014630b3 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-9a44325f-bf6c-4b38-b697-70e5014630b3');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell markdown" id="WsXXeJe_OOIH">
<p>The results are the same even after parameter tuning: Random Forest classifier is the better model good at performance as well as low time taken.More effective on test data than others.</p>
</div>
<section id="model-generalisation" class="cell markdown" id="2whLsBPbdVBX">
<h1>Model Generalisation</h1>
</section>
<div class="cell markdown" id="29lbY3By8pfQ">
<p><strong>Applying Model on Test data</strong></p>
</div>
<div class="cell code" data-execution_count="150" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="nUouLl-yRLTl" data-outputId="aea717c3-93cf-422f-fd1e-4f2981c6b41b">
<div class="sourceCode" id="cb190"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a>st<span class="op">=</span>time.time()</span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a>rfc<span class="op">=</span>RandomForestClassifier(n_estimators<span class="op">=</span><span class="dv">500</span>,min_samples_split<span class="op">=</span><span class="dv">4</span>,max_depth<span class="op">=</span><span class="dv">12</span>,class_weight<span class="op">=</span><span class="st">&#39;balanced_subsample&#39;</span>,bootstrap<span class="op">=</span><span class="va">True</span>,oob_score<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a>rfc.fit(X,y)</span>
<span id="cb190-4"><a href="#cb190-4" aria-hidden="true" tabindex="-1"></a>y_rfc<span class="op">=</span>rfc.predict(X_test)</span>
<span id="cb190-5"><a href="#cb190-5" aria-hidden="true" tabindex="-1"></a>et<span class="op">=</span>time.time()</span>
<span id="cb190-6"><a href="#cb190-6" aria-hidden="true" tabindex="-1"></a>time_rfc<span class="op">=</span>et<span class="op">-</span>st</span>
<span id="cb190-7"><a href="#cb190-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Total time taken:&quot;</span>,time_rfc)<span class="co">#test_score:0.84</span></span></code></pre></div>
<div class="output stream stdout">
<pre><code>Total time taken: 25.028648138046265
</code></pre>
</div>
</div>
<div class="cell markdown" id="oU42k_09eJK3">
<p>To convert output to csv and upload</p>
</div>
<div class="cell code" id="Argewi61eOqi">
<div class="sourceCode" id="cb192"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a>sub<span class="op">=</span>pd.DataFrame()</span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a>sub[<span class="st">&#39;CustomerID&#39;</span>]<span class="op">=</span>data_test[<span class="st">&#39;CustomerID&#39;</span>]</span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a>sub[<span class="st">&#39;ReportedFraud&#39;</span>]<span class="op">=</span>y_rfc</span></code></pre></div>
</div>
<section id="conclusion" class="cell markdown" id="kQGjeHsmXYtr">
<h1>Conclusion</h1>
<p>1.The features Incident Address,Insured Hobbies and Insured Zipcode play a major role in detecting fraudulent claims.</p>
<p>2.Random Forest Algorithm is the most effective and fast one for the given dataset.</p>
</section>
<div class="cell markdown" id="lb49mo-KPLf2">
<p><strong>Recommendation to Buisness</strong></p>
<p><img src="vertopal_307199db045148b8a4807fd051a00805/6e6a844527fc480cb975a9302a06c109f821b6cb.png" alt="image.png" /></p>
</div>
<div class="cell markdown" id="GSskeoNaPd1z">
<p><strong>What more could have been done?</strong></p>
<p>A further detailed study with the help of a domain expert regarding the features and insights regarding the intra relationships can be used well for feature engineering,which can be helpful to improve the model performance.</p>
</div>
<div class="cell code" id="3yx2eYYtPlND">
<div class="sourceCode" id="cb193"><pre class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
</body>
</html>
